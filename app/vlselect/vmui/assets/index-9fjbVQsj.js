const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./FileSystemFileHandle-R744i65p.js","./config-BJNG_Aa3.js","./downloader-B69BFsAs.js"])))=>i.map(i=>d[i]);
import{d as O,t as Sr,a as Cr,u as Ar,r as Tr,A as D,y as A,b as S,q as Lr,Q as at,h as kt,T as F,c as e,x as Le,e as I,f as M,k as V,N as ss,g as te,i as Yt,$ as Qe,M as ct,j as Ge,l as Oo,D as Qt,L as rs,m as Fr,n as Ro,o as Er,p as as,_ as Ir,s as cs,F as ns,I as Mr,O as Pr,v as Or,w as Rr,H as Dr,R as zr,z as pt,B as Hr}from"./vendor-QWOXOa_8.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function i(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=i(r);fetch(r.href,a)}})();O.extend(Sr);O.extend(Cr);O.extend(Ar);O.extend(Tr);const Vr="modulepreload",Br=function(t,o){return new URL(t,o).href},gi={},fi=function(o,i,s){let r=Promise.resolve();if(i&&i.length>0){let m=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};const c=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),n=l?.nonce||l?.getAttribute("nonce");r=m(i.map(d=>{if(d=Br(d,s),d in gi)return;gi[d]=!0;const u=d.endsWith(".css"),p=u?'[rel="stylesheet"]':"";if(s)for(let g=c.length-1;g>=0;g--){const f=c[g];if(f.href===d&&(!u||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${p}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":Vr,u||(h.as="script"),h.crossOrigin="",h.href=d,n&&h.setAttribute("nonce",n),document.head.appendChild(h),u)return new Promise((g,f)=>{h.addEventListener("load",g),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(c){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=c,window.dispatchEvent(l),!l.defaultPrevented)throw c}return r.then(c=>{for(const l of c||[])l.status==="rejected"&&a(l.reason);return o().catch(a)})},$r=()=>window.location.href.replace(/(\/(select\/)?vmui\/.*|\/#\/.*)/,""),Ur="VLUI:",jr=["AUTOCOMPLETE","TIMEZONE","DISABLED_DEFAULT_TIMEZONE","THEME","LOGS_LIMIT","LOGS_MARKDOWN","LOGS_ANSI","LOGS_DISABLED_HOVERS","LOGS_QUERY_HISTORY","SERVER_URL","RAW_JSON_LIVE_VIEW","LOGS_OVERRIDE_TIME"],Do=t=>`${Ur}${t}`,he=(t,o,i=!0)=>{try{const s=i?Do(t):t;o?window.localStorage.setItem(s,JSON.stringify({value:o})):window.localStorage.removeItem(s),window.dispatchEvent(new Event("storage"))}catch(s){console.error(s)}},be=(t,o=!0)=>{const i=o?Do(t):t,s=window.localStorage.getItem(i);if(s!==null)try{return JSON.parse(s)?.value}catch{return s}},vi=(t,o=!0)=>{(o?t.map(Do):t).forEach(s=>window.localStorage.removeItem(s))},Yr=()=>{const t={migrated:[],removed:[],skipped:[]};for(const o of jr){const i=o,s=be(i,!1),r=be(i,!0);if(s===void 0){t.skipped.push(i);continue}if(r!==void 0){vi([i],!1),t.removed.push(i);continue}he(i,s,!0),vi([i],!1),t.migrated.push(i)}return t};var Ne=(t=>(t.yhat="yhat",t.yhatUpper="yhat_upper",t.yhatLower="yhat_lower",t.anomaly="vmui_anomalies_points",t.training="vmui_training_data",t.actual="actual",t.anomalyScore="anomaly_score",t))(Ne||{}),ko=(t=>(t.table="table",t.chart="chart",t.code="code",t))(ko||{}),ls=(t=>(t.emptyServer="Please enter Server URL",t.validServer="Please provide a valid Server URL",t.validQuery="Please enter a valid Query and execute it",t.traceNotFound="Not found the tracing information",t.emptyTitle="Please enter title",t.positiveNumber="Please enter positive number",t.validStep="Please enter a valid step",t.unknownType="Unknown server response format: must have 'errorType'",t))(ls||{}),_e=(t=>(t.system="system",t.light="light",t.dark="dark",t))(_e||{});const Pe=t=>getComputedStyle(document.documentElement).getPropertyValue(`--${t}`),et=(t,o)=>{document.documentElement.style.setProperty(`--${t}`,o)},zt=()=>window.matchMedia("(prefers-color-scheme: dark)").matches,Qr=t=>t===_e.system&&zt()||t===_e.dark,ds=t=>t.replace(/\/$/,""),Gr={serverUrl:ds($r()),theme:be("THEME")||_e.system,isDarkTheme:null,flags:{},appConfig:{}};function Kr(t,o){switch(o.type){case"SET_SERVER":return{...t,serverUrl:ds(o.payload)};case"SET_THEME":return he("THEME",o.payload),{...t,theme:o.payload};case"SET_DARK_THEME":return{...t,isDarkTheme:Qr(t.theme)};case"SET_FLAGS":return{...t,flags:o.payload};case"SET_APP_CONFIG":return{...t,appConfig:o.payload};default:throw new Error}}const _i="YYYY-MM-DD",Ae="YYYY-MM-DD HH:mm:ss",zo="YYYY-MM-DD[T]HH:mm:ss",ms={windows:"Windows",mac:"Mac OS",linux:"Linux"},Wr=()=>Object.values(ms).find(t=>navigator.userAgent.indexOf(t)>=0)||"unknown",Ho=()=>Wr()===ms.mac,Zr=()=>["Android","webOS","iPhone","iPad","iPod","BlackBerry","Windows Phone"].map(i=>navigator.userAgent.match(new RegExp(i,"i"))).some(i=>i);function ie(t,o,i,s){const r=D(o);A(()=>{r.current=o},[o]),A(()=>{const a=i?.current??window;if(!(a&&a.addEventListener))return;const c=l=>r.current(l);return a.addEventListener(t,c,s),()=>{a.removeEventListener(t,c,s)}},[t,i,s])}const qt=()=>{const[t,o]=S({width:0,height:0}),i=()=>{o({width:window.innerWidth,height:window.innerHeight})};return ie("resize",i),A(i,[]),t},qo=()=>{const t=Zr(),o=window.innerWidth<500;return t||o};function G(){const t=qt(),[o,i]=S(qo());return A(()=>{i(qo())},[t]),{isMobile:o}}const Jr=50,Xr=1e3,gt=1e4,ao="vmui.logs.limit.warn.dismissed",vt=5,ea=qo()?24:96,ta=[12,24,48,96,288,720,1440],xo="Ungrouped",Ce="_stream",it="_msg",ot=`${Ae}.SSS`,oe={LIMIT:"limit",GROUP_BY:"groupBy",DISPLAY_FIELDS:"displayFields",NO_WRAP_LINES:"noWrapLines",COMPACT_GROUP_HEADER:"compactGroupHeader",DATE_FORMAT:"dateFormat",ROWS_PER_PAGE:"rows_per_page"},No=1,ps=25,Ye=(t,o)=>{const i=window.location.hash.split("?")[1];return Lr.parse(i,{ignoreQueryPrefix:!0})?.[t]??o??""},oa=()=>{const o=(window.location.hash.split("?")[1]||"").match(/g\d+\.expr/g)?.length||1;return new Array(o>No?No:o).fill(1).map((i,s)=>Ye(`g${s}.expr`,""))},yi=(t,o,i)=>{const s=new URLSearchParams(t);if(i==="append")o.forEach((r,a)=>s.append(a,r));else for(const[r,a]of o)s.set(r,a);return s},Vo=at({}),se=()=>Le(Vo).state,us=()=>Le(Vo).dispatch,ia=Object.entries(Gr).reduce((t,[o,i])=>({...t,[o]:Ye(o)||i}),{}),sa=({children:t})=>{const[o,i]=kt(Kr,ia),s=F(()=>({state:o,dispatch:i}),[o,i]);return e(Vo.Provider,{value:s,children:t})},ra=["Africa/Abidjan","Africa/Accra","Africa/Addis_Ababa","Africa/Algiers","Africa/Asmera","Africa/Bamako","Africa/Bangui","Africa/Banjul","Africa/Bissau","Africa/Blantyre","Africa/Brazzaville","Africa/Bujumbura","Africa/Cairo","Africa/Casablanca","Africa/Ceuta","Africa/Conakry","Africa/Dakar","Africa/Dar_es_Salaam","Africa/Djibouti","Africa/Douala","Africa/El_Aaiun","Africa/Freetown","Africa/Gaborone","Africa/Harare","Africa/Johannesburg","Africa/Juba","Africa/Kampala","Africa/Khartoum","Africa/Kigali","Africa/Kinshasa","Africa/Lagos","Africa/Libreville","Africa/Lome","Africa/Luanda","Africa/Lubumbashi","Africa/Lusaka","Africa/Malabo","Africa/Maputo","Africa/Maseru","Africa/Mbabane","Africa/Mogadishu","Africa/Monrovia","Africa/Nairobi","Africa/Ndjamena","Africa/Niamey","Africa/Nouakchott","Africa/Ouagadougou","Africa/Porto-Novo","Africa/Sao_Tome","Africa/Tripoli","Africa/Tunis","Africa/Windhoek","America/Adak","America/Anchorage","America/Anguilla","America/Antigua","America/Araguaina","America/Argentina/La_Rioja","America/Argentina/Rio_Gallegos","America/Argentina/Salta","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Argentina/Ushuaia","America/Aruba","America/Asuncion","America/Bahia","America/Bahia_Banderas","America/Barbados","America/Belem","America/Belize","America/Blanc-Sablon","America/Boa_Vista","America/Bogota","America/Boise","America/Buenos_Aires","America/Cambridge_Bay","America/Campo_Grande","America/Cancun","America/Caracas","America/Catamarca","America/Cayenne","America/Cayman","America/Chicago","America/Chihuahua","America/Coral_Harbour","America/Cordoba","America/Costa_Rica","America/Creston","America/Cuiaba","America/Curacao","America/Danmarkshavn","America/Dawson","America/Dawson_Creek","America/Denver","America/Detroit","America/Dominica","America/Edmonton","America/Eirunepe","America/El_Salvador","America/Fort_Nelson","America/Fortaleza","America/Glace_Bay","America/Godthab","America/Goose_Bay","America/Grand_Turk","America/Grenada","America/Guadeloupe","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax","America/Havana","America/Hermosillo","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Indianapolis","America/Inuvik","America/Iqaluit","America/Jamaica","America/Jujuy","America/Juneau","America/Kentucky/Monticello","America/Kralendijk","America/La_Paz","America/Lima","America/Los_Angeles","America/Louisville","America/Lower_Princes","America/Maceio","America/Managua","America/Manaus","America/Marigot","America/Martinique","America/Matamoros","America/Mazatlan","America/Mendoza","America/Menominee","America/Merida","America/Metlakatla","America/Mexico_City","America/Miquelon","America/Moncton","America/Monterrey","America/Montevideo","America/Montreal","America/Montserrat","America/Nassau","America/New_York","America/Nipigon","America/Nome","America/Noronha","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Ojinaga","America/Panama","America/Pangnirtung","America/Paramaribo","America/Phoenix","America/Port-au-Prince","America/Port_of_Spain","America/Porto_Velho","America/Puerto_Rico","America/Punta_Arenas","America/Rainy_River","America/Rankin_Inlet","America/Recife","America/Regina","America/Resolute","America/Rio_Branco","America/Santa_Isabel","America/Santarem","America/Santiago","America/Santo_Domingo","America/Sao_Paulo","America/Scoresbysund","America/Sitka","America/St_Barthelemy","America/St_Johns","America/St_Kitts","America/St_Lucia","America/St_Thomas","America/St_Vincent","America/Swift_Current","America/Tegucigalpa","America/Thule","America/Thunder_Bay","America/Tijuana","America/Toronto","America/Tortola","America/Vancouver","America/Whitehorse","America/Winnipeg","America/Yakutat","America/Yellowknife","Antarctica/Casey","Antarctica/Davis","Antarctica/DumontDUrville","Antarctica/Macquarie","Antarctica/Mawson","Antarctica/McMurdo","Antarctica/Palmer","Antarctica/Rothera","Antarctica/Syowa","Antarctica/Troll","Antarctica/Vostok","Arctic/Longyearbyen","Asia/Aden","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Atyrau","Asia/Baghdad","Asia/Bahrain","Asia/Baku","Asia/Bangkok","Asia/Barnaul","Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Calcutta","Asia/Chita","Asia/Choibalsan","Asia/Colombo","Asia/Damascus","Asia/Dhaka","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Famagusta","Asia/Gaza","Asia/Hebron","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Asia/Jakarta","Asia/Jayapura","Asia/Jerusalem","Asia/Kabul","Asia/Kamchatka","Asia/Karachi","Asia/Katmandu","Asia/Khandyga","Asia/Krasnoyarsk","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Kuwait","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Muscat","Asia/Nicosia","Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk","Asia/Oral","Asia/Phnom_Penh","Asia/Pontianak","Asia/Pyongyang","Asia/Qatar","Asia/Qostanay","Asia/Qyzylorda","Asia/Rangoon","Asia/Riyadh","Asia/Saigon","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Srednekolymsk","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Thimphu","Asia/Tokyo","Asia/Tomsk","Asia/Ulaanbaatar","Asia/Urumqi","Asia/Ust-Nera","Asia/Vientiane","Asia/Vladivostok","Asia/Yakutsk","Asia/Yekaterinburg","Asia/Yerevan","Atlantic/Azores","Atlantic/Bermuda","Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faeroe","Atlantic/Madeira","Atlantic/Reykjavik","Atlantic/South_Georgia","Atlantic/St_Helena","Atlantic/Stanley","Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Currie","Australia/Darwin","Australia/Eucla","Australia/Hobart","Australia/Lindeman","Australia/Lord_Howe","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Andorra","Europe/Astrakhan","Europe/Athens","Europe/Belgrade","Europe/Berlin","Europe/Bratislava","Europe/Brussels","Europe/Bucharest","Europe/Budapest","Europe/Busingen","Europe/Chisinau","Europe/Copenhagen","Europe/Dublin","Europe/Gibraltar","Europe/Guernsey","Europe/Helsinki","Europe/Isle_of_Man","Europe/Istanbul","Europe/Jersey","Europe/Kaliningrad","Europe/Kiev","Europe/Kirov","Europe/Lisbon","Europe/Ljubljana","Europe/London","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Mariehamn","Europe/Minsk","Europe/Monaco","Europe/Moscow","Europe/Oslo","Europe/Paris","Europe/Podgorica","Europe/Prague","Europe/Riga","Europe/Rome","Europe/Samara","Europe/San_Marino","Europe/Sarajevo","Europe/Saratov","Europe/Simferopol","Europe/Skopje","Europe/Sofia","Europe/Stockholm","Europe/Tallinn","Europe/Tirane","Europe/Ulyanovsk","Europe/Uzhgorod","Europe/Vaduz","Europe/Vatican","Europe/Vienna","Europe/Vilnius","Europe/Volgograd","Europe/Warsaw","Europe/Zagreb","Europe/Zaporozhye","Europe/Zurich","Indian/Antananarivo","Indian/Chagos","Indian/Christmas","Indian/Cocos","Indian/Comoro","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius","Indian/Mayotte","Indian/Reunion","Pacific/Apia","Pacific/Auckland","Pacific/Bougainville","Pacific/Chatham","Pacific/Easter","Pacific/Efate","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Fiji","Pacific/Funafuti","Pacific/Galapagos","Pacific/Gambier","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Johnston","Pacific/Kiritimati","Pacific/Kosrae","Pacific/Kwajalein","Pacific/Majuro","Pacific/Marquesas","Pacific/Midway","Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pago_Pago","Pacific/Palau","Pacific/Pitcairn","Pacific/Ponape","Pacific/Port_Moresby","Pacific/Rarotonga","Pacific/Saipan","Pacific/Tahiti","Pacific/Tarawa","Pacific/Tongatapu","Pacific/Truk","Pacific/Wake","Pacific/Wallis"],aa=window.innerWidth/4,bi={min:1,max:1578e8},wi=Intl.supportedValuesOf,ca=wi?wi("timeZone"):ra,hs=[{long:"years",short:"y",possible:"year"},{long:"weeks",short:"w",possible:"week"},{long:"days",short:"d",possible:"day"},{long:"hours",short:"h",possible:"hour"},{long:"minutes",short:"m",possible:"min"},{long:"seconds",short:"s",possible:"sec"},{long:"milliseconds",short:"ms",possible:"millisecond"}],na=hs.map(t=>t.short),la=t=>Math.round(t*1e3)/1e3,da=t=>$o(O.duration(t,"seconds").asMilliseconds()),ma=t=>{let o=la(t);const i=Math.round(t);return t>=100&&(o=i-i%10),t<100&&t>=10&&(o=i-i%5),t<10&&t>=1&&(o=i),t<1&&t>.01&&(o=Math.round(t*40)/40),da(o||.001).replace(/\s/g,"")},pa=t=>{const o=t.match(/\d+/g),i=t.match(/[a-zA-Z]+/g);if(i&&o&&na.includes(i[0]))return{[i[0]]:o[0]}},ua=t=>{const o=hs.map(a=>a.short).join("|"),i=new RegExp(`\\d+(\\.\\d+)?[${o}]+`,"g"),r=(t.match(i)||[]).reduce((a,c)=>{const l=pa(c);return l?{...a,...l}:{...a}},{});return O.duration(r).asSeconds()};ko.table,ko.code;const ha=(t,o,i)=>ma(t/aa),ze=(t,o)=>{const i=(o||O().toDate()).valueOf()/1e3,s=ua(t);return{start:i-s,end:i,step:ha(s),date:Bo(o||O().toDate())}},ga=t=>O(t).utcOffset(0,!0).toDate(),Bo=t=>O.tz(t).utc().format(zo),Ot=t=>O.tz(t).format(zo),fa=()=>O().utc().format(zo),$o=t=>{if(t===0)return"0ms";const o=Math.floor(t%1e3),i=Math.floor(t/1e3%60),s=Math.floor(t/1e3/60%60),r=Math.floor(t/1e3/3600%24),a=Math.floor(t/(1e3*60*60*24)),c=["d","h","m","s","ms"];return[a,r,s,i,o].map((n,m)=>n?`${n}${c[m]}`:"").filter(n=>n).join("")},gs=t=>{const o=t.to.valueOf()-t.from.valueOf();return $o(o)},Ie=t=>{const o=O(t*1e3);return o.isValid()?o.toDate():new Date},va=()=>O().tz().subtract(1,"day").endOf("day").toDate(),_a=()=>O().tz().endOf("day").toDate(),Ht=[{title:"Last 5 minutes",duration:"5m",isDefault:!0},{title:"Last 15 minutes",duration:"15m"},{title:"Last 30 minutes",duration:"30m"},{title:"Last 1 hour",duration:"1h"},{title:"Last 3 hours",duration:"3h"},{title:"Last 6 hours",duration:"6h"},{title:"Last 12 hours",duration:"12h"},{title:"Last 24 hours",duration:"24h"},{title:"Last 2 days",duration:"2d"},{title:"Last 7 days",duration:"7d"},{title:"Last 30 days",duration:"30d"},{title:"Last 90 days",duration:"90d"},{title:"Last 180 days",duration:"180d"},{title:"Last 1 year",duration:"1y"},{title:"Yesterday",duration:"1d",until:va},{title:"Today",duration:"1d",until:_a}].map(t=>({id:t.title.replace(/\s/g,"_").toLocaleLowerCase(),until:t.until?t.until:()=>O().tz().toDate(),...t})),Uo=({relativeTimeId:t,defaultDuration:o,defaultEndInput:i})=>{const s=Ht.find(c=>c.isDefault)?.id,r=t||Ye("g0.relative_time",s),a=Ht.find(c=>c.id===r);return{relativeTimeId:a?r:"none",duration:a?a.duration:o,endInput:a?a.until():i}},_t=t=>`UTC${O().tz(t).format("Z")}`,ki=(t="")=>{const o=new RegExp(t,"i");return ca.reduce((i,s)=>{const r=(s.match(/^(.*?)\//)||[])[1]||"unknown",a=_t(s),c=a.replace(/UTC|0/,""),l=s.replace(/[/_]/g," "),n={region:s,utc:a,search:`${s} ${a} ${l} ${c}`},m=!t||t&&o.test(n.search);return m&&i[r]?i[r].push(n):m&&(i[r]=[n]),i},{})},fs=t=>{O.tz.setDefault(t)},ya=t=>{try{return O().tz(t),!0}catch{return!1}},vs=()=>{const t=O.tz.guess(),o=ya(t);return{isValid:o,title:o?`Browser Time (${t})`:"Browser timezone (UTC)",region:o?t:"UTC"}},qi=t=>{if(!t)return 0n;const o=O(t).valueOf();if(!t.includes("."))return BigInt(o)*1000000n;const i=t.match(/\.(\d+)Z/);if(!i)return BigInt(o)*1000000n;let s=i[1];s=s.padEnd(9,"0");const r=parseInt(s.slice(3),10);return BigInt(o)*1000000n+BigInt(r)},_s=t=>{const o=t.match(/^(.+T\d{2}:\d{2}:\d{2})(\.(\d+))?Z$/);if(!o)throw new Error("Invalid time format");const i=o[1],r=((o[3]||"")+"000000000").slice(0,9);return`${i}.${r}Z`},ba=t=>{const{start:o,end:i,step:s}=t,r=i-o,a=o-r,c=i-r;return{start:a,end:c,step:s,date:Bo(Ie(c))}},wa=(t,o)=>{if(!t)return"";if(!/\.SSS/.test(o))return O(t).tz().format(o);let s;try{s=_s(t).match(/\.(\d{9})Z$/)?.[1]||"000000000"}catch{s=(t.match(/\.(\d+)(?:Z|[+-]\d{2}:?\d{2})?$/)?.[1]||"").padEnd(9,"0").slice(0,9)}const r=o.replace(/\.SSS/g,"");return`${O(t).tz().format(r)}.${s}`},xi=t=>O(t).valueOf()/1e3,ys=be("TIMEZONE")||vs().region;fs(ys);const ka=()=>{const t=Ye("g0.range_input"),{duration:o,endInput:i,relativeTimeId:s}=Uo({defaultDuration:t||"1h",defaultEndInput:ga(Ye("g0.end_input",fa())),relativeTimeId:t?Ye("g0.relative_time","none"):void 0});return{duration:o,period:ze(o,i),relativeTime:s}},qa={...ka(),timezone:ys};function xa(t,o){switch(o.type){case"SET_TIME_STATE":return{...t,...o.payload};case"SET_DURATION":return{...t,duration:o.payload,period:ze(o.payload,Ie(t.period.end)),relativeTime:"none"};case"SET_RELATIVE_TIME":return{...t,duration:o.payload.duration,period:ze(o.payload.duration,o.payload.until),relativeTime:o.payload.id};case"SET_PERIOD":const i=gs(o.payload);return{...t,duration:i,period:ze(i,o.payload.to),relativeTime:"none"};case"RUN_QUERY":const{duration:s,endInput:r}=Uo({relativeTimeId:t.relativeTime,defaultDuration:t.duration,defaultEndInput:Ie(t.period.end)});return{...t,period:ze(s,r)};case"RUN_QUERY_TO_NOW":return{...t,period:ze(t.duration)};case"SET_TIMEZONE":return fs(o.payload),he("TIMEZONE",o.payload),t.defaultTimezone&&he("DISABLED_DEFAULT_TIMEZONE",o.payload!==t.defaultTimezone),{...t,timezone:o.payload};case"SET_DEFAULT_TIMEZONE":return{...t,defaultTimezone:o.payload};default:throw new Error}}const jo=at({}),ce=()=>Le(jo).state,nt=()=>Le(jo).dispatch,Na=({children:t})=>{const[o,i]=kt(xa,qa),s=F(()=>({state:o,dispatch:i}),[o,i]);return e(jo.Provider,{value:s,children:t})},Gt=t=>{const o=be(t);return o?JSON.parse(o):{}},Sa=(t,o,i)=>{const s=Gt(t);he(t,JSON.stringify({...s,[o]:i}))},ut=(t,o)=>Gt(t)[o]||[],Ca=(t,o)=>{const i=o.map(n=>n.values[n.index]),s=Gt(t),r=s.QUERY_HISTORY||[];r[0]||(r[0]=[]);const a=r[0],c=ps*No;i.forEach(n=>{!a.includes(n)&&n&&a.unshift(n),a.length>c&&a.pop()});const l={...s,QUERY_HISTORY:[a]};he(t,JSON.stringify(l))},Aa=(t,o)=>{Sa(t,"QUERY_FAVORITES",o)},Ta=(t,o)=>{const i=Gt(t);he(t,JSON.stringify({...i,[o]:[]}))},La=(t,o)=>{const i=o||{values:[]},s=t===i.values[i.values.length-1],r=!s&&t?[...i.values,t]:i.values;return r.length>ps&&r.shift(),{index:i.values.length-Number(s),values:r}},yt={displayResults:50,queryLimit:1e3,cacheLimit:1e3};class Fa{maxSize;map;constructor(){this.maxSize=yt.cacheLimit,this.map=new Map}get(o){for(const[i,s]of this.map){const r=JSON.parse(i),a=r.start===o.start&&r.end===o.end,c=r.type===o.type,l=o.value&&r.value&&o.value.includes(r.value),n=r.match===o.match||l,m=s.length<yt.queryLimit;if(n&&a&&c&&m)return s}return this.map.get(JSON.stringify(o))}put(o,i){if(this.map.size>=this.maxSize){const s=this.map.keys().next().value;s&&this.map.delete(s)}this.map.set(JSON.stringify(o),i)}}const ue=({value:t=!1,disabled:o=!1,label:i,color:s="secondary",fullWidth:r,onChange:a})=>{const c=()=>{o||a(!t)},l=I({"vm-switch":!0,"vm-switch_full-width":r,"vm-switch_disabled":o,"vm-switch_active":t,[`vm-switch_${s}_active`]:t,[`vm-switch_${s}`]:s});return e("div",{className:l,onClick:c,children:[e("div",{className:"vm-switch-track",children:e("div",{className:"vm-switch-track__thumb"})}),i&&e("span",{className:"vm-switch__label",children:i})]})},xt=(t,o)=>{const i=M(l=>o?o(l):!!be(l),[t,o]),[s,r]=S(i(t)),a=M(()=>{const l=i(t);l!==s&&r(l)},[t,s,i]),c=M(l=>{he(t,l)},[t]);return ie("storage",a),F(()=>[s,c],[s,c])},So="LOGS_OVERRIDE_TIME",Ea=!0,Yo=()=>{const t=be(So);return t?t==="true":Ea},Ia=()=>{const[t,o]=xt(So,Yo);return e("div",{children:[e("div",{className:"vm-server-configurator__title",children:"Query time override"}),e(ue,{label:"Override time picker with query _time filter",value:t,onChange:s=>{o(s),he(So,String(s))}})]})},Ni=oa(),Ma={query:Ni,queryHistory:Ni.map(t=>({index:0,values:[t]})),autocomplete:be("AUTOCOMPLETE")||!1,autocompleteQuick:!1,autocompleteCache:new Fa,metricsQLFunctions:[],queryHasTimeFilter:!1};function Pa(t,o){switch(o.type){case"SET_QUERY":return{...t,query:o.payload.map(i=>i)};case"SET_QUERY_HISTORY":return Ca(o.payload.key,o.payload.history),{...t,queryHistory:o.payload.history};case"SET_QUERY_HISTORY_BY_INDEX":return t.queryHistory.splice(o.payload.queryNumber,1,o.payload.value),{...t,queryHistory:t.queryHistory};case"TOGGLE_AUTOCOMPLETE":return he("AUTOCOMPLETE",!t.autocomplete),{...t,autocomplete:!t.autocomplete};case"SET_AUTOCOMPLETE_QUICK":return{...t,autocompleteQuick:o.payload};case"SET_AUTOCOMPLETE_CACHE":return t.autocompleteCache.put(o.payload.key,o.payload.value),{...t};case"SET_QUERY_HAS_TIME_FILTER":return{...t,queryHasTimeFilter:Yo()?o.payload:!1};default:throw new Error}}const Qo=at({}),Nt=()=>Le(Qo).state,Go=()=>Le(Qo).dispatch,Oa=({children:t})=>{const[o,i]=kt(Pa,Ma),s=F(()=>({state:o,dispatch:i}),[o,i]);return e(Qo.Provider,{value:s,children:t})},Ra={markdownParsing:be("LOGS_MARKDOWN")==="true",ansiParsing:be("LOGS_ANSI")==="true",autocompleteCache:new Map};function Da(t,o){switch(o.type){case"SET_MARKDOWN_PARSING":return he("LOGS_MARKDOWN",`${o.payload}`),{...t,markdownParsing:o.payload};case"SET_ANSI_PARSING":return he("LOGS_ANSI",`${o.payload}`),{...t,ansiParsing:o.payload};case"SET_AUTOCOMPLETE_CACHE":{if(t.autocompleteCache.size>=yt.cacheLimit){const i=t.autocompleteCache.keys().next().value;i&&t.autocompleteCache.delete(i)}return t.autocompleteCache.set(o.payload.key,o.payload.value),{...t,autocompleteCache:t.autocompleteCache}}default:throw new Error}}const Ko=at({}),Wo=()=>Le(Ko).state,bs=()=>Le(Ko).dispatch,za=({children:t})=>{const[o,i]=kt(Da,Ra),s=F(()=>({state:o,dispatch:i}),[o,i]);return e(Ko.Provider,{value:s,children:t})},Ha={totalLogs:0,fieldNames:[],fieldNamesParamsKey:null,streamsFieldNames:[],streamsFieldNamesParamsKey:null};function Va(t,o){switch(o.type){case"SET_TOTAL_LOGS":return{...t,totalLogs:o.payload};case"SET_FIELD_NAMES":return{...t,fieldNames:o.payload.rows,fieldNamesParamsKey:o.payload.key};case"SET_STREAM_FIELD_NAMES":return{...t,streamsFieldNames:o.payload.rows,streamsFieldNamesParamsKey:o.payload.key};default:throw new Error("Unknown action")}}const Zo=at({}),lt=()=>Le(Zo).state,Jo=()=>Le(Zo).dispatch,Ba=Object.entries(Ha).reduce((t,[o,i])=>({...t,[o]:Ye(o)||i}),{}),$a=({children:t})=>{const[o,i]=kt(Va,Ba),s=F(()=>({state:o,dispatch:i}),[o,i]);return e(Zo.Provider,{value:s,children:t})},ws=()=>e("svg",{viewBox:"0 0 85 38",fill:"currentColor",children:[e("path",{d:"M11.12 10.48c.36.28.8.43 1.26.43h.05c.48 0 .96-.19 1.25-.44 1.5-1.28 5.88-5.29 5.88-5.29 1.17-1.09-2.1-2.17-7.13-2.18h-.06c-5.04 0-8.3 1.1-7.13 2.18 0 0 4.37 4 5.88 5.3Zm2.56 2.16c-.36.28-.8.44-1.26.45h-.04c-.46 0-.9-.17-1.26-.45-1.04-.88-4.74-4.22-6.12-5.5v1.94c0 .21.08.5.22.63l.07.06c1.05.96 4.55 4.16 5.83 5.25.36.28.8.43 1.26.44h.04c.49-.02.96-.2 1.26-.44 1.3-1.11 4.94-4.45 5.88-5.31.15-.14.23-.42.23-.63V7.15a455.13 455.13 0 0 1-6.11 5.5Zm-1.26 4.99c.46 0 .9-.16 1.26-.44 2.05-1.82 4.09-3.65 6.1-5.5v1.94c0 .2-.07.48-.22.62-.94.87-4.57 4.2-5.88 5.3-.3.26-.77.44-1.26.45h-.04c-.46 0-.9-.16-1.26-.44-1.2-1.02-4.38-3.92-5.62-5.06l-.28-.25c-.14-.14-.22-.42-.22-.62v-1.94c1.38 1.26 5.08 4.6 6.12 5.5.36.28.8.43 1.26.44h.04ZM40 5l-5.84 14.46h-2.43L25.89 5h2.16a.9.9 0 0 1 .9.61l3.41 8.82a18.8 18.8 0 0 1 .62 2.02 19.44 19.44 0 0 1 .57-2.02l3.39-8.82c.05-.15.16-.3.31-.42a.9.9 0 0 1 .58-.19H40Zm17.18 0v14.46H54.8v-9.34c0-.37.02-.78.06-1.21l-4.37 8.21c-.21.4-.53.59-.95.59h-.38c-.43 0-.75-.2-.95-.59L43.8 8.88a22.96 22.96 0 0 1 .07 1.24v9.34H41.5V5h2.03l.3.01c.1 0 .17.02.24.05.07.03.13.07.19.13a1 1 0 0 1 .17.24l4.33 8.03a16.97 16.97 0 0 1 .6 1.36 14.34 14.34 0 0 1 .6-1.38l4.28-8.01c.05-.1.1-.18.17-.24.06-.06.12-.1.19-.13a.9.9 0 0 1 .24-.05l.3-.01h2.04Zm8.88 13.73a4.5 4.5 0 0 0 1.82-.35 3.96 3.96 0 0 0 2.22-2.47c.2-.57.3-1.19.3-1.85V5.31h1.02v8.75c0 .78-.12 1.51-.37 2.19a4.88 4.88 0 0 1-2.76 2.95c-.66.29-1.4.43-2.23.43-.82 0-1.57-.14-2.24-.43a5.01 5.01 0 0 1-2.75-2.95 6.37 6.37 0 0 1-.37-2.19V5.31h1.03v8.74c0 .66.1 1.28.3 1.85a3.98 3.98 0 0 0 2.21 2.47c.53.24 1.14.36 1.82.36Zm10.38.73h-1.03V5.31h1.03v14.15ZM1.73 36v-5.17l-.67-.07a.6.6 0 0 1-.21-.1.23.23 0 0 1-.08-.18v-.44h.96v-.59c0-.34.05-.65.14-.92a1.79 1.79 0 0 1 1.08-1.11 2.45 2.45 0 0 1 1.62-.02l-.03.53c0 .1-.06.15-.16.16H4c-.18 0-.35.03-.5.08a.95.95 0 0 0-.39.23c-.1.11-.19.25-.25.43-.05.18-.08.4-.08.65v.56h1.75v.78H2.8V36H1.73Zm6.17-6.17c.45 0 .85.07 1.2.22a2.57 2.57 0 0 1 1.5 1.62c.13.38.2.81.2 1.29s-.07.91-.2 1.3a2.57 2.57 0 0 1-1.49 1.61c-.36.14-.76.21-1.2.21-.45 0-.86-.07-1.22-.21a2.57 2.57 0 0 1-1.5-1.62c-.12-.38-.19-.81-.19-1.3 0-.47.07-.9.2-1.28a2.57 2.57 0 0 1 1.5-1.62c.35-.15.76-.22 1.2-.22Zm0 5.42c.6 0 1.05-.2 1.35-.6.3-.4.44-.97.44-1.69s-.15-1.28-.44-1.69c-.3-.4-.75-.6-1.35-.6-.3 0-.57.05-.8.15-.22.1-.4.26-.56.45-.15.2-.26.44-.33.73-.08.28-.11.6-.11.96 0 .72.15 1.29.44 1.69.3.4.76.6 1.36.6Zm5.26-4.11c.2-.42.43-.74.71-.97.28-.24.62-.36 1.03-.36.13 0 .25.02.36.05.12.02.23.07.32.13l-.08.8c-.02.1-.08.15-.18.15l-.24-.04a1.7 1.7 0 0 0-.88.05c-.15.05-.29.14-.4.25-.12.1-.23.24-.32.4-.1.17-.18.35-.26.56V36h-1.07v-6.08h.61c.12 0 .2.02.24.07.05.04.08.12.1.23l.06.92Zm13.73-3.82L23.39 36h-1.46l-3.5-8.68h1.29a.54.54 0 0 1 .54.37l2.04 5.3a11.31 11.31 0 0 1 .37 1.21 11.65 11.65 0 0 1 .35-1.22l2.03-5.29c.03-.1.1-.18.19-.25.1-.08.21-.12.35-.12h1.3Zm2.2 2.52V36H27.6v-6.16h1.49Zm.2-1.79c0 .13-.02.25-.08.36a1 1 0 0 1-.51.5.96.96 0 0 1-.73 0 1.02 1.02 0 0 1-.5-.5.96.96 0 0 1 0-.73.93.93 0 0 1 .86-.58.9.9 0 0 1 .37.08c.12.05.22.11.3.2a.94.94 0 0 1 .3.67Zm5.72 3.1a.68.68 0 0 1-.13.13c-.04.03-.1.05-.18.05a.42.42 0 0 1-.22-.07 3.95 3.95 0 0 0-.62-.31c-.14-.05-.3-.07-.51-.07-.26 0-.5.04-.69.14-.2.1-.36.23-.49.4-.13.18-.22.4-.29.64-.06.25-.1.53-.1.85 0 .33.04.62.1.88.08.25.18.47.32.64.13.18.29.3.48.4.18.09.4.13.63.13a1.6 1.6 0 0 0 .94-.27l.26-.2a.4.4 0 0 1 .25-.09.3.3 0 0 1 .27.14l.43.54a2.76 2.76 0 0 1-1.77.96c-.22.03-.43.05-.65.05a2.57 2.57 0 0 1-1.96-.83c-.25-.28-.45-.6-.6-1-.14-.4-.21-.85-.21-1.35 0-.45.06-.87.2-1.25a2.61 2.61 0 0 1 1.51-1.67c.37-.16.8-.24 1.28-.24.46 0 .86.07 1.2.22.35.15.66.36.94.64l-.4.54Zm3.43 4.95c-.54 0-.95-.15-1.24-.45-.28-.3-.42-.73-.42-1.26v-3.44h-.63a.29.29 0 0 1-.2-.07c-.06-.06-.09-.13-.09-.24v-.59l.99-.16.31-1.68a.33.33 0 0 1 .12-.18.34.34 0 0 1 .21-.07h.77v1.94h1.64v1.05h-1.64v3.34c0 .2.05.34.14.45.1.1.22.16.39.16a.73.73 0 0 0 .39-.1l.12-.07a.2.2 0 0 1 .11-.03c.05 0 .08.01.11.03l.09.1.44.72c-.21.18-.46.32-.74.4-.28.1-.57.15-.87.15Zm5.09-6.35c.46 0 .87.07 1.24.22a2.7 2.7 0 0 1 1.58 1.63c.14.39.22.83.22 1.31 0 .49-.08.93-.22 1.32-.14.4-.35.73-.62 1-.26.28-.58.49-.96.64-.37.15-.78.22-1.24.22a3.4 3.4 0 0 1-1.25-.22 2.71 2.71 0 0 1-1.59-1.64 3.8 3.8 0 0 1-.21-1.32c0-.48.07-.92.21-1.31a2.75 2.75 0 0 1 1.58-1.63c.38-.15.8-.22 1.26-.22Zm0 5.2c.51 0 .89-.17 1.13-.52.25-.34.38-.84.38-1.5a2.6 2.6 0 0 0-.38-1.53c-.24-.34-.62-.52-1.13-.52-.52 0-.9.18-1.16.53-.25.35-.37.85-.37 1.51s.12 1.17.37 1.51c.25.35.64.52 1.16.52Zm5.56-4.04c.2-.37.42-.65.69-.86.26-.21.57-.32.94-.32.28 0 .5.06.68.19l-.1 1.1a.3.3 0 0 1-.09.16.24.24 0 0 1-.15.04 1.8 1.8 0 0 1-.27-.03 2.01 2.01 0 0 0-.34-.03c-.16 0-.3.03-.44.08a1.1 1.1 0 0 0-.34.2c-.1.1-.2.2-.27.33-.08.13-.15.27-.22.44V36H47.7v-6.16h.87c.15 0 .26.03.31.09.06.05.1.15.13.29l.09.7Zm4.62-1.07V36h-1.49v-6.16h1.49Zm.2-1.79c0 .13-.02.25-.07.36a1 1 0 0 1-.51.5.96.96 0 0 1-.74 0 1.02 1.02 0 0 1-.5-.5.96.96 0 0 1 0-.73.93.93 0 0 1 .86-.58.9.9 0 0 1 .38.08c.11.05.21.11.3.2a.94.94 0 0 1 .28.67Zm4.56 5.32a7.8 7.8 0 0 0-1.08.12c-.29.05-.52.12-.7.2a.92.92 0 0 0-.38.3.64.64 0 0 0-.11.36c0 .26.07.45.23.56.15.11.35.17.6.17.3 0 .57-.06.79-.17.22-.1.44-.28.65-.5v-1.04Zm-3.4-2.67c.71-.65 1.57-.97 2.56-.97.36 0 .68.06.97.18a1.99 1.99 0 0 1 1.16 1.24c.1.3.16.61.16.96V36h-.67a.7.7 0 0 1-.33-.06c-.07-.04-.13-.13-.18-.26l-.13-.44c-.16.14-.3.26-.46.37a2.8 2.8 0 0 1-.97.43 2.77 2.77 0 0 1-1.32-.05 1.62 1.62 0 0 1-.57-.31 1.41 1.41 0 0 1-.38-.53 1.85 1.85 0 0 1-.05-1.18c.05-.16.14-.3.25-.45.12-.14.28-.27.46-.4a3 3 0 0 1 .7-.32 9.19 9.19 0 0 1 2.2-.33v-.36c0-.41-.09-.71-.26-.91-.18-.2-.43-.3-.76-.3a1.84 1.84 0 0 0-1.02.28l-.33.18c-.1.06-.2.09-.32.09-.1 0-.2-.03-.27-.08a.72.72 0 0 1-.17-.2l-.26-.47Zm11.49 4.32V36h-4.88v-8.6h1.16v7.62h3.72Zm3.16-5.2c.44 0 .84.08 1.2.23a2.57 2.57 0 0 1 1.49 1.62c.13.38.2.81.2 1.29s-.07.91-.2 1.3a2.57 2.57 0 0 1-1.49 1.61c-.36.14-.76.21-1.2.21-.45 0-.85-.07-1.21-.21a2.57 2.57 0 0 1-1.5-1.62c-.13-.38-.2-.81-.2-1.3 0-.47.07-.9.2-1.28.14-.39.33-.72.59-1 .25-.26.55-.47.9-.62.37-.15.77-.22 1.22-.22Zm0 5.43c.6 0 1.05-.2 1.34-.6.3-.4.45-.97.45-1.69s-.15-1.28-.45-1.69c-.3-.4-.74-.6-1.34-.6-.3 0-.57.05-.8.15-.22.1-.4.26-.56.45-.15.2-.26.44-.34.73-.07.28-.1.6-.1.96 0 .72.14 1.29.44 1.69.3.4.75.6 1.36.6Zm6.33-2.22c.22 0 .4-.03.57-.09.16-.06.3-.14.41-.25.12-.11.2-.24.26-.39.05-.15.08-.31.08-.5 0-.37-.11-.66-.34-.88-.23-.22-.55-.33-.98-.33-.43 0-.76.1-.99.33-.22.22-.34.51-.34.89 0 .18.03.34.09.5a1.1 1.1 0 0 0 .67.63c.16.06.35.09.57.09Zm1.93 3.3a.51.51 0 0 0-.13-.36.84.84 0 0 0-.34-.22 8.57 8.57 0 0 0-1.73-.2 7.5 7.5 0 0 1-.62-.05c-.23.1-.41.23-.56.4a.8.8 0 0 0-.1.92c.07.12.18.22.32.3.14.1.32.16.54.21a3.5 3.5 0 0 0 1.55 0c.23-.05.42-.12.57-.22.16-.1.29-.21.37-.34a.8.8 0 0 0 .13-.44Zm1.08-6.17v.4c0 .13-.08.21-.25.25l-.69.09c.14.26.2.56.2.88a1.86 1.86 0 0 1-1.36 1.82 3.07 3.07 0 0 1-1.72.04c-.12.08-.22.16-.29.25a.44.44 0 0 0-.1.27c0 .15.06.26.17.33.12.08.28.13.47.16a5 5 0 0 0 .66.06 16.56 16.56 0 0 1 1.5.13c.26.05.48.12.67.22.19.1.34.24.46.41.12.18.18.4.18.69 0 .26-.07.5-.2.75s-.31.46-.56.65c-.24.2-.54.34-.9.46a4.57 4.57 0 0 1-2.36.04c-.33-.09-.6-.2-.82-.36a1.56 1.56 0 0 1-.5-.51c-.1-.2-.16-.4-.16-.6 0-.3.1-.56.28-.77.19-.2.45-.37.77-.5a1.15 1.15 0 0 1-.43-.32.88.88 0 0 1-.15-.54c0-.09.01-.18.04-.27.04-.1.08-.2.15-.28a1.55 1.55 0 0 1 .58-.5c-.3-.16-.53-.39-.7-.66-.17-.28-.25-.6-.25-.97 0-.3.05-.57.16-.8.12-.25.28-.46.48-.63.2-.17.45-.3.73-.4a3 3 0 0 1 2.3.21h1.64Zm4.65.76a.24.24 0 0 1-.23.14.42.42 0 0 1-.2-.07 3.59 3.59 0 0 0-.67-.3 1.8 1.8 0 0 0-1.03 0c-.14.05-.27.11-.37.2a.87.87 0 0 0-.23.27.75.75 0 0 0-.08.35c0 .15.04.28.13.39.1.1.21.19.36.27.15.07.32.14.5.2a13.63 13.63 0 0 1 1.16.4c.2.08.36.18.5.3a1.33 1.33 0 0 1 .5 1.07 2 2 0 0 1-.15.78c-.1.24-.25.44-.45.62-.2.17-.43.3-.72.4a3.1 3.1 0 0 1-2.14-.05 2.97 2.97 0 0 1-.87-.53l.25-.41c.04-.05.07-.1.12-.12a.3.3 0 0 1 .17-.04.4.4 0 0 1 .22.08l.3.19a1.91 1.91 0 0 0 1.03.27c.2 0 .38-.03.54-.08.16-.06.29-.13.4-.22a.96.96 0 0 0 .3-.7c0-.17-.05-.31-.14-.42-.09-.11-.2-.2-.36-.28a2.6 2.6 0 0 0-.5-.2l-.59-.19c-.2-.06-.39-.14-.58-.22a2.14 2.14 0 0 1-.5-.3 1.45 1.45 0 0 1-.36-.46c-.1-.19-.14-.41-.14-.67a1.6 1.6 0 0 1 .57-1.23c.18-.16.4-.3.68-.39.26-.1.57-.14.91-.14a2.84 2.84 0 0 1 1.9.7l-.23.4Z"}),e("defs",{children:e("path",{d:"M0 0h85v38H0z"})})]}),ks=()=>e("svg",{viewBox:"0 0 15 17",fill:"currentColor",children:e("path",{d:"M6.11767 7.47586C6.47736 7.75563 6.91931 7.90898 7.37503 7.91213H7.42681C7.90756 7.90474 8.38832 7.71987 8.67677 7.46846C10.1856 6.18921 14.5568 2.18138 14.5568 2.18138C15.7254 1.09438 12.4637 0.00739 7.42681 0H7.36764C2.3308 0.00739 -0.930935 1.09438 0.237669 2.18138C0.237669 2.18138 4.60884 6.18921 6.11767 7.47586ZM8.67677 9.64243C8.31803 9.92483 7.87599 10.0808 7.41941 10.0861H7.37503C6.91845 10.0808 6.47641 9.92483 6.11767 9.64243C5.0822 8.75513 1.38409 5.42018 0.000989555 4.14832V6.07829C0.000989555 6.29273 0.0823481 6.57372 0.222877 6.70682L0.293316 6.7712L0.293344 6.77122C1.33784 7.72579 4.83903 10.9255 6.11767 12.0161C6.47641 12.2985 6.91845 12.4545 7.37503 12.4597H7.41941C7.90756 12.4449 8.38092 12.2601 8.67677 12.0161C9.9859 10.9069 13.6249 7.57198 14.5642 6.70682C14.7121 6.57372 14.7861 6.29273 14.7861 6.07829V4.14832C12.7662 5.99804 10.7297 7.82949 8.67677 9.64243ZM7.41941 14.6263C7.87513 14.6232 8.31708 14.4698 8.67677 14.19C10.7298 12.3746 12.7663 10.5407 14.7861 8.68853V10.6259C14.7861 10.8329 14.7121 11.1139 14.5642 11.247C13.6249 12.1196 9.9859 15.4471 8.67677 16.5563C8.38092 16.8077 7.90756 16.9926 7.41941 17H7.37503C6.91931 16.9968 6.47736 16.8435 6.11767 16.5637C4.91427 15.5373 1.74219 12.6364 0.502294 11.5025C0.393358 11.4029 0.299337 11.3169 0.222877 11.247C0.0823481 11.1139 0.000989555 10.8329 0.000989555 10.6259V8.68853C1.38409 9.95303 5.0822 13.2953 6.11767 14.1827C6.47641 14.4651 6.91845 14.6211 7.37503 14.6263H7.41941Z"})}),st=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"})}),Ke=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})}),ft=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8zm-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91z"})}),Kt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})}),Wt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})}),qs=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),xs=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),Xo=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})}),ge=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"})}),Ua=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M11.67 3.87 9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"})}),Ve=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m7 10 5 5 5-5z"})}),Vt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[e("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),e("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),Ns=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 18H4V8h16v13z"})}),Ss=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m22 5.72-4.6-3.86-1.29 1.53 4.6 3.86L22 5.72zM7.88 3.39 6.6 1.86 2 5.71l1.29 1.53 4.59-3.85zM12.5 8H11v6l4.75 2.85.75-1.23-4-2.37V8zM12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9c4.97 0 9-4.03 9-9s-4.03-9-9-9zm0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})}),Cs=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"})}),ei=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M8 5v14l11-7z"})}),ti=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m10 16.5 6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"})}),ja=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m3.5 18.49 6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"})}),As=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M10 10.02h5V21h-5zM17 21h3c1.1 0 2-.9 2-2v-9h-5v11zm3-18H5c-1.1 0-2 .9-2 2v3h19V5c0-1.1-.9-2-2-2zM3 19c0 1.1.9 2 2 2h3V10H3v9z"})}),oi=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"})}),St=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})}),Ct=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M8.9999 14.7854L18.8928 4.8925C19.0803 4.70497 19.3347 4.59961 19.5999 4.59961C19.8651 4.59961 20.1195 4.70497 20.307 4.8925L21.707 6.2925C22.0975 6.68303 22.0975 7.31619 21.707 7.70672L9.70701 19.7067C9.31648 20.0972 8.68332 20.0972 8.2928 19.7067L2.6928 14.1067C2.50526 13.9192 2.3999 13.6648 2.3999 13.3996C2.3999 13.1344 2.50526 12.88 2.6928 12.6925L4.0928 11.2925C4.48332 10.902 5.11648 10.902 5.50701 11.2925L8.9999 14.7854Z"})}),rt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"})}),Zt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"})}),we=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),Ya=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M20 9H4v2h16V9zM4 15h16v-2H4v2z"})}),ii=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 5C19.89 4.65 18.67 4.5 17.5 4.5C15.55 4.5 13.45 4.9 12 6C10.55 4.9 8.45 4.5 6.5 4.5C5.33 4.5 4.11 4.65 3 5C2.25 5.25 1.6 5.55 1 6V20.6C1 20.85 1.25 21.1 1.5 21.1C1.6 21.1 1.65 21.1 1.75 21.05C3.15 20.3 4.85 20 6.5 20C8.2 20 10.65 20.65 12 21.5C13.35 20.65 15.8 20 17.5 20C19.15 20 20.85 20.3 22.25 21.05C22.35 21.1 22.4 21.1 22.5 21.1C22.75 21.1 23 20.85 23 20.6V6C22.4 5.55 21.75 5.25 21 5ZM21 18.5C19.9 18.15 18.7 18 17.5 18C15.8 18 13.35 18.65 12 19.5C10.65 18.65 8.2 18 6.5 18C5.3 18 4.1 18.15 3 18.5V7C4.1 6.65 5.3 6.5 6.5 6.5C8.2 6.5 10.65 7.15 12 8C13.35 7.15 15.8 6.5 17.5 6.5C18.7 6.5 19.9 6.65 21 7V18.5Z"}),e("path",{d:"M17.5 10.5C18.38 10.5 19.23 10.59 20 10.76V9.24C19.21 9.09 18.36 9 17.5 9C15.8 9 14.26 9.29 13 9.83V11.49C14.13 10.85 15.7 10.5 17.5 10.5ZM13 12.49V14.15C14.13 13.51 15.7 13.16 17.5 13.16C18.38 13.16 19.23 13.25 20 13.42V11.9C19.21 11.75 18.36 11.66 17.5 11.66C15.8 11.66 14.26 11.96 13 12.49ZM17.5 14.33C15.8 14.33 14.26 14.62 13 15.16V16.82C14.13 16.18 15.7 15.83 17.5 15.83C18.38 15.83 19.23 15.92 20 16.09V14.57C19.21 14.41 18.36 14.33 17.5 14.33Z"}),e("path",{d:"M6.5 10.5C5.62 10.5 4.77 10.59 4 10.76V9.24C4.79 9.09 5.64 9 6.5 9C8.2 9 9.74 9.29 11 9.83V11.49C9.87 10.85 8.3 10.5 6.5 10.5ZM11 12.49V14.15C9.87 13.51 8.3 13.16 6.5 13.16C5.62 13.16 4.77 13.25 4 13.42V11.9C4.79 11.75 5.64 11.66 6.5 11.66C8.2 11.66 9.74 11.96 11 12.49ZM6.5 14.33C8.2 14.33 9.74 14.62 11 15.16V16.82C9.87 16.18 8.3 15.83 6.5 15.83C5.62 15.83 4.77 15.92 4 16.09V14.57C4.79 14.41 5.64 14.33 6.5 14.33Z"})]}),Ts=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3-8c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3z"})}),Jt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 6C9.79 6 8 7.79 8 10H10C10 8.9 10.9 8 12 8C13.1 8 14 8.9 14 10C14 10.8792 13.4202 11.3236 12.7704 11.8217C11.9421 12.4566 11 13.1787 11 15H13C13 13.9046 13.711 13.2833 14.4408 12.6455C15.21 11.9733 16 11.2829 16 10C16 7.79 14.21 6 12 6ZM13 16V18H11V16H13Z"})}),Bt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M4 20h16c1.1 0 2-.9 2-2s-.9-2-2-2H4c-1.1 0-2 .9-2 2s.9 2 2 2zm0-3h2v2H4v-2zM2 6c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2s-.9-2-2-2H4c-1.1 0-2 .9-2 2zm4 1H4V5h2v2zm-2 7h16c1.1 0 2-.9 2-2s-.9-2-2-2H4c-1.1 0-2 .9-2 2s.9 2 2 2zm0-3h2v2H4v-2z"})}),Xt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})}),Qa=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"})}),Ls=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M7 20h4c0 1.1-.9 2-2 2s-2-.9-2-2zm-2-1h8v-2H5v2zm11.5-9.5c0 3.82-2.66 5.86-3.77 6.5H5.27c-1.11-.64-3.77-2.68-3.77-6.5C1.5 5.36 4.86 2 9 2s7.5 3.36 7.5 7.5zm4.87-2.13L20 8l1.37.63L22 10l.63-1.37L24 8l-1.37-.63L22 6l-.63 1.37zM19 6l.94-2.06L22 3l-2.06-.94L19 0l-.94 2.06L16 3l2.06.94L19 6z"})}),Fs=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M3 14h4v-4H3v4zm0 5h4v-4H3v4zM3 9h4V5H3v4zm5 5h13v-4H8v4zm0 5h13v-4H8v4zM8 5v4h13V5H8z"})}),Es=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"})}),Is=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),Co=()=>e("svg",{viewBox:"0 0 16 16",fill:Pe("color-error"),children:e("path",{d:"M13.5095 4L8.50952 1H7.50952L2.50952 4L2.01953 4.85999V10.86L2.50952 11.71L7.50952 14.71H8.50952L13.5095 11.71L13.9995 10.86V4.85999L13.5095 4ZM7.50952 13.5601L3.00952 10.86V5.69995L7.50952 8.15002V13.5601ZM3.26953 4.69995L8.00952 1.85999L12.7495 4.69995L8.00952 7.29004L3.26953 4.69995ZM13.0095 10.86L8.50952 13.5601V8.15002L13.0095 5.69995V10.86Z"})}),$t=()=>e("svg",{viewBox:"0 0 16 16",fill:Pe("color-primary"),children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 5H4V4H1.5L1 4.5V12.5L1.5 13H4V12H2V5ZM14.5 4H12V5H14V12H12V13H14.5L15 12.5V4.5L14.5 4ZM11.76 6.56995L12 7V9.51001L11.7 9.95996L7.19995 11.96H6.73999L4.23999 10.46L4 10.03V7.53003L4.30005 7.06995L8.80005 5.06995H9.26001L11.76 6.56995ZM5 9.70996L6.5 10.61V9.28003L5 8.38V9.70996ZM5.57996 7.56006L7.03003 8.43005L10.42 6.93005L8.96997 6.06006L5.57996 7.56006ZM7.53003 10.73L11.03 9.17004V7.77002L7.53003 9.31995V10.73Z"})}),Ms=()=>e("svg",{viewBox:"0 0 16 16",fill:Pe("color-warning"),children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 2H8L7 3V6H8V3H14V8H10V9H14L15 8V3L14 2ZM9 6H13V7H9.41L9 6.59V6ZM7 7H2L1 8V13L2 14H8L9 13V8L8 7H7ZM8 13H2V8H8V9V13ZM3 9H7V10H3V9ZM3 11H7V12H3V11ZM9 4H13V5H9V4Z"})}),Ao=()=>e("svg",{viewBox:"0 0 16 16",fill:Pe("color-primary"),children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 3L8 2H14L15 3V8L14 9H10V8H14V3H8V6H7V3ZM9 9V8L8 7H7H2L1 8V13L2 14H8L9 13V9ZM8 8V9V13H2V8H7H8ZM9.41421 7L9 6.58579V6H13V7H9.41421ZM9 4H13V5H9V4ZM7 10H3V11H7V10Z"})}),si=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"})}),Ps=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 5.83 15.17 9l1.41-1.41L12 3 7.41 7.59 8.83 9zm0 12.34L8.83 15l-1.41 1.41L12 21l4.59-4.59L15.17 15z"})}),Os=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M7.41 18.59 8.83 20 12 16.83 15.17 20l1.41-1.41L12 14zm9.18-13.18L15.17 4 12 7.17 8.83 4 7.41 5.41 12 10z"})}),ri=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"})}),eo=()=>e("svg",{viewBox:"0 0 24 24",children:e("path",{fill:"currentColor",d:"M12,4a8,8,0,0,1,7.89,6.7A1.53,1.53,0,0,0,21.38,12h0a1.5,1.5,0,0,0,1.48-1.75,11,11,0,0,0-21.72,0A1.5,1.5,0,0,0,2.62,12h0a1.53,1.53,0,0,0,1.49-1.3A8,8,0,0,1,12,4Z",children:e("animateTransform",{attributeName:"transform",dur:"0.75s",repeatCount:"indefinite",type:"rotate",values:"0 12 12;360 12 12"})})}),We=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"})}),Ze=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19.79 5.61C20.3 4.95 19.83 4 19 4H6.83l7.97 7.97zM2.81 2.81 1.39 4.22 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-2.17l5.78 5.78 1.41-1.41z"})}),Rs=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"})}),Ds=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M8 12l4-4 4 4m-4-4v12",strokeWidth:"2",stroke:"currentColor",fill:"none"})}),At=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"})}),Tt=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"})}),zs=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M3 18h13v-2H3zm0-5h10v-2H3zm0-7v2h13V6zm18 9.59L17.42 12 21 8.41 19.59 7l-5 5 5 5z"})}),ai=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"})}),Ga=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),Ka=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})}),Wa=()=>e("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e("path",{d:"m12.126 8.125 1.937-1.937 3.747 3.747-1.937 1.938zM20.71 5.63l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75L20.71 7a1 1 0 0 0 0-1.37M2 5l6.63 6.63L3 17.25V21h3.75l5.63-5.62L18 21l2-2L4 3z"})}),Za=Object.freeze(Object.defineProperty({__proto__:null,AlarmIcon:Ss,ArrowDownIcon:ge,ArrowDropDownIcon:Ve,ArrowLeftIcon:Ua,CalendarIcon:Ns,ChartIcon:ja,ClockIcon:Vt,CloseIcon:Ke,CodeIcon:oi,CollapseIcon:Os,ContextIcon:zs,CopyIcon:we,DeleteIcon:St,DoneIcon:Ct,DownloadIcon:si,DragIcon:Ya,EditIcon:Ka,EditOffIcon:Wa,ErrorIcon:qs,ExpandIcon:Ps,FilterIcon:We,FilterOffIcon:Ze,FocusIcon:At,FunctionIcon:$t,InfoIcon:Kt,IssueIcon:Ts,KeyboardIcon:Cs,LabelIcon:Ms,ListIcon:Fs,LogoLogsIcon:ws,LogoShortIcon:ks,MetricIcon:Co,MoreIcon:Xt,OpenNewIcon:ai,PauseIcon:Rs,PlayCircleOutlineIcon:ti,PlayIcon:ei,PlusIcon:Ga,QuestionIcon:Jt,RefreshIcon:Xo,RestartIcon:ft,ScrollToTopIcon:Ds,SearchIcon:ri,SettingsIcon:st,SpinnerIcon:eo,StarBorderIcon:Es,StarIcon:Is,StorageIcon:Bt,SuccessIcon:xs,TableIcon:As,TipIcon:Ls,TuneIcon:Qa,UnfocusIcon:Tt,ValueIcon:Ao,VisibilityIcon:rt,VisibilityOffIcon:Zt,WarningIcon:Wt,WikiIcon:ii},Symbol.toStringTag,{value:"Module"})),Ja={success:e(xs,{}),error:e(qs,{}),warning:e(Wt,{}),info:e(Kt,{})},fe=({variant:t,children:o})=>{const{isDarkTheme:i}=se(),{isMobile:s}=G();return e("div",{className:I({"vm-alert":!0,[`vm-alert_${t}`]:t,"vm-alert_dark":i,"vm-alert_mobile":s}),children:[e("div",{className:"vm-alert__icon",children:Ja[t||"info"]}),e("div",{className:"vm-alert__content",children:o})]})},Hs=at({showInfoMessage:()=>{}}),Vs=()=>Le(Hs),Xa=({children:t})=>{const{isMobile:o}=G(),[i,s]=S({text:"",type:"info"}),[r,a]=S(!1),[c,l]=S(null);A(()=>{if(!c)return;s({...c,key:Date.now()}),a(!0);const m=setTimeout(n,c.timeout||4e3);return()=>clearTimeout(m)},[c]);const n=()=>{l(null),a(!1)};return e(Hs.Provider,{value:{showInfoMessage:l},children:[r&&e("div",{className:I({"vm-snackbar":!0,"vm-snackbar_mobile":o}),children:e(fe,{variant:i.type,children:e("div",{className:"vm-snackbar-content",children:[e("span",{children:i.text}),e("div",{className:"vm-snackbar-content__close",onClick:n,children:e(Ke,{})})]})})}),t]})},ec=(...t)=>t.reduce((o,i)=>({children:s})=>e(o,{children:e(i,{children:s})}),({children:o})=>e(V,{children:o})),tc=[sa,Na,Oa,Xa,za,$a],oc=ec(...tc),Bs=t=>{if(t.length!=7)return"0, 0, 0";const o=parseInt(t.slice(1,3),16),i=parseInt(t.slice(3,5),16),s=parseInt(t.slice(5,7),16);return`${o}, ${i}, ${s}`},ic={[Ne.yhatUpper]:"#7126a1",[Ne.yhatLower]:"#7126a1",[Ne.yhat]:"#da42a6",[Ne.anomaly]:"#da4242",[Ne.anomalyScore]:"#7126a1",[Ne.actual]:"#203ea9",[Ne.training]:`rgba(${Bs("#203ea9")}, 0.2)`},sc=t=>{let s=1,r=0,a=1;if(t.length>0)for(let l=0;l<t.length;l++)t[l].charCodeAt(0)>r&&(r=t[l].charCodeAt(0)),a=parseInt(String(16777215/r)),s=(s+t[l].charCodeAt(0)*a*49979693)%16777215;let c=(s*t.length%16777215).toString(16);return c=c.padEnd(6,c),`#${c}`},rc=t=>{let o=t.replace("#","").trim();if(o.length===3&&(o=o[0]+o[0]+o[1]+o[1]+o[2]+o[2]),o.length!==6)throw new Error("Invalid HEX color.");const i=parseInt(o.slice(0,2),16),s=parseInt(o.slice(2,4),16),r=parseInt(o.slice(4,6),16);return(i*299+s*587+r*114)/1e3>=128?"#000000":"#FFFFFF"},ci=()=>{const t=document.getElementById("root")?.dataset.params||"{}";try{return JSON.parse(t)}catch(o){return console.error(o),{}}},Be=()=>!!Object.keys(ci()).length,co={"color-primary":"#589DF6","color-secondary":"#316eca","color-error":"#e5534b","color-warning":"#c69026","color-info":"#539bf5","color-success":"#57ab5a","color-background-body":"#22272e","color-background-block":"#2d333b","color-background-tooltip":"rgba(22, 22, 22, 0.8)","color-text":"#cdd9e5","color-text-secondary":"#768390","color-text-disabled":"#636e7b","box-shadow":"rgba(0, 0, 0, 0.16) 1px 2px 6px","box-shadow-popper":"rgba(0, 0, 0, 0.2) 0px 2px 8px 0px","border-divider":"1px solid rgba(99, 110, 123, 0.5)","color-hover-black":"rgba(0, 0, 0, 0.2)","color-log-hits-bar-0":"rgba(255, 255, 255, 0.18)","color-log-hits-bar-1":"#FFB74D","color-log-hits-bar-2":"#81C784","color-log-hits-bar-3":"#64B5F6","color-log-hits-bar-4":"#E57373","color-log-hits-bar-5":"#8a62f0"},no={"color-primary":"#3F51B5","color-secondary":"#E91E63","color-error":"#FD080E","color-warning":"#FF8308","color-info":"#03A9F4","color-success":"#4CAF50","color-background-body":"#FEFEFF","color-background-block":"#FFFFFF","color-background-tooltip":"rgba(80,80,80,0.9)","color-text":"#110f0f","color-text-secondary":"#706F6F","color-text-disabled":"#A09F9F","box-shadow":"rgba(0, 0, 0, 0.08) 1px 2px 6px","box-shadow-popper":"rgba(0, 0, 0, 0.1) 0px 2px 8px 0px","border-divider":"1px solid rgba(0, 0, 0, 0.15)","color-hover-black":"rgba(0, 0, 0, 0.06)","color-log-hits-bar-0":"rgba(0, 0, 0, 0.18)","color-log-hits-bar-1":"#FFB74D","color-log-hits-bar-2":"#81C784","color-log-hits-bar-3":"#64B5F6","color-log-hits-bar-4":"#E57373","color-log-hits-bar-5":"#8a62f0"},ac=()=>{const[t,o]=S(zt()),i=(s=>{o(s.matches)});return A(()=>{const s=window.matchMedia("(prefers-color-scheme: dark)");return s.addEventListener("change",i),()=>s.removeEventListener("change",i)},[]),t},lo=["primary","secondary","error","warning","info","success"],cc=({onLoaded:t})=>{const o=Be(),{palette:i={}}=ci(),{theme:s}=se(),r=ac(),a=us(),c=qt(),[l,n]=S({[_e.dark]:co,[_e.light]:no,[_e.system]:zt()?co:no}),m=()=>{const{innerWidth:g,innerHeight:f}=window,{clientWidth:_,clientHeight:y}=document.documentElement;et("scrollbar-width",`${g-_}px`),et("scrollbar-height",`${f-y}px`),et("vh",`${f*.01}px`)},d=()=>{lo.forEach((g,f)=>{const _=Pe(`color-${g}`),y=rc(_);et(`${g}-text`,y),f===lo.length-1&&(a({type:"SET_DARK_THEME"}),t(!0))})},u=()=>{lo.forEach(g=>{const f=i[g];f&&et(`color-${g}`,f)}),d()},p=()=>{const g=be("THEME")||_e.system,f=l[g];Object.entries(f).forEach(([_,y])=>{et(_,y)}),d(),o&&u()},h=()=>{const g=zt()?co:no;if(l[_e.system]===g){p();return}n(f=>({...f,[_e.system]:g}))};return A(()=>{m(),p()},[l]),A(m,[c]),A(h,[s,r]),A(()=>{o&&a({type:"SET_THEME",payload:_e.light})},[]),null},nc=({to:t,isNavLink:o,children:i,...s})=>o?e(ss,{to:t,...s,children:i}):e("div",{...s,children:i}),lc=({activeItem:t,item:o,color:i=Pe("color-primary"),activeNavRef:s,onChange:r,isNavLink:a})=>{const c=l=>()=>{r&&r(l)};return e(nc,{className:I({"vm-tabs-item":!0,"vm-tabs-item_active":t===o.value,[o.className||""]:o.className}),isNavLink:a,to:o.value,style:{color:i},onClick:c(o.value),ref:t===o.value?s:void 0,children:[o.icon&&e("div",{className:I({"vm-tabs-item__icon":!0,"vm-tabs-item__icon_single":!o.label}),children:o.icon}),o.label]})},ni=({activeItem:t,items:o,color:i=Pe("color-primary"),onChange:s,indicatorPlacement:r="bottom",isNavLink:a})=>{const c=qt(),l=D(null),[n,m]=S({left:0,width:0,bottom:0});return A(()=>{if(l.current?.base instanceof HTMLElement){const{offsetLeft:d,offsetWidth:u,offsetHeight:p}=l.current.base;m({left:d,width:u,bottom:r==="top"?p-2:0})}},[c,t,l,o]),e("div",{className:"vm-tabs",children:[o.map(d=>e(lc,{activeItem:t,item:d,onChange:s,color:i,activeNavRef:l,isNavLink:a},d.value)),e("div",{className:"vm-tabs__indicator",style:{...n,borderColor:i}})]})},de=(t,o)=>{const[i]=te(),s=i.get(o)?i.get(o):t,[r,a]=S(s);return A(()=>{s!==r&&a(s)},[s]),[r,a]},Lt=()=>{const t=Yt(),[o,i]=te();return{setSearchParamsFromKeys:M(r=>{const a=!!Array.from(o.values()).length;let c=!1;Object.entries(r).forEach(([l,n])=>{o.get(l)!==`${n}`&&(o.set(l,`${n}`),c=!0)}),c&&(a?i(o):t(`?${o.toString()}`,{replace:!0}))},[o,t])}},dt=()=>e("div",{className:"vm-line-loader",children:[e("div",{className:"vm-line-loader__background"}),e("div",{className:"vm-line-loader__line"})]}),$s=({defaultExpanded:t=!1,onChange:o,title:i,children:s})=>{const[r,a]=S(t),c=()=>{const l=window.getSelection();l&&l.toString()||a(n=>{const m=!n;return o&&o(m),m})};return A(()=>{a(t)},[t]),e(V,{children:[e("header",{className:`vm-accordion-header ${r&&"vm-accordion-header_open"}`,onClick:c,children:[i,e("div",{className:`vm-accordion-header__arrow ${r&&"vm-accordion-header__arrow_open"}`,children:e(ge,{})})]}),r&&e("section",{className:"vm-accordion-section",children:s},"content")]})},Us=(t,o)=>t.length===o.length&&t.every((i,s)=>i===o[s]);function js(t,o){const i=t.reduce((s,r)=>{const a=o.map(c=>`${String(c)}: ${r[c]||"-"}`).join("|");return(s[a]=s[a]||[]).push(r),s},{});return Object.entries(i).map(([s,r])=>({keys:s.split("|"),values:r}))}const dc=t=>t.length<2?!1:t.every((o,i)=>i===0||o<t[i-1]),Q=({children:t,title:o,open:i,placement:s="bottom-center",offset:r={top:6,left:0}})=>{const{isMobile:a}=G(),[c,l]=S(!1),[n,m]=S({width:0,height:0}),d=D(null),u=D(null),p=()=>l(!1);A(()=>{if(!(!u.current||!c))return m({width:u.current.clientWidth,height:u.current.clientHeight}),window.addEventListener("scroll",p),()=>{window.removeEventListener("scroll",p)}},[c,o]);const h=F(()=>{const _=d?.current?.base;if(!_||!c)return{};const y=_.getBoundingClientRect(),b={top:0,left:0},v=s==="bottom-right"||s==="top-right",k=s==="bottom-left"||s==="top-left",w=s?.includes("top"),x=r?.top||0,q=r?.left||0;b.left=y.left-(n.width-y.width)/2+q,b.top=y.height+y.top+x,v&&(b.left=y.right-n.width),k&&(b.left=y.left+q),w&&(b.top=y.top-n.height-x);const{innerWidth:N,innerHeight:T}=window,C=20,L=b.top+n.height+C>T,E=b.top-C<0,z=b.left+n.width+C>N,U=b.left-C<0;return L&&(b.top=y.top-n.height-x),E&&(b.top=y.height+y.top+x),z&&(b.left=y.right-n.width-q),U&&(b.left=y.left+q),b.top<0&&(b.top=20),b.left<0&&(b.left=20),b},[d,s,c,n]),g=()=>{typeof i!="boolean"&&l(!0)},f=()=>{l(!1)};return A(()=>{typeof i=="boolean"&&l(i)},[i]),A(()=>{const _=d?.current?.base;if(_)return _.addEventListener("mouseenter",g),_.addEventListener("mouseleave",f),()=>{_.removeEventListener("mouseenter",g),_.removeEventListener("mouseleave",f)}},[d]),e(V,{children:[e(V,{ref:d,children:t}),!a&&c&&Qe(e("div",{className:"vm-tooltip",ref:u,style:h,children:o}),document.body)]})},ee=t=>{const[o,i]=S(!1),s=M(()=>i(!0),[]),r=M(()=>i(!1),[]),a=M(()=>i(c=>!c),[]);return{value:o,setValue:i,setTrue:s,setFalse:r,toggle:a}},mc=()=>{const t={0:"#000000",1:"#AA0000",2:"#00AA00",3:"#AA5500",4:"#0000AA",5:"#AA00AA",6:"#00AAAA",7:"#AAAAAA",8:"#555555",9:"#FF5555",10:"#55FF55",11:"#FFFF55",12:"#5555FF",13:"#FF55FF",14:"#55FFFF",15:"#FFFFFF"};for(let o=0;o<6;o++)for(let i=0;i<6;i++)for(let s=0;s<6;s++){const r=16+o*36+i*6+s,a=o>0?o*40+55:0,c=i>0?i*40+55:0,l=s>0?s*40+55:0;t[r]=`rgb(${a},${c},${l})`}for(let o=0;o<24;o++){const i=232+o,s=8+o*10;t[i]=`rgb(${s},${s},${s})`}return t},pc=mc(),ht=t=>pc[t]||null,uc="(?:\\u0007|\\u001B\\u005C|\\u009C)",hc=[`[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?${uc})`,"(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|"),mo=new RegExp(hc,"g"),gc=(t,o,i)=>{switch(o){case 0:return{color:null,fontWeight:null,fontStyle:null,textDecoration:null,backgroundColor:null};case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:return{...t,color:ht(o-30)};case 90:case 91:case 92:case 93:case 94:case 95:case 96:case 97:return{...t,color:ht(8+(o-90))};case 38:return i.length>2&&i[1]===5?{...t,color:ht(i[2])}:t;case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:return{...t,backgroundColor:ht(o-40)};case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:return{...t,backgroundColor:ht(8+(o-100))};case 1:return{...t,fontWeight:"bold"};case 3:return{...t,fontStyle:"italic"};case 4:return{...t,textDecoration:"underline"};case 7:case 27:return{...t,color:t.backgroundColor,backgroundColor:t.color};case 22:return{...t,fontWeight:null};case 23:return{...t,fontStyle:null};case 24:return{...t,textDecoration:null};default:return t}},fc=t=>{mo.lastIndex=0;let o=0;const i=[];let s={color:null,fontWeight:null,fontStyle:null,textDecoration:null,backgroundColor:null},r;for(;(r=mo.exec(t))!==null;){const a=t.slice(o,r.index);a&&i.push(e("span",{style:{color:s.color||"inherit",fontWeight:s.fontWeight||"inherit",fontStyle:s.fontStyle||"inherit",textDecoration:s.textDecoration||"inherit",backgroundColor:s.backgroundColor||"inherit"},children:a},o));const c=r[0].match(/\d+/g)?.map(Number)||[];c.forEach(l=>{s=gc(s,l,c)}),o=mo.lastIndex}return o<t.length&&i.push(e("span",{style:{color:s.color||"inherit",fontWeight:s.fontWeight||"inherit",fontStyle:s.fontStyle||"inherit",textDecoration:s.textDecoration||"inherit",backgroundColor:s.backgroundColor||"inherit"},children:t.slice(o)},o)),i},R=({variant:t="contained",color:o="primary",size:i="medium",ariaLabel:s,children:r,endIcon:a,startIcon:c,fullWidth:l=!1,className:n,disabled:m,onClick:d,onMouseDown:u,"data-id":p})=>{const h=I({"vm-button":!0,[`vm-button_${t}_${o}`]:!0,[`vm-button_${i}`]:i,"vm-button_icon_only":(c||a)&&!r,"vm-button_full-width":l,"vm-button_with-icons":c||a,[n||""]:n});return e("button",{className:h,disabled:m,"aria-label":s,onClick:d,onMouseDown:u,"data-id":p,children:[c,r,a]})},ve=()=>{const{showInfoMessage:t}=Vs();return async(o,i)=>{if(!navigator?.clipboard)return t({text:e(vc,{}),type:"error",timeout:2e4}),!1;try{return await navigator.clipboard.writeText(o),i&&t({text:i,type:"success"}),!0}catch(s){return s instanceof Error&&t({text:`${s.name}: ${s.message}`,type:"error"}),console.warn("Copy failed",s),!1}}},vc=()=>e("div",{className:"vm-snackbar-details",children:[e("p",{className:"vm-snackbar-details__title",children:"Clipboard not supported"}),window.isSecureContext?e("p",{className:"vm-snackbar-details__msg",children:[e("p",{children:"Common reasons:"}),e("ul",{children:[e("li",{children:"Browser restrictions"}),e("li",{children:"Insecure connection (HTTP)"}),e("li",{children:"Permissions not granted"})]}),e("p",{children:["For detailed information, visit the ",e("a",{className:"vm-link vm-link_underlined vm-link_colored",href:"https://developer.mozilla.org/en-US/docs/Web/API/Clipboard_API#security_considerations",target:"_blank",rel:"noopener noreferrer",children:"Clipboard API documentation"})]})]}):e("p",{className:"vm-snackbar-details__msg",children:[e("p",{children:"This page is not running in a secure context (HTTPS)."}),e("p",{children:"Clipboard operations require a secure context."}),e("a",{className:"vm-link vm-link_underlined vm-link_colored",href:"https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts",target:"_blank",rel:"noopener noreferrer",children:"Learn more about secure contexts"})]})]}),_c=({field:t,value:o,hideGroupButton:i})=>{const{isMobile:s}=G(),r=ve(),[a,c]=te(),[l,n]=S(!1),m=a.get(oe.GROUP_BY)||Ce,d=a.get(oe.DISPLAY_FIELDS)||"",u=d?d.split(","):[],p=u.includes(t),h=m===t,g=M(async()=>{if(!l)try{await r(`${t}: ${JSON.stringify(o)}`),n(!0)}catch(y){console.error(y)}},[l,r]),f=()=>{const y=u,b=y.includes(t)?y.filter(v=>v!==t):[...y,t];a.set(oe.DISPLAY_FIELDS,b.join(",")),c(a)},_=()=>{h?a.delete(oe.GROUP_BY):a.set(oe.GROUP_BY,t),c(a)};return A(()=>{if(l===null)return;const y=setTimeout(()=>n(!1),2e3);return()=>clearTimeout(y)},[l]),e("tr",{className:I({"vm-group-logs-row-fields-item":!0,"vm-group-logs-row-fields-item_mobile":s}),children:[e("td",{className:"vm-group-logs-row-fields-item-controls",children:e("div",{className:"vm-group-logs-row-fields-item-controls__wrapper",children:[e(Q,{title:l?"Copied":"Copy to clipboard",children:e(R,{className:"vm-group-logs-row-fields-item-controls__button",variant:"text",color:"gray",size:"small",startIcon:e(we,{}),onClick:g,ariaLabel:"copy to clipboard"})}),e(Q,{title:p?"Hide this field":"Show this field instead of the message",children:e(R,{className:"vm-group-logs-row-fields-item-controls__button",variant:"text",color:p?"secondary":"gray",size:"small",startIcon:p?e(rt,{}):e(rt,{}),onClick:f,ariaLabel:p?"Hide this field":"Show this field instead of the message"})}),!i&&e(Q,{title:h?"Ungroup this field":"Group by this field",children:e(R,{className:"vm-group-logs-row-fields-item-controls__button",variant:"text",color:h?"secondary":"gray",size:"small",startIcon:e(Bt,{}),onClick:_,ariaLabel:h?"Ungroup this field":"Group by this field"})})]})}),e("td",{className:"vm-group-logs-row-fields-item__key",children:t}),e("td",{className:"vm-group-logs-row-fields-item__value",children:o})]})},yc=ct(_c),bc=({log:t,hideGroupButton:o})=>{const{isMobile:i}=G(),s=F(()=>Object.entries(t).sort(([a],[c])=>a.localeCompare(c)),[t]),[r]=xt("LOGS_DISABLED_HOVERS");return e("div",{className:I({"vm-group-logs-row-fields":!0,"vm-group-logs-row-fields_mobile":i,"vm-group-logs-row-fields_interactive":!r}),children:e("table",{children:e("tbody",{children:s.map(([a,c])=>e(yc,{field:a,value:c,hideGroupButton:o},a))})})})},ke=({title:t,children:o,onClose:i,className:s,isOpen:r=!0})=>{const{isMobile:a}=G(),c=Yt(),l=Ge(),n=M(p=>{r&&p.key==="Escape"&&i()},[r]),m=p=>{p.stopPropagation()},d=M(()=>{r&&(c(l,{replace:!0}),i())},[r,l,i]);return A(()=>{if(r)return document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}},[r]),ie("popstate",d),ie("keyup",n),Qe(e("div",{className:I({"vm-modal":!0,"vm-modal_mobile":a,[`${s}`]:s}),onMouseDown:i,children:e("div",{className:"vm-modal-content",onMouseDown:m,children:[e("div",{className:"vm-modal-content-header",children:[t&&e("div",{className:"vm-modal-content-header__title",children:t}),e("div",{className:"vm-modal-content-header__close",children:e(R,{variant:"text",size:"small",onClick:i,ariaLabel:"close",children:e(Ke,{})})})]}),e("div",{className:"vm-modal-content-body",tabIndex:0,children:o})]})}),document.body)},wc=t=>`${t}/select/logsql/query`,kc=t=>`${t}/select/logsql/hits`,qc=t=>`${t}/select/logsql/stats_query_range`,Je=()=>{const[t]=te(),o=t.get("accountID")||"0",i=t.get("projectID")||"0";return F(()=>({AccountID:o,ProjectID:i}),[o,i])},Xe=(t,o)=>{const{serverUrl:i}=se(),s=Je(),[r,a]=te(),[c,l]=S([]),[n,m]=S({}),[d,u]=S(),[p,h]=S({}),[g,f]=S(),_=D(new AbortController),y=F(()=>r.get("hide_logs"),[r]),b=F(()=>wc(i),[i]),v=({period:q,query:N,limit:T})=>{if(!N)throw new Error("query is required to /select/logsql/query.");const C=new URLSearchParams({query:N.trim()});return T&&C.set("limit",String(T)),q&&(C.set("start",O(q.start*1e3).tz().toISOString()),C.set("end",O(q.end*1e3).tz().toISOString())),C},k=({signal:q})=>({signal:q,method:"POST",headers:{...s,Accept:"application/stream+json"}}),w=({accountId:q,projectId:N})=>{q&&r.set("accountID",q),N&&r.set("projectID",N),a(r)},x=M(async({query:q=t,limit:N=o,period:T,extraParams:C,beforeFetch:L,isDownload:E=!1})=>{_.current=new AbortController;const{signal:z}=_.current,U=k({signal:z});let Y=v({query:q,limit:N,period:T});const W={...Object.fromEntries(Y),...U.headers};if(m(W),L){const B=await L(new URLSearchParams(Y));if(B.action==="abort")return!1;B.action==="modify"&&(Y=yi(Y,B.body,"overwrite"))}const K=C?yi(Y,C,"append"):Y,H={...Object.fromEntries(K),...U.headers},P=Date.now();h(B=>({...B,[P]:!0})),f(void 0);try{const B=await fetch(b,{body:K,...U});if(E)return B;const $=U.headers?.AccountID,j=B.headers.get("AccountID");j&&j!==$&&w({accountId:j});const le=U.headers?.ProjectID,re=B.headers.get("ProjectID");re&&re!==le&&w({projectId:re});const Ee=B.headers.get("vl-request-duration-seconds");u(Ee?Number(Ee)*1e3:void 0);const De=await B.text();if(!B.ok||!B.body)return f(De),l([]),!1;const qe=De.split(`
`).map(xc).filter(so=>so);return l(qe),m(H),qe}catch(B){return B instanceof Error&&B.name!=="AbortError"&&(f(String(B)),console.error(B),l([])),!1}finally{h(B=>{const{[P]:$,...j}=B;return j})}},[b,t,o,s]);return A(()=>()=>_.current.abort(),[]),A(()=>{y&&(l([]),f(void 0))},[y]),{logs:c,queryParams:n,isLoading:Object.values(p).some(q=>q),error:g,fetchLogs:x,durationMs:d,abortController:_.current}},xc=t=>{try{return t&&JSON.parse(t)}catch(o){return console.error(`Failed to parse "${t}" to JSON
`,o),null}},Nc=(t,o,i="")=>{const s=o[0],r=o[o.length-1];return i?o.map(a=>`${Si(a,s,r)} ${i}`):o.map(a=>Si(a,s,r))},Si=(t,o,i)=>{if(t==null)return"";i=i||0,o=o||0;const s=Math.abs(i-o);if(isNaN(s)||s==0)return Math.abs(t)>=1e3?t.toLocaleString("en-US"):t.toString();let r=3+Math.floor(1+Math.log10(Math.max(Math.abs(o),Math.abs(i)))-Math.log10(s));return(isNaN(r)||r>20)&&(r=20),t.toLocaleString("en-US",{minimumSignificantDigits:1,maximumSignificantDigits:r})},Sc=(t,o)=>{const i=document.createElement("span");i.innerText=t,i.style.cssText=`position: absolute; z-index: -1; pointer-events: none; opacity: 0; font: ${o}`,document.body.appendChild(i);const s=i.offsetWidth;return i.remove(),s},Cc=[[3600*24*365,"{YYYY}",null,null,null,null,null,null,1],[3600*24*28,"{MMM}",`
{YYYY}`,null,null,null,null,null,1],[3600*24,"{MM}-{DD}",`
{YYYY}`,null,null,null,null,null,1],[3600,"{HH}:{mm}",`
{YYYY}-{MM}-{DD}`,null,`
{MM}-{DD}`,null,null,null,1],[60,"{HH}:{mm}",`
{YYYY}-{MM}-{DD}`,null,`
{MM}-{DD}`,null,null,null,1],[1,"{HH}:{mm}:{ss}",`
{YYYY}-{MM}-{DD}`,null,`
{MM}-{DD} {HH}:{mm}`,null,null,null,1],[.001,":{ss}.{fff}",`
{YYYY}-{MM}-{DD} {HH}:{mm}`,null,`
{MM}-{DD} {HH}:{mm}`,null,`
{HH}:{mm}`,null,1]],Ac=(t,o)=>Array.from(new Set(t.map(i=>i.scale))).map(i=>{const s="10px Arial",r=Pe("color-text"),a={scale:i,show:!0,size:Lc,stroke:r,font:s,values:(c,l)=>Nc(c,l,o)};return i?!(Number(i)%2)&&i!=="y"?{...a,side:1}:a:{space:80,values:Cc,stroke:r,font:s}}),Tc=(t,o)=>{if(t==null||o==null)return[-1,1];const s=.02*(Math.abs(o-t)||Math.abs(t)||1);return[t-s,o+s]},Lc=(t,o,i,s)=>{const r=t.axes[i];if(s>1)return r._size||60;let a=6+(r?.ticks?.size||0)+(r.gap||0);const c=(o??[]).reduce((l,n)=>n?.length>l.length?n:l,"");return c!=""&&(a+=Sc(c,"10px Arial")),Math.ceil(a)},Fc=t=>{Object.keys(t.hooks).forEach(o=>{t.hooks[o]=[]})},Ys=t=>{for(let o=t.series.length-1;o>=0;o--)o&&t.delSeries(o)},Ec=(t,o,i=!1)=>{o.forEach((s,r)=>{s.label&&(s.spanGaps=i),r&&t.addSeries(s)})},Ic=t=>{Ys(t),Fc(t),t.setData([])},Mc=t=>o=>{const i=o.posToVal(o.select.left,"x"),s=o.posToVal(o.select.left+o.select.width,"x");t({min:i,max:s})},Pc=(t,o)=>{if(t.delBand(),o.length<2)return;const i=o.map((c,l)=>({...c,index:l})),s=i.filter(c=>c.forecast===Ne.yhatUpper),r=i.filter(c=>c.forecast===Ne.yhatLower),a=s.map(c=>{const l=r.find(n=>n.forecastGroup===c.forecastGroup);return l?{series:[c.index,l.index],fill:Oc(Ne.yhatUpper)}:null}).filter(c=>c!==null);a.length&&a.forEach(c=>{t.addBand(c)})};function Oc(t){return`rgba(${Bs(ic[t])}, 0.05)`}var Ue=(t=>(t.BAR="Bars",t.LINE="Lines",t.LINE_STEPPED="Stepped lines",t.POINTS="Points",t))(Ue||{}),me=(t=>(t.hits="hits",t.stats="stats",t))(me||{});const Rc=()=>{const t=D(new Map),o=(l,n,m)=>{const d=Math.max(0,m-n),u=t.current,p=u.get(l);p&&p.idx0===n&&p.idx1===m&&p.n===d||u.set(l,{idx0:n,idx1:m,n:d,lefts:Array(d).fill(NaN),widths:Array(d).fill(NaN),valid:[]})},i=M((l,n,m,d)=>{if(n===0)return null;const u=d+1;o(n,m,u);const p=t.current.get(n);p.valid.length=0;const h=Oo?.paths?.bars?.({align:1,gap:1,size:[1],each:(g,f,_,y,b,v)=>{const k=_-p.idx0;k<0||k>=p.n||(p.lefts[k]=y,p.widths[k]=v,Number.isFinite(y)&&Number.isFinite(v)&&p.valid.push(k))}});return h?h(l,n,m,d):null},[]),s=l=>{const n=l.ctx.canvas;return n.clientWidth?n.width/n.clientWidth:1},r=M(l=>{const n=l.cursor.left;if(n==null)return null;const m=n*s(l);if(m<0||m>l.bbox.width)return null;const d=l.bbox.left+m;for(let u=l.series.length-1;u>=1;u--){if(!l.series[u]?.show)continue;const p=t.current.get(u);if(!p||p.valid.length===0)continue;const h=p.valid;let g=0,f=h.length;for(;g<f;){const w=g+f>>1;d>=p.lefts[h[w]]?g=w+1:f=w}const _=g-1;if(_<0)continue;const y=h[_],b=p.lefts[y],v=p.widths[y];if(!Number.isFinite(b)||!Number.isFinite(v)||d<b||d>=b+v)continue;const k=p.idx0+y;return{sidx:u,absIdx:k,j:y}}return null},[]),a=M(l=>{const n=r(l);if(!n)return;let m=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY;for(let p=1;p<l.series.length;p++){if(!l.series[p]?.show)continue;const h=t.current.get(p);if(!h)continue;const g=n.absIdx-h.idx0;if(g<0||g>=h.n)continue;const f=h.lefts[g],_=h.widths[g];!Number.isFinite(f)||!Number.isFinite(_)||(m=Math.min(m,f),d=Math.max(d,f+_))}if(!Number.isFinite(m)||!Number.isFinite(d)||d<=m)return;const u=l.ctx;u.save(),u.globalCompositeOperation="source-atop",u.fillStyle="rgba(255, 255, 255, 0.6)",u.fillRect(m,l.bbox.top,d-m,l.bbox.height),u.restore()},[r]),c=M(l=>r(l)?.absIdx??-1,[r]);return{barPaths:i,drawHoverBar:a,getHoverAbsIdxForBars:c}},Dc=["color-log-hits-bar-1","color-log-hits-bar-2","color-log-hits-bar-3","color-log-hits-bar-4","color-log-hits-bar-5"],zc={[Ue.BAR]:1,[Ue.LINE_STEPPED]:2,[Ue.LINE]:1.2,[Ue.POINTS]:0},To="other fields",Qs=t=>t?._isOther?To:Object.values(t?.fields||{}).map(i=>i||'""').join(", "),Hc=(t,o=0,i=1)=>{const s=t.series.filter(({scale:n})=>n==="y");let r=1/0,a=-1/0;for(const n of s){const m=Number.isFinite(n.min)?n.min:o,d=Number.isFinite(n.max)?n.max:i;m<r&&(r=m),d>a&&(a=d)}let c=Number.isFinite(r)?r:o,l=Number.isFinite(a)?a:i;return c>=0&&(c=0),l<=0&&(l=0),Tc(c,l)},Vc=({data:t,logHits:o,xRange:i,bands:s,containerSize:r,onReadyChart:a,setPlotScale:c,graphOptions:l,timezone:n})=>{const{isDarkTheme:m}=se(),{barPaths:d,drawHoverBar:u,getHoverAbsIdxForBars:p}=Rc(),[h,g]=S(-1),f=b=>{const v=p(b);g(k=>k===v?k:v),requestAnimationFrame(()=>b.redraw())},_=F(()=>{let b=0;return t.map((v,k)=>{if(k===0)return{};const w=o?.[k-1],x=Qs(w),q=w?._isOther,N=q?"color-log-hits-bar-0":Dc[b],T=b>=5?sc(x):Pe(N);return q||(b+=1),{label:x,width:zc[l.graphStyle],spanGaps:!0,show:!0,stroke:T,fill:l.fill&&!q?`${T}80`:l.fill?T:"",paths:d,points:{show:!1}}})},[m,t,l,o,d]);return{options:{series:_,bands:s,width:r.width||window.innerWidth/2,height:r.height||200,cursor:{points:{width:0,size:0}},scales:{x:{time:!0,range:()=>[i.min,i.max]},y:{range:Hc}},hooks:{drawSeries:[],draw:[u],ready:[a],setCursor:[f],setSelect:[Mc(c)],destroy:[Ic]},legend:{show:!1},axes:Ac([{},{scale:"y"}]),tzDate:b=>Oo.tzDate(new Date(Math.round(b*1e3)),n)},series:_,focusDataIdx:h}},Gs=t=>(/^{.+}$/.test(t)?t.slice(1,-1).split(","):[t]).filter(Boolean),Bc=(t,o)=>{const i=O(t.start*1e3),s=O(t.end*1e3),r=Math.max(1,s.diff(i,"ms")),a=Math.max(1,Math.ceil(r/o));return{start:i,end:s,step:a}},Ks=(t,o=Ce)=>/(.+)?=(".+")/.test(t)?t.replace(/=/,": "):`${o}: ${JSON.stringify(t)}`,$c=t=>t.reduce((o,i)=>o+(i.total||0),0),Ws=t=>(o,i)=>{if(o.label===To)return 1;if(i.label===To)return-1;const s=o[t];return i[t]-s},Uc=(t,o)=>t._time!==o._time?!1:[...new Set([...Object.keys(t),...Object.keys(o)])].every(s=>t[s]===o[s]),jc=(t,o)=>t.filter(i=>!Uc(i,o)),Yc=(t,o,i)=>{const{_stream_id:s,_time:r}=t;if(!s||!r)throw new Error("Log must contain _stream_id and _time fields.");return`_stream_id:${s} _time:${_s(r)} | stream_context ${o} ${i} | sort by (_time) desc`},Qc=(t,o)=>(i,s)=>{const r=t==="after"?jc(i,s):i;o(a=>t==="after"?r.concat(a):a.concat(r))},Gc=()=>{const{fetchLogs:t,isLoading:o,error:i,abortController:s}=Xe(),[r,a]=S([]),[c,l]=S([]),[n,m]=S({before:!0,after:!0}),d=async(h,g,f,_)=>{if(!(g<=0))try{const y=await t({query:Yc(_,h,g)});Array.isArray(y)&&y.length&&(Qc(h,f)(y,_),m(b=>({...b,[h]:y.length>=g})))}catch(y){console.error(`Error fetching ${h} logs:`,y)}};return{logsBefore:r,logsAfter:c,hasMore:n,isLoading:o,error:i,fetchContextLogs:async({log:h,linesBefore:g=0,linesAfter:f=0})=>{await Promise.allSettled([d("before",g,a,h),d("after",f,l,h)])},resetContextLogs:()=>{a([]),l([]),m({before:!0,after:!0})},abortController:s}},Ft=(t,o,i)=>{const s=M(r=>{const a=t?.current,c=r.target,l=i?.current&&i.current.contains(c);!a||a.contains(r?.target||null)||l||o(r)},[t,o]);ie("mouseup",s),ie("touchstart",s)},Fe=({children:t,buttonRef:o,placement:i="bottom-left",placementPosition:s,open:r=!1,onClose:a,offset:c={top:6,left:0},clickOutside:l=!0,fullWidth:n,title:m,disabledFullScreen:d,variant:u})=>{const{isMobile:p}=G(),h=Yt(),g=Ge(),[f,_]=S({width:0,height:0}),[y,b]=S(!1),v=D(null);A(()=>(b(r),!r&&a&&a(),r&&p&&!d&&(document.body.style.overflow="hidden"),()=>{document.body.style.overflow="auto"}),[r]),A(()=>{_({width:v?.current?.clientWidth||0,height:v?.current?.clientHeight||0}),b(!1)},[v]);const k=F(()=>{const T=o.current;if(!T||!y)return{};const C=T.getBoundingClientRect(),L={top:0,left:0,width:"auto"},E=i==="bottom-right"||i==="top-right",z=i?.includes("top"),U=c?.top||0,Y=c?.left||0;if(L.left=L.left=C.left+Y,L.top=C.height+C.top+U,E&&(L.left=C.right-f.width),z&&(L.top=C.top-f.height-U),i==="fixed"&&s)return L.top=Math.max(s.top+c.top,0),L.left=Math.max(s.left+c.left,0),L;const{innerWidth:W,innerHeight:K}=window,H=L.top+f.height>K,P=L.top<0,B=L.left+f.width>W,$=L.left<0;return H&&(L.top=C.top-f.height-U),P&&(L.top=C.height+C.top+U),B&&(L.left=C.right-f.width-Y),$&&(L.left=C.left+Y),n&&(L.width=`${C.width}px`),L.top<0&&(L.top=0),L.left<0&&(L.left=0),L},[o,i,y,t,n]),w=T=>{T.stopPropagation(),a()},x=()=>{b(!1),a()},q=()=>{l&&x()};A(()=>{if(!v.current||!y||p&&!d)return;const{right:T,width:C}=v.current.getBoundingClientRect();if(T>window.innerWidth){const L=window.innerWidth-C;v.current.style.left=`${L}px`}},[y,v,s]);const N=M(()=>{y&&p&&!d&&(h(g,{replace:!0}),a())},[y,p,d,g,a]);return ie("scroll",x),ie("popstate",N),Ft(v,q,o),e(V,{children:(y||!f.width)&&Qe(e("div",{className:I({"vm-popper":!0,[`vm-popper_${u}`]:u,"vm-popper_mobile":p&&!d,"vm-popper_open":(p||Object.keys(k).length)&&y}),ref:v,style:p&&!d?{}:k,children:[(m||p&&!d)&&e("div",{className:"vm-popper-header",children:[e("p",{className:"vm-popper-header__title",children:m}),e(R,{variant:"text",color:u==="dark"?"white":"primary",size:"small",onClick:w,ariaLabel:"close",children:e(Ke,{})})]}),t]}),document.body)})},Kc=({error:t,warning:o,info:i})=>{const s=D(null),[r,a]=S(!1),[c,l]=S(!1),m=`${F(()=>t?"ERROR: ":o?"WARNING: ":"",[t,o])}${t||o||i}`,d=()=>{const p=s.current;if(p){const{offsetWidth:h,scrollWidth:g,offsetHeight:f,scrollHeight:_}=p,y=h+1<g||f+1<_;a(y)}else a(!1)},u=()=>{r&&(l(!0),a(!1))};return A(()=>{l(!1),d()},[s,m]),ie("resize",d),!t&&!o&&!i?null:e("span",{className:I({"vm-text-field__error":!0,"vm-text-field__warning":o&&!t,"vm-text-field__helper-text":!o&&!t,"vm-text-field__error_overflowed":r,"vm-text-field__error_full":c}),"data-show":!!m,ref:s,onClick:u,children:m})},Te=Qt(({label:t,value:o,type:i="text",error:s="",warning:r="",helperText:a="",placeholder:c,endIcon:l,startIcon:n,disabled:m=!1,autofocus:d=!1,inputmode:u="text",caretPosition:p,onChange:h,onEnter:g,onKeyDown:f,onFocus:_,onBlur:y,onChangeCaret:b},v)=>{const{isDarkTheme:k}=se(),{isMobile:w}=G(),x=D(null),q=D(null),N=F(()=>i==="textarea"?q:x,[i]),T=I({"vm-text-field__input":!0,"vm-text-field__input_error":s,"vm-text-field__input_warning":!s&&r,"vm-text-field__input_icon-start":n,"vm-text-field__input_disabled":m,"vm-text-field__input_textarea":i==="textarea"}),C=$=>{if(!b)return;const{selectionStart:j,selectionEnd:X}=$;b&&b([j||0,X||0])},L=$=>{C($.currentTarget)},E=$=>{f&&f($);const{key:j,ctrlKey:X,metaKey:le}=$,re=j==="Enter";(i!=="textarea"?re:re&&(le||X))&&g&&($.preventDefault(),g())},z=$=>{C($.currentTarget)},U=$=>{m||(h&&h($.currentTarget.value),C($.currentTarget))},Y=()=>{_&&_()},W=()=>{y&&y()},K=$=>{try{N.current&&N.current.setSelectionRange($[0],$[1])}catch(j){return j}},H=M($=>{v&&(typeof v=="function"?v($):v.current=$)},[]),P=M($=>{H($),x.current=$},[]),B=M($=>{H($),q.current=$},[]);return A(()=>{!d||w||N?.current?.focus&&N.current.focus()},[N,d]),A(()=>{p&&K(p)},[p]),e("label",{className:I({"vm-text-field":!0,"vm-text-field_textarea":i==="textarea","vm-text-field_dark":k}),"data-replicated-value":o,children:[n&&e("div",{className:"vm-text-field__icon-start",children:n}),l&&e("div",{className:"vm-text-field__icon-end",children:l}),i==="textarea"?e("textarea",{className:T,disabled:m,ref:B,value:o,rows:1,inputMode:u,placeholder:c,autoCapitalize:"none",onInput:U,onKeyDown:E,onKeyUp:z,onFocus:Y,onBlur:W,onMouseUp:L}):e("input",{className:T,disabled:m,ref:P,value:o,type:i,placeholder:c,inputMode:u,autoCapitalize:"none",onInput:U,onKeyDown:E,onKeyUp:z,onFocus:Y,onBlur:W,onMouseUp:L}),t&&e("span",{className:"vm-text-field__label",children:t}),e(Kc,{error:s,warning:r,info:a})]})}),Wc=[10,25,50,100,250,500,1e3],ye=t=>{const{limit:o,label:i,options:s,allowUnlimited:r,isLoading:a,error:c,searchable:l,textNoOptions:n,onChange:m,onOpenSelect:d,renderOptionLabel:u}=t,[p,h]=S(""),{isMobile:g}=G(),f=D(null),_=F(()=>{const q=s||Wc;return r?[...q,0]:q},[r,s]),y=F(()=>{if(!l||!p.trim())return _;const q=p.toLowerCase();return _.filter(N=>String(N).toLowerCase().includes(q))},[_,p,l]),{value:b,toggle:v,setFalse:k}=ee(),w=()=>{v(),b||d?.()},x=q=>()=>{m(q),k()};return e(V,{children:[e("div",{className:"vm-select-limits-button",onClick:w,ref:f,children:[e("div",{children:[i||(g?"Rows":"Rows per page"),": ",e("b",{children:u?u(o,!0):o||"All"})]}),e(Ve,{})]}),e(Fe,{open:b,onClose:k,placement:"bottom-right",buttonRef:f,children:e("div",{className:"vm-select-limits",children:[a&&e(R,{disabled:!0,color:"gray",variant:"text",startIcon:e(eo,{}),children:"loading..."}),c&&e("div",{className:"vm-select-limits__error",children:[e(Wt,{}),c]}),!a&&!c&&_.length===0&&e("div",{className:"vm-select-limits__empty",children:n||"No options available"}),l&&!a&&!c&&!!_.length&&e("div",{className:"vm-select-limits__search",children:e(Te,{autofocus:!0,label:"Search",value:p,onChange:h})}),e("div",{className:"vm-select-limits-list",children:!a&&!c&&y.map(q=>e("div",{className:I({"vm-list-item":!0,"vm-select-limits__item":!0,"vm-list-item_mobile":g,"vm-list-item_active":q===o}),onClick:x(q),children:u?u(q,!1):q||"All"},q))})]})})]})},pe={home:"/",overview:"/overview",streamContext:"/stream-context/:_stream_id/:_time",icons:"/icons"},bt={[pe.home]:{title:"Query",header:{tenant:!0,timeSelector:!0,executionControls:!0}},[pe.overview]:{title:"Overview",header:{tenant:!0,timeSelector:!0,executionControls:!0}},[pe.icons]:{title:"Icons",header:{}},[pe.streamContext]:{title:"Stream context",header:{}}},Zs=({log:t,displayFields:o,isModal:i})=>{const[s,r]=te(),a=s.get(oe.NO_WRAP_LINES)==="true",[c,l]=S(10),{logsBefore:n,logsAfter:m,hasMore:d,isLoading:u,error:p,fetchContextLogs:h,resetContextLogs:g,abortController:f}=Gc(),_=()=>{const k=m[0];h({log:k,linesAfter:c})},y=()=>{const k=n[n.length-1];h({log:k,linesBefore:c})},b=k=>{l(k)},v=()=>{s.set(oe.NO_WRAP_LINES,String(!a)),r(s)};return A(()=>(h({log:t,linesBefore:10,linesAfter:10}),()=>{g(),f?.abort()}),[]),e("div",{className:I({"vm-steam-context":!0,"vm-steam-context_modal":i}),children:[u&&e(dt,{}),p&&e(fe,{variant:"error",children:p}),e("div",{className:"vm-steam-context-header",children:[!i&&e("div",{className:"vm-steam-context-header-title",children:[e("h1",{className:"vm-modal-content-header__title",children:"Log context"}),e("p",{className:"vm-steam-context-header-title__info",children:[e("span",{children:["_stream_id: ",t._stream_id]}),e("span",{children:["_time: ",t._time]})]})]}),i&&e("div",{className:"vm-steam-context-header__link",children:e(rs,{target:"_blank",to:Fr(pe.streamContext,{_stream_id:t._stream_id,_time:t._time}),rel:"noreferrer",children:e(R,{startIcon:e(ai,{}),variant:"text",size:"small",children:"Open in new page"})})}),e(ue,{label:"Wrap lines",value:!a,onChange:v}),e(ye,{limit:c,label:"Logs per load",options:[5,10,20,50,100],onChange:b})]}),e("div",{className:"vm-steam-context__load-more vm-steam-context__load-more_after",children:e(R,{onClick:_,disabled:u||!d.after,variant:d.after?"contained":"text",children:d.after?"Load newer logs":"no more logs after"})}),e("div",{className:"vm-group-logs-section-rows",children:[m.map((k,w)=>e(Ut,{isContextView:!0,hideGroupButton:!0,log:k,displayFields:o},`${w}_${k._time}`)),n.map((k,w)=>e(Ut,{isContextView:!0,hideGroupButton:!0,log:k,displayFields:o,className:w===0?"vm-steam-context__target-row":""},`${w}_${k._time}`))]}),e("div",{className:"vm-steam-context__load-more vm-steam-context__load-more_before",children:e(R,{onClick:y,disabled:u||!d.before,variant:d.before?"contained":"text",children:d.before?"Load older logs":"no more logs before"})})]})},Zc=({log:t,displayFields:o})=>{const i=["_stream_id","_time"],s=F(()=>i.every(m=>t[m]),[t]),{value:r,setTrue:a,setFalse:c}=ee(),l=m=>{m.stopPropagation(),a()},n=()=>{c()};return s?e(V,{children:[e(Q,{title:"Show context",children:e(R,{variant:"text",color:"gray",startIcon:e(zs,{}),onClick:l,ariaLabel:"show context"})}),r&&e(ke,{title:"Log context",isOpen:r,onClose:n,children:e(Zs,{isModal:!0,log:t,displayFields:o})})]}):null},Jc=({log:t,displayFields:o=[],isContextView:i,hideGroupButton:s,className:r,onItemClick:a})=>{const{isDarkTheme:c}=se(),{isMobile:l}=G(),{value:n,toggle:m}=ee(),[d,u]=S(!1),p=ve(),[h]=te(),{markdownParsing:g,ansiParsing:f}=Wo(),{timezone:_}=ce(),y=h.get(oe.NO_WRAP_LINES)==="true",b=h.get(oe.DATE_FORMAT)||ot,v=F(()=>t._time?wa(t._time,b):"",[t._time,_,b]),k=F(()=>!g||!t._msg||!o.includes("_msg")?"":Ro(t._msg.replace(/```/g,"\n```\n")),[t._msg,g,o]),w=Object.keys(t).length>0,x=F(()=>{const C=[];return w||C.push("-"),o.some(L=>t[L])?o.filter(L=>t[L]).forEach(L=>{let E=t[L];const z=L==="_msg";z&&f&&(E=fc(t[L])),z&&g&&(E=""),E&&C.push(E)}):Object.entries(t).forEach(([L,E])=>{C.push(`${L}: ${E}`)}),C},[t,w,o,f,g]),[q]=xt("LOGS_DISABLED_HOVERS"),N=()=>{m(),a?.(t)},T=M(async C=>{if(C.stopPropagation(),!d)try{await p(JSON.stringify(t,null,2)),u(!0)}catch(L){console.error(L)}},[d,p]);return A(()=>{if(d===null)return;const C=setTimeout(()=>u(!1),2e3);return()=>clearTimeout(C)},[d]),e("div",{className:I("vm-group-logs-row",r),children:[e("div",{className:I({"vm-group-logs-row-content":!0,"vm-group-logs-row-content_mobile":l,"vm-group-logs-row-content_dark":c,"vm-group-logs-row-content_active":n,"vm-group-logs-row-content_interactive":!q}),onClick:N,children:[w&&e("div",{className:I({"vm-group-logs-row-content__arrow":!0,"vm-group-logs-row-content__arrow_open":n}),children:e(ge,{})}),e("div",{className:I({"vm-group-logs-row-content__time":!0,"vm-group-logs-row-content__time_missing":!v}),children:v||"timestamp missing"}),e("div",{className:I({"vm-group-logs-row-content__msg":!0,"vm-group-logs-row-content__msg_empty-msg":!t._msg,"vm-group-logs-row-content__msg_missing":!x,"vm-group-logs-row-content__msg_single-line":y}),children:[k&&e("span",{dangerouslySetInnerHTML:{__html:k}}),x.map((C,L)=>e("span",{className:"vm-group-logs-row-content__sub-msg",children:C},`${C}_${L}`))]}),e("div",{className:I({"vm-group-logs-row-content__actions":!0,"vm-group-logs-row-content__actions_active":n}),children:[!i&&e(Zc,{log:t,displayFields:o}),e(Q,{title:d?"Copied":"Copy to clipboard",children:e(R,{variant:"text",color:"gray",startIcon:e(we,{}),onClick:T,ariaLabel:"copy to clipboard"})})]})]}),w&&n&&e(bc,{hideGroupButton:s,log:t})]})},Ut=ct(Jc),Js=({value:t,options:o,anchor:i,disabled:s,minLength:r=2,fullWidth:a,selected:c,noOptionsText:l,label:n,disabledFullScreen:m,offset:d,maxDisplayResults:u,loading:p,onSelect:h,onOpenAutocomplete:g,onFoundOptions:f,onChangeWrapperRef:_})=>{const{isMobile:y}=G(),b=D(null),[v,k]=S({index:-1}),[w,x]=S(""),[q,N]=S(0),{value:T,setValue:C,setFalse:L}=ee(),E=F(()=>{if(!T)return[];try{const P=new RegExp(String(t.trim()),"i"),$=o.filter(j=>P.test(j.value)).sort((j,X)=>j.value.toLowerCase()===t.trim().toLowerCase()?-1:X.value.toLowerCase()===t.trim().toLowerCase()?1:(j.value.match(P)?.index||0)-(X.value.match(P)?.index||0));return N($.length),x($.length>Number(u?.limit)&&u?.message||""),u?.limit?$.slice(0,u.limit):$}catch{return[]}},[T,o,t]),z=F(()=>E.length===1&&E[0]?.value===t,[E]),U=F(()=>l&&!E.length,[l,E]),Y=P=>()=>{s||(h(P.value,P),c||L())},W=P=>()=>{k({index:P,type:0})},K=()=>{if(!b.current||v.type===0)return;const P=b.current.childNodes[v.index];P?.scrollIntoView&&P.scrollIntoView({block:"center"})},H=M(P=>{const{key:B,ctrlKey:$,metaKey:j,shiftKey:X}=P,le=$||j||X,re=E.length&&!z;if(B==="ArrowUp"&&!le&&re&&(P.preventDefault(),k(({index:ne})=>({index:ne<=0?0:ne-1,type:1}))),B==="ArrowDown"&&!le&&re){P.preventDefault();const ne=E.length-1;k(({index:Ee})=>({index:Ee>=ne?ne:Ee+1,type:1}))}if(B==="Enter"){const ne=E[v.index];ne&&h(ne.value,ne),c||L()}B==="Escape"&&L()},[v,E,z,L,h,c]);return A(()=>{C(t.length>=r)},[t,o]),ie("keydown",H),A(K,[v,E]),A(()=>{k({index:-1})},[E]),A(()=>{g&&g(T)},[T]),A(()=>{f&&f(z?[]:E)},[E,z]),A(()=>{_&&_(b)},[b]),e(Fe,{open:T,buttonRef:i,placement:"bottom-left",onClose:L,fullWidth:a,title:y?n:void 0,disabledFullScreen:m,offset:d,children:[e("div",{className:I({"vm-autocomplete":!0,"vm-autocomplete_mobile":y&&!m}),ref:b,children:[p&&e("div",{className:"vm-autocomplete__loader",children:[e(Xo,{}),e("span",{children:"Loading..."})]}),U&&e("div",{className:"vm-autocomplete__no-options",children:l}),!z&&E.map((P,B)=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":y,"vm-list-item_active":B===v.index,"vm-list-item_multiselect":c,"vm-list-item_multiselect_selected":c?.includes(P.value),"vm-list-item_with-icon":P.icon}),id:`$autocomplete$${P.value}`,onClick:Y(P),onMouseEnter:W(B),children:[c?.includes(P.value)&&e(Ct,{}),e(V,{children:P.icon}),e("span",{children:P.value})]},`${B}${P.value}`))]}),w&&e("div",{className:"vm-autocomplete-message",children:["Shown ",u?.limit," results out of ",q,". ",w]}),E[v.index]?.description&&e("div",{className:"vm-autocomplete-info",children:[e("div",{className:"vm-autocomplete-info__type",children:E[v.index].type}),e("div",{className:"vm-autocomplete-info__description",dangerouslySetInnerHTML:{__html:E[v.index].description||""}})]})]})},Xc=({values:t,onRemoveItem:o})=>{const{isMobile:i}=G(),s=r=>a=>{o(r),a.stopPropagation()};return i?e("span",{className:"vm-select-input-content__counter",children:["selected ",t.length]}):e(V,{children:t.map(r=>e("div",{className:"vm-select-input-content__selected",children:[e("span",{children:r}),e("div",{onClick:s(r),children:e(Ke,{})})]},r))})},Ci=({value:t,list:o,label:i,placeholder:s,noOptionsText:r,clearable:a=!1,searchable:c=!1,autofocus:l,disabled:n,onChange:m,onOpen:d})=>{const{isDarkTheme:u}=se(),{isMobile:p}=G(),[h,g]=S(""),f=D(null),[_,y]=S(null),[b,v]=S(!1),k=D(null),w=Array.isArray(t),x=Array.isArray(t)?t:void 0,q=p&&w&&!!x?.length,N=F(()=>b?h:Array.isArray(t)?"":t,[t,h,b,w]),T=F(()=>b?h||"(.+)":"",[h,b]),C=()=>{k.current&&k.current.blur()},L=()=>{v(!1),C()},E=()=>{n||v(!0)},z=()=>{o.includes(h)&&m(h)},U=P=>{P.target instanceof HTMLInputElement||n||v(B=>!B)},Y=P=>{g(""),m(P),w||L(),w&&k.current&&k.current.focus()},W=P=>{g(P.target.value)},K=P=>B=>{Y(P),B.stopPropagation()},H=P=>{k.current!==P.target&&v(!1)};return A(()=>{g(""),b&&k.current&&k.current.focus(),b||C()},[b,k]),A(()=>{!l||!k.current||p||k.current.focus()},[l,k]),A(()=>{d&&d(b)},[b]),ie("keyup",H),Ft(f,L,_),e("div",{className:I({"vm-select":!0,"vm-select_dark":u,"vm-select_disabled":n}),children:[e("div",{className:"vm-select-input",onClick:U,ref:f,children:[e("div",{className:"vm-select-input-content",children:[!!x?.length&&e(Xc,{values:x,onRemoveItem:Y}),!q&&e("input",{value:N,type:"text",placeholder:s,onInput:W,onFocus:E,onBlur:z,ref:k,readOnly:p||!c})]}),i&&e("span",{className:"vm-text-field__label",children:i}),a&&t&&e("div",{className:"vm-select-input__icon",onClick:K(""),children:e(Ke,{})}),e("div",{className:I({"vm-select-input__icon":!0,"vm-select-input__icon_open":b}),children:e(Ve,{})})]}),e(Js,{label:i,value:T,options:o.map(P=>({value:P})),anchor:f,selected:x,minLength:1,fullWidth:!0,noOptionsText:r,onSelect:Y,onOpenAutocomplete:v,onChangeWrapperRef:y})]})},en=({text:t,href:o,children:i,colored:s=!0,underlined:r=!1,withIcon:a=!1})=>e("a",{href:o,className:I({"vm-link":!0,"vm-link_colored":s,"vm-link_underlined":r,"vm-link_with-icon":a}),target:"_blank",rel:"noreferrer",children:t||i}),tn=()=>{const{markdownParsing:t,ansiParsing:o}=Wo(),i=bs();return e(V,{children:[e("div",{className:"vm-group-logs-configurator-item",children:[e(ue,{label:"Enable markdown parsing",value:t,onChange:a=>{i({type:"SET_MARKDOWN_PARSING",payload:a}),o&&i({type:"SET_ANSI_PARSING",payload:!1})}}),e("div",{className:"vm-group-logs-configurator-item__info",children:"Toggle this switch to enable or disable the Markdown formatting for log entries. Enabling this will parse log texts to Markdown."})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(ue,{label:"Enable ANSI parsing",value:o,onChange:a=>{i({type:"SET_ANSI_PARSING",payload:a}),t&&i({type:"SET_MARKDOWN_PARSING",payload:!1})}}),e("div",{className:"vm-group-logs-configurator-item__info",children:"Toggle this switch to enable or disable ANSI escape sequence parsing for log entries. Enabling this will interpret ANSI codes to render colored log output."})]})]})},{GROUP_BY:Ai,NO_WRAP_LINES:Ti,COMPACT_GROUP_HEADER:Li,DISPLAY_FIELDS:po,DATE_FORMAT:uo}=oe,Rt="Group view settings",on=({logs:t})=>{const[o,i]=te(),s=o.get(Ai)||Ce,r=o.get(Ti)==="true",a=o.get(Li)==="true",c=o.get(po)||"",l=c?c.split(","):[it],[n,m]=S(o.get(uo)||ot),[d,u]=S(""),[p,h]=xt("LOGS_DISABLED_HOVERS"),g=s!==Ce,f=l.length!==1||l[0]!==it,_=n!==ot,y=[g,f,r,a,_].some(Boolean),b=F(()=>{const U=new Set(t.map(Y=>Object.keys(Y)).flat());return Array.from(U).sort((Y,W)=>Y.localeCompare(W))},[t]),{value:v,toggle:k,setFalse:w}=ee(),x=U=>{o.set(Ai,U),i(o)},q=U=>{const Y=l,W=Y.includes(U)?Y.filter(K=>K!==U):[...Y,U];o.set(po,W.join(",")),i(o)},N=()=>{o.delete(po),i(o)},T=()=>{o.set(Ti,String(!r)),i(o)},C=()=>{o.set(Li,String(!a)),i(o)},L=U=>{O(new Date,U,!0).isValid()||u("Invalid date format"),m(U)},E=()=>{n===ot?o.delete(uo):o.set(uo,n),i(o),w()};return e(V,{children:[e("div",{className:"vm-group-logs-configurator-button",children:[e(Q,{title:y?e("div",{className:"vm-group-logs-configurator__tooltip",children:[e("p",{children:Rt}),e("hr",{}),e("ul",{children:[g&&e("li",{children:["Group by ",e("code",{children:`"${s}"`})]}),f&&e("li",{children:["Display fields: ",l.length||1]}),r&&e("li",{children:"Single-line text is enabled"}),a&&e("li",{children:"Compact group header is enabled"}),_&&e("li",{children:["Date format: ",e("code",{children:n})]})]})]}):Rt,children:e(R,{variant:"text",startIcon:e(st,{}),onClick:k,ariaLabel:Rt})}),y&&e("span",{className:"vm-group-logs-configurator-button__marker"})]}),v&&e(ke,{title:Rt,onClose:E,children:e("div",{className:"vm-group-logs-configurator",children:[e("div",{className:"vm-group-logs-configurator-item",children:[e(Ci,{value:s,list:[xo,...b],label:"Group by field",placeholder:"Group by field",onChange:x,searchable:!0}),e(Q,{title:"Reset grouping",children:e(R,{variant:"text",color:"primary",startIcon:e(ft,{}),onClick:()=>x(Ce)})}),e("span",{className:"vm-group-logs-configurator-item__info",children:["Select a field to group logs by (default: ",e("code",{children:Ce}),")."]})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(Ci,{value:l,list:b,label:"Display fields",placeholder:"Display fields",onChange:q,searchable:!0}),e(Q,{title:"Clear fields",children:e(R,{variant:"text",color:"primary",startIcon:e(ft,{}),onClick:N})}),e("span",{className:"vm-group-logs-configurator-item__info",children:["Select fields to display instead of the message (default: ",e("code",{children:it}),")."]})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(Te,{autofocus:!0,label:"Date format",value:n,onChange:L,error:d}),e(Q,{title:"Reset format",children:e(R,{variant:"text",color:"primary",startIcon:e(ft,{}),onClick:()=>m(ot)})}),e("span",{className:"vm-group-logs-configurator-item__info vm-group-logs-configurator-item__info_input",children:["Set the date format (e.g., ",e("code",{children:"YYYY-MM-DD HH:mm:ss"}),"). Learn more in ",e(en,{href:"https://day.js.org/docs/en/display/format",children:"this documentation"}),". ",e("br",{}),"Your current date format: ",e("code",{children:O().format(n||ot)})]})]}),e(tn,{}),e("div",{className:"vm-group-logs-configurator-item",children:[e(ue,{value:r,onChange:T,label:"Single-line message"}),e("span",{className:"vm-group-logs-configurator-item__info",children:"Displays message in a single line and truncates it with an ellipsis if it exceeds the available space."})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(ue,{value:a,onChange:C,label:"Compact group header"}),e("span",{className:"vm-group-logs-configurator-item__info",children:'Shows group headers in one line with a "+N more" badge for extra fields.'})]}),e("div",{className:"vm-group-logs-configurator-item",children:[e(ue,{value:p,onChange:h,label:"Disable hover effects"}),e("span",{className:"vm-group-logs-configurator-item__info",children:"Disable row highlighting on hover to improve performance with large datasets."})]})]})})]})},Fi=({pair:t,isHide:o})=>{const{isDarkTheme:i}=se(),s=ve(),[r]=te(),[a,c]=S(null),l=r.get(oe.GROUP_BY)||Ce,n=m=>async d=>{d.stopPropagation();const u=Ks(m,l);await s(u)&&c(m)};return A(()=>{if(a===null)return;const m=setTimeout(()=>c(null),2e3);return()=>clearTimeout(m)},[a]),e(Q,{title:a===t?"Copied":"Copy to clipboard",placement:"top-center",children:e("div",{className:I({"vm-group-logs-section-keys__pair":!0,"vm-group-logs-section-keys__pair_hide":o,"vm-group-logs-section-keys__pair_dark":i}),onClick:n(t),children:t})})},sn=({group:t,index:o})=>{const{isMobile:i}=G(),{isDarkTheme:s}=se(),[r]=te(),a=D(null),c=D(null),{value:l,toggle:n,setFalse:m}=ee(),[d,u]=S(0),p=r.get(oe.GROUP_BY)||Ce,h=i||r.get(oe.COMPACT_GROUP_HEADER)==="true",g=t.pairs,f=g.length-d-1,_=b=>{b.stopPropagation(),n()},y=M(()=>{if(!h||!a.current){u(0);return}const b=a.current,v=b.getBoundingClientRect(),w=Array.from(b.querySelectorAll(".vm-group-logs-section-keys__pair:not(.vm-group-logs-section-keys__pair_more)"));let x=0;for(const q of w){const{right:N}=q.getBoundingClientRect();N+220>v.width&&x++}u(x)},[h,a]);return A(y,[t.pairs,h,a]),ie("resize",y),e("div",{className:I({"vm-group-logs-section-keys":!0,"vm-group-logs-section-keys_compact":h}),ref:a,children:[e("span",{className:"vm-group-logs-section-keys__title",children:p===xo?xo:e(V,{children:[o+1,". Group by ",e("code",{children:p}),":"]})}),g.map((b,v)=>e(Fi,{pair:b,isHide:d?v>f:!1},`${t.keysString}_${b}`)),d>0&&e(V,{children:[e("div",{className:I({"vm-group-logs-section-keys__pair":!0,"vm-group-logs-section-keys__pair_more":!0,"vm-group-logs-section-keys__pair_dark":s}),ref:c,onClick:_,children:["+",d," more"]}),e(Fe,{open:l,buttonRef:c,placement:"bottom-left",onClose:m,children:e("div",{className:"vm-group-logs-section-keys vm-group-logs-section-keys_popper",children:g.slice(f+1).map(b=>e(Fi,{pair:b},`${t.keysString}_${b}`))})})]}),e("span",{className:"vm-group-logs-section-keys__count",children:[t.total," entries"]})]})},li=({currentPage:t,totalItems:o,itemsPerPage:i,onPageChange:s,maxVisiblePages:r=10})=>{const a=Math.ceil(o/i),c=d=>{d<1||d>a||s(d)},l=F(()=>{const d=[];if(a<=r)for(let u=1;u<=a;u++)d.push(u);else{const u=Math.max(1,t-Math.floor(r/2)),p=Math.min(a,u+r-1);u>1&&(d.push(1),u>2&&d.push("..."));for(let h=u;h<=p;h++)d.push(h);p<a&&(p<a-1&&d.push("..."),d.push(a))}return d},[a,t,r]),n=d=>()=>{c(t+d)},m=d=>()=>{typeof d=="number"&&c(d)};return l.length<=1?null:e("div",{className:"vm-pagination",children:[e("button",{className:"vm-pagination__page vm-pagination__arrow vm-pagination__arrow_prev",onClick:n(-1),disabled:t===1,children:e(ge,{})}),l.map((d,u)=>e("button",{onClick:m(d),className:I({"vm-pagination__page":!0,"vm-pagination__page_active":t===d,"vm-pagination__page_disabled":d==="..."}),disabled:d==="...",children:d},u)),e("button",{className:"vm-pagination__page vm-pagination__arrow vm-pagination__arrow_next",onClick:n(1),disabled:t===a,children:e(ge,{})})]})},rn=(t,o,i)=>F(()=>{if(!i)return t;const s=(o-1)*i,r=s+i;let a=0;const c=[];for(const l of t){const n=l.values.length,m=a,d=a+n;if(d<=s){a=d;continue}if(m>=r)break;const u=Math.max(0,s-m),p=Math.min(n,r-m),h={...l,values:l.values.slice(u,p)};if(c.push(h),a=d,a>=r)break}return c},[t,o,i]),an=({logs:t,settingsRef:o})=>{const{isMobile:i}=G(),[s,r]=te(),[a,c]=S(1),[l,n]=S([]),m=s.get(oe.GROUP_BY)||Ce,d=s.get(oe.DISPLAY_FIELDS)||it,u=F(()=>d.split(","),[d]),p=s.get(oe.ROWS_PER_PAGE),h=p?Number(p):100,g=isNaN(h)?0:h,f=F(()=>l.every(Boolean),[l]),_=F(()=>js(t,[m]).map(x=>{const q=x.values[0]?.[m]||"",N=Gs(q),T=x.values;return{keys:x.keys,keysString:x.keys.join(""),values:T,pairs:N,total:T.length}}).sort((x,q)=>q.total-x.total),[t,m]),y=rn(_,a,g),b=M(()=>{n(new Array(_.length).fill(!f))},[f,_.length]),v=M(x=>q=>{n(N=>{const T=[...N];return T[x]=q,T})},[]),k=x=>{x?s.set(oe.ROWS_PER_PAGE,String(x)):s.set(oe.ROWS_PER_PAGE,"all"),r(s)},w=x=>{c(x),window.scrollTo({top:0})};return A(()=>{n(x=>{const q=x.every(N=>!N)&&x.length||i;return new Array(_.length).fill(!q)})},[_]),A(()=>{c(1)},[g,_]),e(V,{children:[e("div",{className:"vm-group-logs",children:[y.map((x,q)=>e("div",{className:"vm-group-logs-section",children:e($s,{defaultExpanded:l[q],onChange:v(q),title:e(sn,{group:x,index:q}),children:e("div",{className:"vm-group-logs-section-rows",children:x.values.map((N,T)=>e(Ut,{log:N,displayFields:u},`${q}_${T}_${N._time}`))})})},x.keysString)),e(li,{currentPage:a,totalItems:t.length,itemsPerPage:g||1/0,onPageChange:w})]}),o.current&&Qe(e("div",{className:"vm-group-logs-header",children:[e("div",{className:"vm-bar-hits-stats",children:[!i&&e(V,{children:[e("div",{className:"vm-bar-hits-stats__item",children:["Total logs returned: ",e("b",{children:t.length})]}),e("div",{className:"vm-bar-hits-stats__item",children:["Total groups: ",e("b",{children:_.length})]})]}),e(ye,{allowUnlimited:!0,limit:g,onChange:k})]}),e(Q,{title:f?"Collapse All":"Expand All",children:e(R,{variant:"text",startIcon:f?e(Os,{}):e(Ps,{}),onClick:b,ariaLabel:f?"Collapse All":"Expand All"})}),e(on,{logs:t})]}),o.current)]})},di=()=>e("div",{className:"vm-empty",children:"No logs found"}),cn=ct(an),nn=({data:t,settingsRef:o})=>t.length?e(V,{children:e(cn,{logs:t,settingsRef:o})}):e(di,{}),ln=["date","timestamp","time"];function Ei(t,o,i){const s=t[i],r=o[i];if(s==null&&r==null)return 0;if(s==null)return 1;if(r==null)return-1;const a=String(s),c=String(r);if(ln.includes(String(i))){const u=qi(a),p=qi(c);return p<u?-1:p>u?1:0}const n=Number(a),m=Number(c);return!isNaN(n)&&!isNaN(m)?m-n:c<a?-1:c>a?1:0}function dn(t,o){return t==="desc"?(i,s)=>Ei(i,s,o):(i,s)=>-Ei(i,s,o)}function mn(t,o){const i=t.map((s,r)=>[s,r]);return i.sort((s,r)=>{const a=o(s[0],r[0]);return a!==0?a:s[1]-r[1]}),i.map(s=>s[0])}const Xs=({rows:t,columns:o,defaultOrderBy:i,defaultOrderDir:s,copyToClipboard:r,isActiveRow:a,onClickRow:c,actionsRender:l,paginationOffset:n})=>{const m=ve(),[d,u]=S(i),[p,h]=S(s||"desc"),[g,f]=S(null),_=F(()=>{const{startIndex:v,endIndex:k}=n;return mn(t,dn(p,d)).slice(v,k)},[t,d,p,n]),y=v=>()=>{const{disableSort:k,key:w}=v;k||(h(x=>x==="asc"&&d===w?"desc":"asc"),u(w))},b=(v,k)=>async()=>{if(g!==k)try{await m(String(v)),f(k)}catch(w){console.error(w)}};return A(()=>{if(g===null)return;const v=setTimeout(()=>f(null),2e3);return()=>clearTimeout(v)},[g]),e("table",{className:"vm-table",children:[e("thead",{className:"vm-table-header",children:e("tr",{className:"vm-table__row vm-table__row_header",children:[o.map(v=>e("th",{className:I("vm-table-cell vm-table-cell_header",{"vm-table-cell_sort":!v.disableSort,"vm-table-cell_number":v.isNum}),onClick:y(v),children:e("div",{className:"vm-table-cell__content",children:[e("div",{children:String(v.title||v.key)}),e("div",{className:I({"vm-table__sort-icon":!0,"vm-table__sort-icon_active":d===v.key,"vm-table__sort-icon_desc":p==="desc"&&d===v.key}),children:!v.disableSort&&e(Ve,{})})]})},String(v.key))),l&&e("th",{className:"vm-table-cell vm-table-cell_header"}),r&&e("th",{className:"vm-table-cell vm-table-cell_header"})]})}),e("tbody",{className:"vm-table-body",children:_.map((v,k)=>e("tr",{className:I({"vm-table__row":!0,"vm-table__row_active":a&&a(v),"vm-table__row_clickable":!!c}),onClick:w=>c&&c(v,w),children:[o.map(w=>e("td",{className:I({"vm-table-cell":!0,"vm-table-cell_number":w.isNum,[`${w.className}`]:w.className}),children:w.render?w.render(v):v[w.key]||"-"},String(w.key))),l&&e("td",{className:"vm-table-cell vm-table-cell_no-padding",children:l(v)}),r&&e("td",{className:"vm-table-cell vm-table-cell_right",children:v[r]&&e("div",{className:"vm-table-cell__content",children:e(Q,{title:g===k?"Copied":"Copy row",children:e(R,{variant:"text",color:g===k?"success":"gray",size:"small",startIcon:g===k?e(Ct,{}):e(we,{}),onClick:b(v[r],k),ariaLabel:"copy row"})})})})]},k))})]})},pn=t=>t==="_time"?"vm-table-cell_logs-time":"vm-table-cell_logs",un=[{key:"_vmui_data",title:"Data",className:"vm-table-cell_logs vm-table-cell_pre"}],hn=({logs:t,displayColumns:o,tableCompact:i,columns:s,rowsPerPage:r})=>{const a=D(null),[c,l]=S(1),n=F(()=>t.map(h=>{const g=JSON.stringify(h,null,2);return{...h,_vmui_data:g}}),[t]),m=F(()=>s.map(h=>({key:h,title:h,className:pn(h)})),[s]),d=F(()=>i?un:o?.length?m.filter(h=>o.includes(h.key)):[],[m,o,i]),u=F(()=>{const h=(c-1)*r,g=h+r;return{startIndex:h,endIndex:g}},[c,r]),p=h=>{if(l(h),a.current){const g=a.current.getBoundingClientRect().top+window.scrollY-50;window.scrollTo({top:g})}};return A(()=>{l(1)},[t,r]),e(V,{children:[e("div",{ref:a,children:e(Xs,{rows:n,columns:d,defaultOrderBy:"_time",defaultOrderDir:"desc",copyToClipboard:"_vmui_data",paginationOffset:u})}),e(li,{currentPage:c,totalItems:n.length,itemsPerPage:r,onPageChange:p})]})},Lo=({checked:t=!1,disabled:o=!1,label:i,color:s="secondary",onChange:r})=>{const a=()=>{o||r(!t)},c=I({"vm-checkbox":!0,"vm-checkbox_disabled":o,"vm-checkbox_active":t,[`vm-checkbox_${s}_active`]:t,[`vm-checkbox_${s}`]:s});return e("div",{className:c,onClick:a,children:[e("div",{className:"vm-checkbox-track",children:e("div",{className:"vm-checkbox-track__thumb",children:e(Ct,{})})}),i&&e("span",{className:"vm-checkbox__label",children:i})]})},ho="Table settings",gn=({columns:t,selectedColumns:o=[],tableCompact:i,onChangeColumns:s,toggleTableCompact:r})=>{const[a,c]=te(),l=D(null),{value:n,toggle:m,setFalse:d}=ee(),[u,p]=S(""),[h,g]=S(-1),f=F(()=>o.filter(N=>!t.includes(N)),[t,o]),_=F(()=>{const N=f.concat(t);return(u?N.filter(C=>C.includes(u)):N).sort((C,L)=>C.localeCompare(L))},[t,f,u]),y=F(()=>_.every(N=>o.includes(N)),[o,_]),b=N=>{s(N);const T=new URLSearchParams(a.toString());N.length===t.length?T.delete("columns"):T.set("columns",N.map(encodeURIComponent).join(",")),c(T)},v=N=>{const T=o.includes(N)?o.filter(C=>C!==N):[...o,N];b(T)},k=()=>{b(y?o.filter(N=>!_.includes(N)):_)},w=N=>()=>{v(N)},x=()=>{g(-1)},q=N=>{const T=N.key==="ArrowUp",C=N.key==="ArrowDown",L=N.key==="Enter";(C||T||L)&&N.preventDefault(),C?g(E=>E+1>_.length-1?E:E+1):T?g(E=>E-1<0?E:E-1):L&&v(_[h])};return A(()=>{Us(t,o)||a.has("columns")||s(t)},[t]),A(()=>{if(!a.has("columns"))return;const C=(a.get("columns")||"").split(",").map(decodeURIComponent).filter(Boolean);s(C)},[]),e("div",{className:"vm-table-settings",children:[e(Q,{title:ho,children:e("div",{ref:l,children:e(R,{variant:"text",startIcon:e(st,{}),onClick:m,ariaLabel:ho})})}),n&&e(ke,{title:ho,className:"vm-table-settings-modal",onClose:d,children:[e("div",{className:"vm-table-settings-modal-section",children:[e("div",{className:"vm-table-settings-modal-section__title",children:"Customize columns"}),e("div",{className:"vm-table-settings-modal-columns",children:[e("div",{className:"vm-table-settings-modal-columns__search",children:e(Te,{placeholder:"Search columns",startIcon:e(ri,{}),value:u,onChange:p,onBlur:x,onKeyDown:q,type:"search"})}),e("div",{className:"vm-table-settings-modal-columns-list",children:[!!_.length&&e("div",{className:"vm-table-settings-modal-columns-list__item vm-table-settings-modal-columns-list__item_all",children:e(Lo,{checked:y,onChange:k,label:y?"Uncheck all":"Check all",disabled:i})}),!_.length&&e("div",{className:"vm-table-settings-modal-columns-no-found",children:e("p",{className:"vm-table-settings-modal-columns-no-found__info",children:"No columns found."})}),_.map((N,T)=>e("div",{className:I({"vm-table-settings-modal-columns-list__item":!0,"vm-table-settings-modal-columns-list__item_focus":T===h,"vm-table-settings-modal-columns-list__item_custom":f.includes(N)}),children:e(Lo,{checked:o.includes(N),onChange:w(N),label:N,disabled:i})},N))]})]})]}),r&&i!==void 0&&e("div",{className:"vm-table-settings-modal-section",children:[e("div",{className:"vm-table-settings-modal-section__title",children:"Table view"}),e("div",{className:"vm-table-settings-modal-columns-list__item",children:e(ue,{label:"Compact view",value:i,onChange:r})})]})]})]})},fn=ct(hn),vn=({data:t,settingsRef:o})=>{const{setSearchParamsFromKeys:i}=Lt(),[s,r]=S([]),[a,c]=de(100,"rows_per_page"),l=F(()=>{const d=new Set;for(const u of t)for(const p in u)d.add(p);return Array.from(d).sort((u,p)=>u.localeCompare(p))},[t]),n=d=>{c(d),i({rows_per_page:d})},m=()=>o.current?Qe(e("div",{className:"vm-table-view__settings",children:[e(ye,{limit:a,onChange:n}),e("div",{className:"vm-table-view__settings-buttons",children:e(gn,{columns:l,selectedColumns:s,onChangeColumns:r})})]}),o.current):null;return t.length?e(V,{children:[m(),e(fn,{logs:t,displayColumns:s,tableCompact:!1,columns:l,rowsPerPage:Number(a)})]}):e(di,{})},er=({className:t})=>{const[o,i]=S(!1),s=()=>{const a=window.pageYOffset||document.documentElement.scrollTop,c=window.innerHeight;i(a>c)},r=M(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);return A(()=>(window.addEventListener("scroll",s),s(),()=>{window.removeEventListener("scroll",s)}),[]),e("div",{className:I({"vm-scroll-to-top-button":!0,"vm-scroll-to-top-button_visible":o},t),children:e(Q,{title:"Scroll to top",children:e(R,{variant:"contained",color:"primary",onClick:r,ariaLabel:"Scroll to top",startIcon:e(Ds,{})})})})},_n=({title:t,getData:o,successfulCopiedMessage:i})=>{const s=ve(),r=M(()=>{s(o(),i)},[o,i]);return e(Q,{title:t,children:e(R,{variant:"text",startIcon:e(we,{}),onClick:r,ariaLabel:t})})},yn=({data:t})=>{const o=F(()=>t.map(i=>{const s=JSON.stringify(i,null,4);return s.length>100?s:JSON.stringify(i)}).join(`
`),[t]);return e("pre",{style:"line-height: 1.2em",children:o})},bn=ct(yn),wn=({data:t,settingsRef:o})=>{const i=F(()=>{const c=new Set(t.flatMap(Object.keys));return Array.from(c)},[t]),s=F(()=>{const c=i.toSorted((l,n)=>l.localeCompare(n));return t.map(l=>c.reduce((n,m)=>(l[m]&&(n[m]=l[m]),n),{}))},[i,t]),r=M(()=>JSON.stringify(s,null,2),[s]),a=()=>o.current?Qe(t.length>0&&e("div",{className:"vm-json-view__settings-container",children:e(_n,{title:"Copy JSON",getData:r,successfulCopiedMessage:"Copied JSON to clipboard"})}),o.current):null;return t.length?e("div",{className:"vm-json-view",children:[a(),e(bn,{data:s}),e(er,{})]}):e(di,{})};class kn{threshold;windowSize;minHighCount;minNormalCount;window;state;constructor(o=200,i=10,s=6,r=2){this.threshold=o,this.windowSize=i,this.minHighCount=s,this.minNormalCount=r,this.window=[],this.state="normal"}update(o){this.window.push(o),this.window.length>this.windowSize&&this.window.shift();const i=this.window.filter(s=>s>this.threshold).length;return this.state==="normal"?i>=this.minHighCount&&(this.state="high"):this.state==="high"&&i<this.minNormalCount&&(this.state="normal"),this.state}}const Fo="live_tailing_offset",Ii=200,Mi=5e3,Pi=1e3,qn=(t,o,i,s)=>async r=>{let a=Date.now();const c=setInterval(()=>{if(Date.now()-a>Mi){clearInterval(c),s();return}},Mi);try{for(;;){const{done:l,value:n}=await r.read();if(l)break;a=Date.now();const m=new TextDecoder().decode(n),d=(t.current+m).split(`
`);t.current=d.pop()||"",o.current=[...o.current,...d]}}catch(l){l instanceof Error&&l.name!=="AbortError"&&(console.error("Stream processing error:",l),s())}finally{clearInterval(c)}},xn=(t,o)=>t.map(i=>{try{const s=i&&JSON.parse(i);return s._log_id=o.current++,s}catch(s){return console.error(`Failed to parse "${i}" to JSON
`,s),null}}).filter(Boolean),Nn=({lines:t,limit:o,counterRef:i,setIsLimitedLogsPerUpdate:s,setLogs:r,bufferLinesRef:a,logFlowAnalyzerRef:c})=>{const l=c?.current?.update(t.length)==="high",n=l&&t.length>Ii?t.slice(-Ii):t,m=xn(n,i);s(l),r(d=>{const u=[...d,...m];return u.length>o?u.slice(-o):u}),a.current=[]},Sn=(t,o)=>{const{serverUrl:i}=se(),[s]=de(5,Fo),[r,a]=S([]),{value:c,setTrue:l,setFalse:n}=ee(),m=Je(),[d,u]=S(),[p,h]=S(!1),g=D(0n),f=D(new AbortController),_=D(null),y=D(null),b=D(""),v=D([]),k=D(new kn),w=M(()=>{_.current&&(_.current.cancel(),_.current=null),y.current&&clearInterval(y.current),b.current&&(b.current=""),f.current.abort()},[]),x=M(async()=>{w(),f.current=new AbortController;const{signal:N}=f.current;u(void 0);try{const T=await fetch(`${i}/select/logsql/tail`,{signal:N,method:"POST",headers:{...m},body:new URLSearchParams({query:t.trim(),offset:`${s}s`})});if(!T.ok||!T.body){const E=await T.text();return u(E),a([]),!1}const C=T.body.getReader();return _.current=C,qn(b,v,u,x)(C),!0}catch(T){return T instanceof Error&&T.name!=="AbortError"&&(u(String(T)),console.error(T),a([])),!1}},[t,w,s]);A(()=>{if(c){const T=setInterval(()=>{v.current.length>o&&(v.current=v.current.slice(-o))},Pi);return()=>{clearInterval(T)}}const N=setInterval(()=>{const T=v.current;Nn({lines:T,limit:o,counterRef:g,setIsLimitedLogsPerUpdate:h,setLogs:a,bufferLinesRef:v,logFlowAnalyzerRef:k})},Pi);return()=>clearInterval(N)},[o,c,p]);const q=M(()=>{a([])},[]);return{logs:r,isPaused:c,error:d,startLiveTailing:x,stopLiveTailing:w,pauseLiveTailing:l,resumeLiveTailing:n,clearLogs:q,isLimitedLogsPerUpdate:p}},Cn=({settingsRef:t,rowsPerPage:o,handleSetRowsPerPage:i,isPaused:s,handleResumeLiveTailing:r,pauseLiveTailing:a,clearLogs:c,isRawJsonView:l,onRawJsonViewChange:n,offset:m,handleSetOffset:d})=>{const u=D(null),{value:p,setFalse:h,setTrue:g}=ee();return t.current?Qe(e("div",{className:"vm-live-tailing-view__settings",children:[e(ye,{limit:o,onChange:i,onOpenSelect:a}),e(ye,{label:"Offset",limit:m,options:[5,10,15,30,45,60],onChange:d,onOpenSelect:a,renderOptionLabel:f=>`${f}s`}),e("div",{className:"vm-live-tailing-view__settings-buttons",children:[e(Q,{title:`${s?"Resume":"Pause"} live tailing`,children:e(R,{variant:"text",color:"primary",onClick:s?r:a,startIcon:s?e(ti,{}):e(Rs,{}),ariaLabel:`${s?"Resume":"Pause"} live tailing`})}),e(Q,{title:"Clear logs",children:e(R,{variant:"text",color:"secondary",onClick:c,startIcon:e(St,{}),ariaLabel:"Clear logs"})}),e(Q,{title:"Settings",children:e(R,{ref:u,variant:"text",onClick:g,startIcon:e(st,{}),ariaLabel:"Settings"})}),p&&e(ke,{onClose:h,title:"Live tailing settings",children:e("div",{className:"vm-live-tailing-view__settings-modal",children:e("div",{className:"vm-live-tailing-view__settings-modal-item",children:[e(ue,{label:"Raw JSON View",value:l,onChange:n}),e("span",{className:"vm-group-logs-configurator-item__info",children:"When this option is enabled, logs will be displayed in raw JSON format. This improves performance and uses less CPU and memory."})]})})})]})]}),t.current):null},An=100,Tn=()=>window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"}),Oi=Er(Tn,200),Ln=({settingsRef:t})=>{const o=D(null),[i,s]=S(!0),[r]=te(),{setSearchParamsFromKeys:a}=Lt(),[c]=de(100,"rows_per_page"),[l]=de(5,Fo),[n]=de("*","query"),[m,d]=xt("RAW_JSON_LIVE_VIEW"),{logs:u,isPaused:p,error:h,startLiveTailing:g,stopLiveTailing:f,pauseLiveTailing:_,resumeLiveTailing:y,clearLogs:b,isLimitedLogsPerUpdate:v}=Sn(n,c),k=r.get(oe.DISPLAY_FIELDS)||it,w=F(()=>k.split(","),[k]),x=M(()=>{Oi(),y()},[y]),q=M(T=>{a({rows_per_page:T})},[a]),N=M(T=>{a({[Fo]:T})},[a]);return A(()=>(g(),()=>f()),[g,f,l]),A(()=>{if(!o.current)return;let C=[];const L=()=>{const{scrollTop:E,scrollHeight:z,clientHeight:U}=document.documentElement,Y=Math.abs(z-E-U)<An;s(Y),C.push(E),C=C.slice(-3);const W=dc(C);!Y&&!p&&W&&_()};return document.addEventListener("scroll",L),()=>document.removeEventListener("scroll",L)},[p,_,y]),A(()=>{i&&!p&&Oi()},[u,i]),A(()=>{x()},[c,l]),h?e("div",{className:"vm-live-tailing-view__error",children:h}):e(V,{children:[e(Cn,{settingsRef:t,rowsPerPage:c,handleSetRowsPerPage:q,logs:u,isPaused:p,handleResumeLiveTailing:x,pauseLiveTailing:_,clearLogs:b,isRawJsonView:m,onRawJsonViewChange:d,offset:l,handleSetOffset:N}),e(er,{}),e("div",{ref:o,className:"vm-live-tailing-view__container",children:u.length===0?e("div",{className:"vm-live-tailing-view__empty",children:"Waiting for logs..."}):e("div",{className:"vm-live-tailing-view__logs",children:u.map(({_log_id:T,...C},L)=>m?e("pre",{className:"vm-live-tailing-view__log-row",onMouseDown:_,children:JSON.stringify(C)},L):e(Ut,{log:C,onItemClick:_,hideGroupButton:!0,displayFields:w},T))})}),v&&e(fe,{variant:"warning",children:"Too many logs per second detected. Large volumes of log data are difficult to process and may impact performance. We recommend adding filters to your query for better analysis and system performance."})]})},Ri=globalThis.showSaveFilePicker;async function Fn(t={}){if(Ri&&!t._preferPolyfill)return Ri(t);t._name&&(console.warn("`_name` is deprecated; use `suggestedName` instead."),t.suggestedName=t._name);const o=await fi(()=>import("./FileSystemFileHandle-R744i65p.js"),__vite__mapDeps([0,1]),import.meta.url),{FileSystemFileHandle:i}=o,s=await fi(()=>import("./downloader-B69BFsAs.js"),__vite__mapDeps([2,1]),import.meta.url),{FileHandle:r}=s;return new i(new r(t.suggestedName))}const En=()=>{const{isLoading:t,error:o,fetchLogs:i}=Xe(),[s,r]=S(null),[a,c]=S(!1),l=t||a,n=o||s,m=M(async({filename:d,queryParams:u})=>{r(null);const{query:p,start:h,end:g}=u||{},f=["query","start","end"].filter(_=>!{query:p,start:h,end:g}[_]);if(f.length)return r(`Download failed: missing required params: ${f.join(", ")}`),!1;c(!0);try{const _={start:O(h).unix(),end:O(g).unix(),date:Bo(O(g).toDate())},y=await i({query:p,period:_,isDownload:!0});if(!y||Array.isArray(y)||!y.body)return r("Download failed: missing response body."),!1;const v=await(await Fn({suggestedName:d})).createWritable();return await y.body.pipeTo(v,{preventCancel:!0}),!0}catch(_){return _ instanceof Error&&_.name!=="AbortError"&&(r(String(_)),console.error(_)),!1}finally{c(!1)}},[i]);return{error:n,isLoading:l,downloadLogs:m}},Di="jsonl",tr=({children:t,queryParams:o})=>{const{value:i,setTrue:s,setFalse:r}=ee(),{downloadLogs:a,error:c,isLoading:l}=En(),[n,m]=S("vmui_logs_export"),d=F(()=>{if(!o)return"";const{start:h,end:g}=o,f=h?O(h).format(Ae):"",_=g?O(g).format(Ae):"",y=O(h).format("Z");return`${f} - ${_} (${y})`},[o?.start,o?.end]),u=F(()=>{if(!o)return"";const{AccountID:h,ProjectID:g}=o;return`${h}:${g}`},[o?.AccountID,o?.ProjectID]),p=M(async()=>{const g=`${n.trim()||"vmui_logs_export"}.${Di}`;await a({filename:g,queryParams:o})},[n,o,a]);return e(V,{children:[e("div",{onClick:s,children:t}),i&&e(ke,{title:"Download logs",onClose:r,children:e("div",{className:"vm-download-logs",children:[e("div",{className:"vm-download-logs-section",children:[e("h3",{className:"vm-download-logs-section__title",children:"File name"}),e("div",{className:"vm-download-logs-filename",children:e(Te,{autofocus:!0,value:n,endIcon:e("span",{className:"vm-download-logs-filename__extension",children:[".",Di]}),onChange:m})}),e("div",{className:"vm-download-logs__description",children:["This will download all logs for ",d," using your current query for tenant ",u,"."]})]}),c&&e(fe,{variant:"error",children:c}),e("div",{className:"vm-download-logs-footer",children:[e(R,{color:"error",variant:"outlined",onClick:r,children:"Cancel"}),e(R,{color:"primary",variant:"contained",onClick:p,disabled:l,startIcon:l?e(eo,{}):e(si,{}),children:"Download"})]})]})})]})},zi=[{label:"Group",value:"group",icon:e(Fs,{}),Component:nn},{label:"Table",value:"table",icon:e(As,{}),Component:vn},{label:"JSON",value:"json",icon:e(oi,{}),Component:wn},{label:"Live",value:"liveTailing",icon:e(ei,{}),Component:Ln}],or=({data:t,queryParams:o,isLoading:i,isPreview:s})=>{const{isMobile:r}=G(),{setSearchParamsFromKeys:a}=Lt(),[c,l]=de("group","view"),n=D(null),[m,d]=te(),[u,p]=de(!1,"hide_logs"),h=()=>{p(_=>{const y=!_;return y?m.set("hide_logs","true"):m.delete("hide_logs"),d(m),y})},g=_=>{l(_),a({view:_})},f=zi.find(_=>_.value===c)?.Component;return e("div",{className:I({"vm-query-page-body":!0,"vm-block":!s,"vm-block_mobile":!s&&r}),children:[i&&e(dt,{}),e("div",{className:I({"vm-query-page-body-header":!0,"vm-section-header":!0,"vm-query-page-body-header_mobile":r}),children:[e("div",{className:I({"vm-section-header__tabs":!0,"vm-query-page-body-header__tabs_mobile":r}),children:e(ni,{activeItem:String(c),items:zi,onChange:g})}),e("div",{className:I({"vm-query-page-body-header__settings":!0,"vm-query-page-body-header__settings_mobile":r}),children:[e("div",{ref:n}),e(tr,{queryParams:o,children:e(Q,{title:"Download Logs",children:e(R,{variant:"text",startIcon:e(si,{}),ariaLabel:"Download Logs"})})}),e(Q,{title:u?"Show Logs":"Hide Logs",children:e(R,{variant:"text",color:"primary",startIcon:u?e(Zt,{}):e(rt,{}),onClick:h,ariaLabel:"settings"})})]})]}),e("div",{className:I({"vm-query-page-body__table":!0,"vm-query-page-body__table_hide":u,"vm-query-page-body__table_mobile":r}),children:[u&&e(fe,{variant:"info",children:"Logs are hidden. Updates paused."}),!u&&f&&e(f,{data:t,settingsRef:n})]})]})},In=t=>{if(t.includes("=")){const[o,i]=t.split("=");if(i)return`_stream:${o}=~${i}.*"}`}return"*"},Hi=(t,o)=>{const i=t.lastIndexOf(o);return i!==-1?t.slice(0,i):""},Mn=t=>{let o="";return t.valueContext.includes(":")?o=Hi(t.valueContext,":"):t.valueContext.includes("-")&&(o=Hi(t.valueContext,"-")),o?`${t.filterName}:${o}`:"*"},Pn=t=>{let o=`${t.filterName}:${t.valueContext}*`;return!t.filterName||!t.query||["_msg","_stream_id"].includes(t.filterName)?o="*":t.filterName==="_stream"?o=In(t.valueContext):t.filterName==="_time"&&(o=Mn(t)),t.queryBeforeIncompleteFilter?`${t.queryBeforeIncompleteFilter}${t.separator??" "}${o}`:o},On=({value:t,selectionStart:o=0,selectionEnd:i=0})=>{const s=t.indexOf(`
`,i),a=t.lastIndexOf(`
`,Math.max(0,o-1))+1,c=s===-1?t.length:s,l=t.slice(a,c),n=l.split(`
`),d=n.length>0&&n.every(y=>/^\s*#/.test(y))?n.map(y=>y.replace(/^(\s*)#\s?/,"$1")):n.map(y=>y.replace(/^(\s*)/,"$1# ")),u=d.join(`
`),p=t.slice(0,a)+u+t.slice(c),h=d[0].length-n[0].length,g=o+h,f=u.length-l.length,_=o===i?g:i+f;return{value:p,selectionStart:g,selectionEnd:_}},He=Ho()?"":"Ctrl",mt=Ho()?"":"Alt",Rn=({value:t,onChange:o,onEnter:i,onArrowUp:s,onArrowDown:r,autocomplete:a,autocompleteEl:c,error:l,stats:n,label:m,disabled:d=!1,includeFunctions:u=!0})=>{const{autocompleteQuick:p}=Nt(),{isMobile:h}=G(),[g,f]=S(!1),[_,y]=S([0,0]),[b,v]=S([0,0]),k=D(null),[w,x]=S(!1),q=D(as(x,500)).current;n?.executionTimeMsec!==void 0&&(m=`${m} (${n.executionTimeMsec||0}ms)`);const N=(E,z)=>{o(E),v([z,z])},T=E=>{const{key:z,ctrlKey:U,metaKey:Y,shiftKey:W}=E,K=E.target,H=K.value||"",P=H.split(`
`).length>1,B=U||Y,$=z==="ArrowUp",j=z==="ArrowDown",X=z==="Enter",le=z==="/";if($&&B&&(E.preventDefault(),s()),j&&B&&(E.preventDefault(),r()),X&&g&&E.preventDefault(),X&&!W&&(!P||B)&&!g&&(E.preventDefault(),i()),B&&le){E.preventDefault();const{selectionStart:re,selectionEnd:ne}=K,{value:Ee,selectionStart:De,selectionEnd:qe}=On({value:H,selectionStart:re,selectionEnd:ne});o(Ee),v([De,qe])}},C=E=>{f(!!E.length)},L=E=>{y(z=>z[0]===E[0]&&z[1]===E[1]?z:E)};return A(()=>{f(!!c&&p)},[p]),A(()=>{x(!1),q(_.every(Boolean))},[_]),e("div",{className:"vm-query-editor",ref:k,children:[e(Te,{value:t,label:m,type:"textarea",autofocus:!h,error:l,onKeyDown:T,onChange:o,onChangeCaret:L,disabled:d,inputmode:"search",caretPosition:b,endIcon:e(Q,{title:e("div",{className:"vm-query-editor-help-tooltip",children:[e("p",{className:"vm-query-editor-help-tooltip-item",children:[e("span",{children:"Shift + Enter"})," ",e("span",{children:"insert a new line"})]}),e("p",{className:"vm-query-editor-help-tooltip-item",children:[e("span",{children:"Ctrl + Enter"})," ",e("span",{children:"execute query"})]}),e("p",{className:"vm-query-editor-help-tooltip-item",children:[e("span",{children:[He," + /"]})," ",e("span",{children:"toggle line comment"})]})]}),children:e(Jt,{})})}),a&&c&&e(c,{value:t,anchorEl:k,caretPosition:_,hasHelperText:!!l,includeFunctions:u,onSelect:N,onFoundOptions:C,isOpen:w})]})},ir=({limit:t,onChangeLimit:o,onPressEnter:i,onError:s})=>{const[r,a]=S(""),[c,l]=S(t),n=d=>isNaN(d)||d<=0?(a("Number must be > 0"),{isValid:!1,errorMsg:"Number must be > 0"}):d>gt?{isValid:!1,errorMsg:`Max limit is ${gt.toLocaleString("en-US")}`}:{isValid:!0,errorMsg:""},m=M(d=>{const u=+d;l(u);const{isValid:p,errorMsg:h}=n(u);p?(a(""),o(u)):a(h)},[o]);return A(()=>{s&&s(!!r)},[r]),A(()=>{const{isValid:d,errorMsg:u}=n(t);a(d?"":u),l(t)},[t]),e(Te,{label:"Log limits",type:"number",value:c,error:r,onChange:m,onEnter:i})};var Se=(t=>(t.Filter="Filter",t.Pipe="Pipe",t.Operator="Operator",t.LineBreak="LineBreak",t.FilterOrPipe="FilterOrPipe",t))(Se||{}),J=(t=>(t.FilterName="FilterName",t.FilterUnknown="FilterUnknown",t.FilterValue="FilterValue",t.PipeName="Pipes",t.PipeValue="PipeValue",t.Unknown="Unknown",t.FilterOrPipeName="FilterOrPipeName",t))(J||{});const Dn=[{id:"block_stats-pipe",value:"block_stats",title:"block_stats pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#block_stats-pipe target="_blank" rel="noreferrer">block_stats pipe</a></h5><p><code>&lt;q&gt; | block_stats</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> returns the following stats for each field in every data block
processed by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>:</p>
<ul>
<li><code>field</code> - <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">field</a> name</li>
<li><code>rows</code> - the number of rows in the data block</li>
<li><code>type</code> - internal storage type for the given <code>field</code></li>
<li><code>dict_items</code> - the number of unique values in the dictionary for the given <code>field</code></li>
<li><code>dict_bytes</code> - on-disk size of the dictionary data for the given <code>field</code></li>
<li><code>values_bytes</code> - on-disk size of the data for the given <code>field</code></li>
<li><code>bloom_bytes</code> - on-disk size of bloom filter data for the given <code>field</code></li>
<li><code>_stream</code> - the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#stream-fields">log stream</a> for the given <code>field</code></li>
<li><code>part_path</code> - the path to the data part where the field data is stored</li>
</ul>
<p>The <code>block_stats</code> pipe is needed mostly for debugging purposes.
See, for example, <a href="https://docs.victoriametrics.com/victorialogs/faq/#how-to-determine-which-log-fields-occupy-the-most-of-disk-space">how to detect which log field occupies the most of the disk space</a>,
or <a href="https://docs.victoriametrics.com/victorialogs/faq/#how-to-determine-which-log-streams-occupy-the-most-of-disk-space">how to detect which log stream occupies the most of the disk space</a>.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#query_stats-pipe"><code>query_stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#value_type-filter"><code>value_type</code> filter</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#blocks_count-pipe"><code>blocks_count</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#len-pipe"><code>len</code> pipe</a></li>
</ul>
</div>`},{id:"blocks_count-pipe",value:"blocks_count",title:"blocks_count pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#blocks_count-pipe target="_blank" rel="noreferrer">blocks_count pipe</a></h5><p><code>&lt;q&gt; | blocks_count</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> counts the number of blocks with logs processed by <code>&lt;q&gt;</code>. This pipe is needed mostly for debugging.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#query_stats-pipe"><code>query_stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#block_stats-pipe"><code>block_stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#len-pipe"><code>len</code> pipe</a></li>
</ul>
</div>`},{id:"collapse_nums-pipe",value:"collapse_nums",title:"collapse_nums pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#collapse_nums-pipe target="_blank" rel="noreferrer">collapse_nums pipe</a></h5><p><code>&lt;q&gt; | collapse_nums at &lt;field&gt;</code> pipe replaces all the decimal and hexadecimal numbers at the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>&lt;field&gt;</code></a>
returned by the <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> with <code>&lt;N&gt;</code> placeholder.
For example, if the <code>_msg</code> field contains <code>2024-10-20T12:34:56Z request duration 1.34s</code>, then it is replaced with <code>&lt;N&gt;-&lt;N&gt;-&lt;N&gt;T&lt;N&gt;:&lt;N&gt;:&lt;N&gt;Z request duration &lt;N&gt;.&lt;N&gt;s</code> by the following query:</p>
<pre><code class="language-logsql">_time:5m | collapse_nums at _msg
</code></pre>
<p>The <code>at ...</code> suffix can be omitted if <code>collapse_nums</code> is applied to <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code></a> field.
The following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | collapse_nums
</code></pre>
<p>This functionality is useful for locating the most frequently seen log patterns across log messages with various decimal and hexadecimal numbers.
This includes the following entities: timestamps, IPv4 addresses, request durations, response sizes, <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier">UUIDs</a>, trace IDs, user IDs, etc.
Log messages with such entities become identical after applying <code>collapse_nums</code> pipe to them, so the <a href="https://docs.victoriametrics.com/victorialogs/logsql/#top-pipe"><code>top</code> pipe</a> can be applied to them in order to get the most frequently
seen patterns across log messages. For example, the following query returns top 5 the most frequently seen log patterns across log messages for the last hour:</p>
<pre><code class="language-logsql">_time:1h | collapse_nums | top 5 by (_msg)
</code></pre>
<p><code>collapse_nums</code> can detect certain patterns in the collapsed numbers and replace them with the corresponding placeholders if <code>prettify</code> suffix is added to the <code>collapse_nums</code> pipe:</p>
<ul>
<li><code>&lt;N&gt;-&lt;N&gt;-&lt;N&gt;-&lt;N&gt;-&lt;N&gt;</code> is replaced with <code>&lt;UUID&gt;</code> placeholder.</li>
<li><code>&lt;N&gt;.&lt;N&gt;.&lt;N&gt;.&lt;N&gt;</code> is replaced with <code>&lt;IP4&gt;</code> placeholder.</li>
<li><code>&lt;N&gt;:&lt;N&gt;:&lt;N&gt;</code> is replaced with <code>&lt;TIME&gt;</code> placeholder. Optional fractional seconds after the time are treated as a part of <code>&lt;TIME&gt;</code>.</li>
<li><code>&lt;N&gt;-&lt;N&gt;-&lt;N&gt;</code> and <code>&lt;N&gt;/&lt;N&gt;/&lt;N&gt;</code> is replaced with <code>&lt;DATE&gt;</code> placeholder.</li>
<li><code>&lt;N&gt;-&lt;N&gt;-&lt;N&gt;T&lt;N&gt;:&lt;N&gt;:&lt;N&gt;</code> and <code>&lt;N&gt;-&lt;N&gt;-&lt;N&gt; &lt;N&gt;:&lt;N&gt;:&lt;N&gt;</code> is replaced with <code>&lt;DATETIME&gt;</code> placeholder. Optional timezone after the datetime is treated as a part of <code>&lt;DATETIME&gt;</code>.</li>
</ul>
<p>For example, the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field">log message</a>
<code>2edfed59-3e98-4073-bbb2-28d321ca71a7 - [2024/12/08 15:21:02] 10.71.20.32 GET /foo 200</code> is replaced with <code>&lt;UUID&gt; - [&lt;DATETIME&gt;] &lt;IP4&gt; GET /foo &lt;N&gt;</code>
when the following query is executed:</p>
<pre><code class="language-logsql">_time:1h | collapse_nums prettify
</code></pre>
<p>The patterns returned by <code>collapse_nums prettify</code> pipe can be used in <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pattern-match-filter">pattern match filter</a>.</p>
<p><code>collapse_nums</code> can miss some numbers or can collapse unexpected numbers. In this case <a href="https://docs.victoriametrics.com/victorialogs/logsql/#conditional-collapse_nums">conditional <code>collapse_nums</code></a> can be used
for skipping such values and pre-processing them separately with <a href="https://docs.victoriametrics.com/victorialogs/logsql/#replace_regexp-pipe"><code>replace_regexp</code></a>.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#conditional-collapse_nums">conditional <code>collapse_nums</code></a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#pattern-match-filter">pattern match filter</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#replace-pipe"><code>replace</code></a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#replace_regexp-pipe"><code>replace_regexp</code></a></li>
</ul>
</div>`},{id:"copy-pipe",value:"copy",title:"copy pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#copy-pipe target="_blank" rel="noreferrer">copy pipe</a></h5><p>If some <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> must be copied, then <code>| copy src1 as dst1, ..., srcN as dstN</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> can be used.
For example, the following query copies <code>host</code> field to <code>server</code> for logs over the last 5 minutes, so the output contains both <code>host</code> and <code>server</code> fields:</p>
<pre><code class="language-logsql">_time:5m | copy host as server
</code></pre>
<p>Multiple fields can be copied with a single <code>| copy ...</code> pipe. For example, the following query copies
<a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#time-field"><code>_time</code> field</a> to <code>timestamp</code>, while <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>
is copied to <code>message</code>:</p>
<pre><code class="language-logsql">_time:5m | copy _time as timestamp, _msg as message
</code></pre>
<p>The <code>as</code> keyword is optional.</p>
<p><code>cp</code> keyword can be used instead of <code>copy</code> for convenience. For example, <code>_time:5m | cp foo bar</code> is equivalent to <code>_time:5m | copy foo as bar</code>.</p>
<p>It is possible to copy multiple fields with identical prefix to fields with another prefix. For example, the following query copies
all the fields with the prefix <code>foo</code> to fields with the prefix <code>bar</code>:</p>
<pre><code class="language-logsql">_time:5m | copy foo* as bar*
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#rename-pipe"><code>rename</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#fields-pipe"><code>fields</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#delete-pipe"><code>delete</code> pipe</a></li>
</ul>
</div>`},{id:"decolorize-pipe",value:"decolorize",title:"decolorize pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#decolorize-pipe target="_blank" rel="noreferrer">decolorize pipe</a></h5><p><code>&lt;q&gt; | decolorize &lt;field&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> drops <a href="https://en.wikipedia.org/wiki/ANSI_escape_code">ANSI color codes</a>
from the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>&lt;field&gt;</code></a> across all the logs returned by <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax"><code>&lt;q&gt;</code> query</a>.</p>
<p>The <code>&lt;field&gt;</code> may be omitted if ANSI color codes must be dropped from the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>.
For example, the following query drops ANSI color codes from all the <code>_msg</code> fields over the logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | decolorize
</code></pre>
<p>This query is equivalent to the following query:</p>
<pre><code class="language-logsql">_time:5m | decolorize _msg
</code></pre>
<p>It is recommended to drop ANSI color codes at the data ingestion stage according to <a href="https://docs.victoriametrics.com/victorialogs/data-ingestion/#decolorizing">these docs</a>.
This simplifies further querying of the logs without the need to apply <code>| decolorize</code> pipe to them.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#replace-pipe"><code>replace</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#replace_regexp-pipe"><code>replace_regexp</code> pipe</a></li>
</ul>
</div>`},{id:"delete-pipe",value:"delete",title:"delete pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#delete-pipe target="_blank" rel="noreferrer">delete pipe</a></h5><p>If some <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> must be deleted, then <code>| delete field1, ..., fieldN</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> can be used.
For example, the following query deletes <code>host</code> and <code>app</code> fields from the logs over the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | delete host, app
</code></pre>
<p><code>drop</code>, <code>del</code> and <code>rm</code> keywords can be used instead of <code>delete</code> for convenience. For example, <code>_time:5m | drop host</code> is equivalent to <code>_time:5m | delete host</code>.</p>
<p>It is possible to delete fields with common prefix. For example, the following query deletes all the fields with <code>foo</code> prefix:</p>
<pre><code class="language-logsql">_time:5m | delete foo*
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#rename-pipe"><code>rename</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#fields-pipe"><code>fields</code> pipe</a></li>
</ul>
</div>`},{id:"drop_empty_fields-pipe",value:"drop_empty_fields",title:"drop_empty_fields pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#drop_empty_fields-pipe target="_blank" rel="noreferrer">drop_empty_fields pipe</a></h5><p><code>&lt;q&gt; | drop_empty_fields</code> pipe drops <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">fields</a> with empty values from results returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>.
It also skips log entries with zero non-empty fields.</p>
<p>For example, the following query drops possible empty <code>email</code> field generated by <a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a> if the <code>foo</code> field doesn&#39;t contain email:</p>
<pre><code class="language-logsql">_time:5m | extract &#39;email: &lt;email&gt;,&#39; from foo | drop_empty_fields
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#filter-pipe"><code>filter</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a></li>
</ul>
</div>`},{id:"extract_regexp-pipe",value:"extract_regexp",title:"extract_regexp pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#extract_regexp-pipe target="_blank" rel="noreferrer">extract_regexp pipe</a></h5><p><code>&lt;q&gt; | extract_regexp &quot;pattern&quot; from field_name</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> extracts substrings from the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>field_name</code> field</a>
returned from <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> according to the provided <code>pattern</code>, and stores them into field names according to the named fields inside the <code>pattern</code>.
The <code>pattern</code> must contain <a href="https://github.com/google/re2/wiki/Syntax">RE2 regular expression</a> with named fields (aka capturing groups) in the form <code>(?P&lt;capture_field_name&gt;...)</code>.
Matching substrings are stored to the given <code>capture_field_name</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.
For example, the following query extracts substrings that look like IPv4 addresses from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>
and puts it into <code>ip</code> field for logs over the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | extract_regexp &quot;(?P&lt;ip&gt;([0-9]+[.]){3}[0-9]+)&quot; from _msg
</code></pre>
<p>The <code>from _msg</code> part can be omitted if the data extraction is performed from the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>.
So the following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | extract_regexp &quot;(?P&lt;ip&gt;([0-9]+[.]){3}[0-9]+)&quot;
</code></pre>
<p>Add <code>keep_original_fields</code> to the end of <code>extract_regexp ...</code> when the original non-empty values of the fields mentioned in the pattern must be preserved
instead of overwriting it with the extracted values. For example, the following query extracts <code>&lt;ip&gt;</code> only if the original value for <code>ip</code> field is missing or is empty:</p>
<pre><code class="language-logsql">_time:5m | extract_regexp &#39;ip=(?P&lt;ip&gt;([0-9]+[.]){3}[0-9]+)&#39; keep_original_fields
</code></pre>
<p>By default <code>extract_regexp</code> writes empty matching fields to the output, which may overwrite existing values. Add <code>skip_empty_results</code> to the end of <code>extract_regexp ...</code>
in order to prevent overwriting the existing values for the corresponding fields with empty values.
For example, the following query preserves the original <code>ip</code> field value if the <code>foo</code> field doesn&#39;t contain the matching IP:</p>
<pre><code class="language-logsql">_time:5m | extract_regexp &#39;ip=(?P&lt;ip&gt;([0-9]+[.]){3}[0-9]+)&#39; from foo skip_empty_results
</code></pre>
<p>Performance tip: it is recommended using <a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a> instead of <code>extract_regexp</code> for achieving higher query performance.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#conditional-extract_regexp">Conditional <code>extract_regexp</code></a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#replace_regexp-pipe"><code>replace_regexp</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_json-pipe"><code>unpack_json</code> pipe</a></li>
</ul>
</div>`},{id:"extract-pipe",value:"extract",title:"extract pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe target="_blank" rel="noreferrer">extract pipe</a></h5><p><code>&lt;q&gt; | extract &quot;pattern&quot; from field_name</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> extracts text into output fields according to the <a href="https://docs.victoriametrics.com/victorialogs/logsql/#format-for-extract-pipe-pattern"><code>pattern</code></a> from the given
<a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>field_name</code></a> returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>.
Existing log fields remain unchanged after the <code>| extract ...</code> pipe.</p>
<p><code>extract</code> pipe can be useful for extracting additional fields needed for further data processing with other pipes such as <a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe"><code>stats</code> pipe</a> or <a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a>.</p>
<p>For example, the following query selects logs with the <code>error</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#word">word</a> for the last day,
extracts IP address from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a> into <code>ip</code> field and then calculates top 10 IP addresses
with the biggest number of logs using <a href="https://docs.victoriametrics.com/victorialogs/logsql/#top-pipe"><code>top</code> pipe</a>:</p>
<pre><code class="language-logsql">_time:1d error | extract &quot;ip=&lt;ip&gt; &quot; from _msg | top 10 (ip)
</code></pre>
<p>It is expected that <code>_msg</code> field contains <code>ip=...</code> substring ending with space. For example, <code>error ip=1.2.3.4 from user_id=42</code>.
If there is no such substring in the current <code>_msg</code> field, then the <code>ip</code> output field will be empty.</p>
<p>If the <code>extract</code> pipe is applied to <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>, then the <code>from _msg</code> part can be omitted.
For example, the following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:1d error | extract &quot;ip=&lt;ip&gt; &quot; | top 10 (ip)
</code></pre>
<p>If the <code>pattern</code> contains double quotes, then either put <code>\\</code> in front of double quotes or put the <code>pattern</code> inside single quotes.
For example, the following query extracts <code>ip</code> from the corresponding JSON field:</p>
<pre><code class="language-logsql">_time:5m | extract &#39;&quot;ip&quot;:&quot;&lt;ip&gt;&quot;&#39;
</code></pre>
<p>Add <code>keep_original_fields</code> to the end of <code>extract ...</code> when the original non-empty values of the fields mentioned in the pattern must be preserved
instead of overwriting them with the extracted values. For example, the following query extracts <code>&lt;ip&gt;</code> only if the original value for <code>ip</code> field is missing or is empty:</p>
<pre><code class="language-logsql">_time:5m | extract &#39;ip=&lt;ip&gt; &#39; keep_original_fields
</code></pre>
<p>By default <code>extract</code> writes empty matching fields to the output, which may overwrite existing values. Add <code>skip_empty_results</code> to the end of <code>extract ...</code>
in order to prevent overwriting the existing values for the corresponding fields with empty values.
For example, the following query preserves the original <code>ip</code> field value if the <code>foo</code> field doesn&#39;t contain the matching IP:</p>
<pre><code class="language-logsql">_time:5m | extract &#39;ip=&lt;ip&gt; &#39; from foo skip_empty_results
</code></pre>
<p>Performance tip: it is recommended using more specific <a href="https://docs.victoriametrics.com/victorialogs/logsql/#filters">log filters</a> in order to reduce the number of log entries, which are passed to <code>extract</code>.
See <a href="https://docs.victoriametrics.com/victorialogs/logsql/#performance-tips">general performance tips</a> for details.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#format-for-extract-pipe-pattern">Format for extract pipe pattern</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#conditional-extract">Conditional extract</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract_regexp-pipe"><code>extract_regexp</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_json-pipe"><code>unpack_json</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_logfmt-pipe"><code>unpack_logfmt</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#split-pipe"><code>split</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#math-pipe"><code>math</code> pipe</a></li>
</ul>
</div>`},{id:"facets-pipe",value:"facets",title:"facets pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#facets-pipe target="_blank" rel="noreferrer">facets pipe</a></h5><p><code>&lt;q&gt; | facets</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> returns the most frequent non-empty values for every seen <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field</a>
returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>. It also returns an estimated number of hits for every returned <code>field=value</code> pair.</p>
<p>For example, the following query returns the most frequent values for every seen log field across logs with the <code>error</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#word">word</a> over the last hour:</p>
<pre><code class="language-logsql">_time:1h error | facets
</code></pre>
<p>It is possible to specify the number of most frequently seen values to return for each log field by using the <code>facets N</code> syntax. For example,
the following query returns up to 3 most frequently seen values for each field across logs with the <code>error</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#word">word</a> over the last hour:</p>
<pre><code class="language-logsql">_time:1h error | facets 3
</code></pre>
<p>By default <code>facets</code> pipe doesn&#39;t return log fields with too many unique values, since this may require a lot of additional memory to track.
The limit can be changed during the query via <code>max_values_per_field M</code> suffix. For example, the following query returns up to 15 most frequently seen
field values across fields with up to 100000 unique values:</p>
<pre><code class="language-logsql">_time:1h error | facets 15 max_values_per_field 100000
</code></pre>
<p>By default <code>facets</code> pipe doesn&#39;t return log fields with too long values. The limit can be changed during query via <code>max_value_len K</code> suffix.
For example, the following query returns the most frequent values for all the log fields containing values no longer than 100 bytes:</p>
<pre><code class="language-logsql">_time:1h error | facets max_value_len 100
</code></pre>
<p>By default <code>facets</code> pipe doesn&#39;t return log fields, which contain a single constant value across all the selected logs, since such facets aren&#39;t interesting in most cases.
Add <code>keep_const_fields</code> suffix to the <code>facets</code> pipe in order to get such fields:</p>
<pre><code class="language-logsql">_time:1h error | facets keep_const_fields
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#top-pipe"><code>top</code></a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#field_names-pipe"><code>field_names</code></a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#field_values-pipe"><code>field_values</code></a></li>
</ul>
</div>`},{id:"field_names-pipe",value:"field_names",title:"field_names pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#field_names-pipe target="_blank" rel="noreferrer">field_names pipe</a></h5><p><code>&lt;q&gt; | field_names</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> returns all the names of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>
with an estimated number of logs for each field name returned from <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>.</p>
<p>For example, the following query returns all the field names with the number of matching logs over the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | field_names
</code></pre>
<p>Field names are returned in arbitrary order. Use <a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a> in order to sort them if needed.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#field_values-pipe"><code>field_values</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#facets-pipe"><code>facets</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#uniq-pipe"><code>uniq</code> pipe</a></li>
</ul>
</div>`},{id:"field_values-pipe",value:"field_values",title:"field_values pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#field_values-pipe target="_blank" rel="noreferrer">field_values pipe</a></h5><p><code>&lt;q&gt; | field_values field_name</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> returns all the values for the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>field_name</code> field</a>
with the number of logs for each value returned from <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>.
For example, the following query returns all the values with the number of matching logs for the field <code>level</code> over logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | field_values level
</code></pre>
<p>It is possible to limit the number of returned values by adding <code>limit N</code> to the end of <code>field_values ...</code>. For example, the following query returns
up to 10 values for the field <code>user_id</code> over logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | field_values user_id limit 10
</code></pre>
<p>If the limit is reached, then the set of returned values is arbitrary. In this case hits for the returned values are set to 0, since they may be misleading if not all the values are returned.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#field_names-pipe"><code>field_names</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#facets-pipe"><code>facets</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#top-pipe"><code>top</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#uniq-pipe"><code>uniq</code> pipe</a></li>
</ul>
</div>`},{id:"fields-pipe",value:"fields",title:"fields pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#fields-pipe target="_blank" rel="noreferrer">fields pipe</a></h5><p>By default all the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> are returned in the response.
It is possible to select the given set of log fields with <code>| fields field1, ..., fieldN</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a>. For example, the following query selects only <code>host</code>
and <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code></a> fields from logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | fields host, _msg
</code></pre>
<p><code>keep</code> can be used instead of <code>fields</code> for convenience. For example, the following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | keep host, _msg
</code></pre>
<p>It is possible to use wildcard prefixes in the list of fields to keep. For example, the following query keeps all the fields with names starting with <code>foo</code> prefix,
while drops the rest of the fields:</p>
<pre><code class="language-logsql">_time:5m | fields foo*
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#copy-pipe"><code>copy</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#rename-pipe"><code>rename</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#delete-pipe"><code>delete</code> pipe</a></li>
</ul>
</div>`},{id:"filter-pipe",value:"filter",title:"filter pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#filter-pipe target="_blank" rel="noreferrer">filter pipe</a></h5><p>The <code>&lt;q&gt; | filter ...</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> filters logs returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> with the given <a href="https://docs.victoriametrics.com/victorialogs/logsql/#filters">filter</a>.</p>
<p>For example, the following query returns <code>host</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">field</a> values
if the number of log messages with the <code>error</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#word">word</a> for them over the last hour exceeds <code>1_000</code>:</p>
<pre><code class="language-logsql">_time:1h error | stats by (host) count() logs_count | filter logs_count:&gt; 1_000
</code></pre>
<p>It is allowed to use <code>where</code> prefix instead of <code>filter</code> prefix for convenience. For example, the following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:1h error | stats by (host) count() logs_count | where logs_count:&gt; 1_000
</code></pre>
<p>It is allowed to omit <code>filter</code> prefix if the used filters do not clash with <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe names</a>.
So the following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:1h error | stats by (host) count() logs_count | logs_count:&gt; 1_000
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe"><code>stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a></li>
</ul>
</div>`},{id:"first-pipe",value:"first",title:"first pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#first-pipe target="_blank" rel="noreferrer">first pipe</a></h5><p><code>&lt;q&gt; | first N by (fields)</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> returns the first <code>N</code> logs from <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> after sorting them
by the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>fields</code></a>.</p>
<p>The <code>first N</code> pipe is a shortcut for sorting and taking top <code>N</code> rows in a single step (equivalent to <code>sort ... | limit N</code>).
It always performs its own &quot;top N&quot; selection.</p>
<ul>
<li>If <code>first</code> is used with <code>by (...)</code> (or just <code>(...)</code>), then it returns the top <code>N</code> rows according to these sort keys.</li>
<li>If <code>first</code> is used without sort keys (no <code>by (...)</code> / no <code>(...)</code>), then it returns the top <code>N</code> rows after sorting by <strong>all the fields</strong> in the row.</li>
</ul>
<p>For example, the following query returns the first 10 logs with the smallest value of <code>request_duration</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">field</a>
over the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | first 10 by (request_duration)
</code></pre>
<p>It is possible to return up to <code>N</code> logs individually for each group of logs with the same set of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">fields</a>,
by enumerating the set of these fields in <code>partition by (...)</code>.
For example, the following query returns up to 3 logs with the smallest <code>request_duration</code> for each host over the last hour:</p>
<pre><code class="language-logsql">_time:1h | first 3 by (request_duration) partition by (host)
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#last-pipe"><code>last</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a></li>
</ul>
</div>`},{id:"format-pipe",value:"format",title:"format pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#format-pipe target="_blank" rel="noreferrer">format pipe</a></h5><p><code>&lt;q&gt; | format &quot;pattern&quot; as result_field</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> combines <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>
from <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> results according to the <code>pattern</code> and stores it into <code>result_field</code>.</p>
<p>For example, the following query stores <code>request from &lt;ip&gt;:&lt;port&gt;</code> text into <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>,
by substituting <code>&lt;ip&gt;</code> and <code>&lt;port&gt;</code> with the corresponding <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field</a> values:</p>
<pre><code class="language-logsql">_time:5m | format &quot;request from &lt;ip&gt;:&lt;port&gt;&quot; as _msg
</code></pre>
<p>If the result of the <code>format</code> pattern is stored into <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>,
then <code>as _msg</code> part can be omitted. The following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | format &quot;request from &lt;ip&gt;:&lt;port&gt;&quot;
</code></pre>
<p>String fields can be formatted with the following additional formatting rules:</p>
<ul>
<li><p>The number of seconds in the <a href="https://docs.victoriametrics.com/victorialogs/logsql/#duration-values">duration value</a> - add <code>duration_seconds:</code> in front of the corresponding field name.
The formatted number is fractional if the duration value contains non-zero milliseconds, microseconds or nanoseconds.</p>
</li>
<li><p>JSON-compatible quoted string - add <code>q:</code> in front of the corresponding field name.
For example, the following query generates properly encoded JSON object from <code>_msg</code> and <code>stacktrace</code>
<a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> and stores it into <code>my_json</code> output field:</p>
<pre><code class="language-logsql">_time:5m | format &#39;{&quot;_msg&quot;:&lt;q:_msg&gt;,&quot;stacktrace&quot;:&lt;q:stacktrace&gt;}&#39; as my_json
</code></pre>
</li>
<li><p>Uppercase and lowercase strings - add <code>uc:</code> or <code>lc:</code> in front of the corresponding field name.
For example, the following query stores uppercase value of <code>foo</code> field and lowercase value of <code>bar</code> field in the <code>result</code> field:</p>
<pre><code class="language-logsql">_time:5m | format &#39;uppercase foo: &lt;uc:foo&gt;, lowercase bar: &lt;lc:bar&gt;&#39; as result
</code></pre>
</li>
<li><p>URL encoding and decoding (<a href="https://url.spec.whatwg.org/#application/x-www-form-urlencoded">application/x-www-form-urlencoded</a>) - add <code>urlencode:</code> or <code>urldecode:</code>
in front of the corresponding field name (<code>urlencode:</code> replaces spaces with <code>+</code>). For example, the following query properly encodes <code>user</code> field in the url query arg:</p>
<pre><code class="language-logsql">_time:5m | format &#39;url: http://foo.com/?user=&lt;urlencode:user&gt;&#39;
</code></pre>
</li>
<li><p>Hex encoding and decoding - add <code>hexencode:</code> or <code>hexdecode:</code> in front of the corresponding field name.
For example, the following query hex-encodes <code>password</code> field:</p>
<pre><code class="language-logsql">_time:5m | format &#39;hex-encoded password: &lt;hexencode:password&gt;&#39;
</code></pre>
</li>
<li><p><a href="https://en.wikipedia.org/wiki/Base64">Base64 encoding</a> and decoding - add <code>base64encode:</code> or <code>base64decode:</code> in front of the corresponding
field name. For example, the following query base64-encodes <code>password</code> field:</p>
<pre><code class="language-logsql">_time:5m | format &#39;base64-encoded password: &lt;base64encode:password&gt;&#39;
</code></pre>
</li>
<li><p>Converting of hexadecimal number to decimal number - add <code>hexnumdecode:</code> in front of the corresponding field name. For example, <code>format &quot;num=&lt;hexnumdecode:some_hex_field&gt;&quot;</code>.</p>
</li>
</ul>
<p>Numeric fields can be transformed into the following string representation at <code>format</code> pipe:</p>
<ul>
<li><p><a href="https://www.rfc-editor.org/rfc/rfc3339">RFC3339 time</a> - by adding <code>time:</code> in front of the corresponding field name
containing <a href="https://en.wikipedia.org/wiki/Unix_time">Unix timestamp</a>.
The numeric timestamp can be in seconds, milliseconds, microseconds, or nanoseconds  the precision is automatically detected based on the value.
Both integer and floating-point values are supported.
For example, <code>format &quot;time=&lt;time:timestamp&gt;&quot;</code>.</p>
</li>
<li><p>Human-readable duration - by adding <code>duration:</code> in front of the corresponding numeric field name containing duration in nanoseconds.
For example, <code>format &quot;duration=&lt;duration:duration_nsecs&gt;&quot;</code>. The duration can be converted into nanoseconds with the <a href="https://docs.victoriametrics.com/victorialogs/logsql/#math-pipe"><code>math</code> pipe</a>.</p>
</li>
<li><p>IPv4 - by adding <code>ipv4:</code> in front of the corresponding field name containing <code>uint32</code> representation of the IPv4 address.
For example, <code>format &quot;ip=&lt;ipv4:ip_num&gt;&quot;</code>.</p>
</li>
<li><p>Zero-padded 64-bit hex number - by adding <code>hexnumencode:</code> in front of the corresponding field name. For example, <code>format &quot;hex_num=&lt;hexnumencode:some_field&gt;&quot;</code>.</p>
</li>
</ul>
<p>Add <code>keep_original_fields</code> to the end of <code>format ... as result_field</code> when the original non-empty value of the <code>result_field</code> must be preserved
instead of overwriting it with the <code>format</code> results. For example, the following query adds formatted result to <code>foo</code> field only if it was missing or empty:</p>
<pre><code class="language-logsql">_time:5m | format &#39;some_text&#39; as foo keep_original_fields
</code></pre>
<p>Add <code>skip_empty_results</code> to the end of <code>format ...</code> if empty results shouldn&#39;t be written to the output. For example, the following query writes formatted result to <code>foo</code> field
when at least <code>field1</code> or <code>field2</code> aren&#39;t empty, otherwise it preserves the original <code>foo</code> value:</p>
<pre><code class="language-logsql">_time:5m | format &quot;&lt;field1&gt;&lt;field2&gt;&quot; as foo skip_empty_results
</code></pre>
<p>Performance tip: it is recommended using more specific <a href="https://docs.victoriametrics.com/victorialogs/logsql/#filters">log filters</a> in order to reduce the number of log entries, which are passed to <code>format</code>.
See <a href="https://docs.victoriametrics.com/victorialogs/logsql/#performance-tips">general performance tips</a> for details.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#conditional-format">Conditional format</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#replace-pipe"><code>replace</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#replace_regexp-pipe"><code>replace_regexp</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a></li>
</ul>
</div>`},{id:"generate_sequence-pipe",value:"generate_sequence",title:"generate_sequence pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#generate_sequence-pipe target="_blank" rel="noreferrer">generate_sequence pipe</a></h5><p>The <code>&lt;q&gt; | generate_sequence &lt;N&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> skips all the <code>&lt;q&gt;</code> results and generates <code>&lt;N&gt;</code> output logs
with the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a> containing integer sequence starting from 0 and ending at <code>N-1</code>.</p>
<p>This pipe is useful for testing and debugging of the LogsQL pipes. For example, the following query generates 1000 random integers in the range <code>[0..9]</code>
and collects the statistics on the number of hits for each random number:</p>
<pre><code class="language-logsql">* | generate_sequence 1000
    | math round(rand()*10) as rand_num
    | stats by (rand_num) count() hits
    | sort by (rand_num)
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#math-pipe"><code>rand()</code> function from <code>math</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe"><code>stats</code> pipe</a></li>
</ul>
</div>`},{id:"hash-pipe",value:"hash",title:"hash pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#hash-pipe target="_blank" rel="noreferrer">hash pipe</a></h5><p><code>&lt;q&gt; | hash(field) as result_field</code> calculates an integer hash value for the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>field</code></a>
and stores it into the <code>result_field</code>, for every log entry returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>.</p>
<p>For example, the following query calculates the hash value over <code>user_id</code> field and stores it into <code>user_id_hash</code> field, across logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | hash(user_id) as user_id_hash
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#math-pipe"><code>math</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#filter-pipe"><code>filter</code> pipe</a></li>
</ul>
</div>`},{id:"join-pipe",value:"join",title:"join pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#join-pipe target="_blank" rel="noreferrer">join pipe</a></h5><p>The <code>&lt;q1&gt; | join by (&lt;fields&gt;) (&lt;q2&gt;)</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> joins <code>&lt;q1&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> results with the <code>&lt;q2&gt;</code> results by the given set of comma-separated <code>&lt;fields&gt;</code>.
This pipe works in the following way:</p>
<ol>
<li>It executes the <code>&lt;q2&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> and remembers its results.</li>
<li>For each input row from <code>&lt;q1&gt;</code> it searches for matching rows in the <code>&lt;q2&gt;</code> results by the given <code>&lt;fields&gt;</code>.</li>
<li>If the <code>&lt;q2&gt;</code> results have no matching rows, then the input row is sent to the output as is.</li>
<li>If the <code>&lt;q2&gt;</code> results have matching rows, then for each matching row the input row is extended
with new fields seen at the matching row, and the result is sent to the output.</li>
</ol>
<p>This logic is similar to <code>LEFT JOIN</code> in SQL. For example, the following query returns the number of per-user logs across two applications  <code>app1</code> and <code>app2</code> (see
<a href="https://docs.victoriametrics.com/victorialogs/logsql/#stream-filter">stream filters</a> for details on the <code>{...}</code> filter):</p>
<pre><code class="language-logsql">_time:1d {app=&quot;app1&quot;} | stats by (user) count() app1_hits
  | join by (user) (
    _time:1d {app=&quot;app2&quot;} | stats by (user) count() app2_hits
  )
</code></pre>
<p>If you need results similar to <code>INNER JOIN</code> in SQL, then add <code>inner</code> suffix after the <code>join</code> pipe.
For example, the following query returns stats only for users, which exist in both applications <code>app1</code> and <code>app2</code>:</p>
<pre><code class="language-logsql">_time:1d {app=&quot;app1&quot;} | stats by (user) count() app1_hits
  | join by (user) (
    _time:1d {app=&quot;app2&quot;} | stats by (user) count() app2_hits
  ) inner
</code></pre>
<p>It is possible to add a prefix to all the field names returned by the <code>&lt;query&gt;</code> by specifying the needed prefix after the <code>&lt;query&gt;</code>.
For example, the following query adds <code>app2.</code> prefix to all <code>&lt;query&gt;</code> log fields:</p>
<pre><code class="language-logsql">_time:1d {app=&quot;app1&quot;} | stats by (user) count() app1_hits
  | join by (user) (
    _time:1d {app=&quot;app2&quot;} | stats by (user) count() app2_hits
  ) prefix &quot;app2.&quot;
</code></pre>
<p><strong>Performance tips</strong>:</p>
<ul>
<li>Make sure that the <code>&lt;query&gt;</code> in the <code>join</code> pipe returns relatively small number of results, since they are kept in RAM during execution of <code>join</code> pipe.</li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-with-additional-filters">Conditional <code>stats</code></a> is usually faster to execute.
They usually require less RAM than the equivalent <code>join</code> pipe.</li>
</ul>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#subquery-filter">subquery filter</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe"><code>stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-with-additional-filters">conditional <code>stats</code></a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#filter-pipe"><code>filter</code> pipe</a></li>
</ul>
</div>`},{id:"json_array_len-pipe",value:"json_array_len",title:"json_array_len pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#json_array_len-pipe target="_blank" rel="noreferrer">json_array_len pipe</a></h5><p><code>&lt;q&gt; | json_array_len(field) as result_field</code> calculates the length of JSON array at the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>field</code></a>
and stores it into the <code>result_field</code>, for every log entry returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>.</p>
<p>For example, the following query returns top 5 logs that contain <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field">log messages</a>
with the biggest number of <a href="https://docs.victoriametrics.com/victorialogs/logsql/#word">words</a> across all the logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | unpack_words _msg as words | json_array_len (words) as words_count | first 5 (words_count desc)
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#len-pipe"><code>len</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_words-pipe"><code>unpack_words</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#first-pipe"><code>first</code> pipe</a></li>
</ul>
</div>`},{id:"last-pipe",value:"last",title:"last pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#last-pipe target="_blank" rel="noreferrer">last pipe</a></h5><p><code>&lt;q&gt; | last N by (fields)</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> returns the last <code>N</code> logs from <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> after sorting them
by the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>fields</code></a>.</p>
<p>For example, the following query returns the last 10 logs with the biggest value of <code>request_duration</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">field</a>
over the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | last 10 by (request_duration)
</code></pre>
<p>It is possible to return up to <code>N</code> logs individually for each group of logs with the same set of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">fields</a>,
by enumerating the set of these fields in <code>partition by (...)</code>.
For example, the following query returns up to 3 logs with the biggest <code>request_duration</code> for each host over the last hour:</p>
<pre><code class="language-logsql">_time:1h | last 3 by (request_duration) partition by (host)
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#first-pipe"><code>first</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a></li>
</ul>
</div>`},{id:"len-pipe",value:"len",title:"len pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#len-pipe target="_blank" rel="noreferrer">len pipe</a></h5><p><code>&lt;q&gt; | len(field) as result</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> stores byte length of the given <code>field</code> value into the <code>result</code> field
across all the logs returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>.</p>
<p>For example, the following query shows top 5 log entries with the maximum byte length of <code>_msg</code> field across
logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | len(_msg) as msg_len | sort by (msg_len desc) | limit 5
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#json_array_len-pipe"><code>json_array_len</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#sum_len-stats"><code>sum_len</code> stats function</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#limit-pipe"><code>limit</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#block_stats-pipe"><code>block_stats</code> pipe</a></li>
</ul>
</div>`},{id:"limit-pipe",value:"limit",title:"limit pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#limit-pipe target="_blank" rel="noreferrer">limit pipe</a></h5><p>If only a subset of selected logs must be processed, then <code>| limit N</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> can be used, where <code>N</code> can contain any <a href="https://docs.victoriametrics.com/victorialogs/logsql/#numeric-values">supported integer numeric value</a>.
For example, the following query returns up to 100 logs over the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | limit 100
</code></pre>
<p><code>head</code> keyword can be used instead of <code>limit</code> for convenience. For example, <code>_time:5m | head 100</code> is equivalent to <code>_time:5m | limit 100</code>.</p>
<p>The <code>N</code> in <code>limit N</code> / <code>head N</code> can be omitted - in this case up to 10 matching logs are returned:</p>
<pre><code class="language-logsql">error | head
</code></pre>
<p>By default rows are selected in arbitrary order for performance reasons, so the query above can return different sets of logs every time it is executed.
<a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a> can be used for making sure the logs are in the same order before applying <code>limit ...</code> to them.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#sample-pipe"><code>sample</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#offset-pipe"><code>offset</code> pipe</a></li>
</ul>
</div>`},{id:"math-pipe",value:"math",title:"math pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#math-pipe target="_blank" rel="noreferrer">math pipe</a></h5><p><code>&lt;q&gt; | math ...</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> performs mathematical calculations over <a href="https://docs.victoriametrics.com/victorialogs/logsql/#numeric-values">numeric values</a> of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>
returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>. It has the following format:</p>
<pre><code>| math
  expr1 as resultName1,
  ...
  exprN as resultNameN
</code></pre>
<p>Where <code>exprX</code> is one of the supported math expressions mentioned below, while <code>resultNameX</code> is the name of the field to store the calculated result to.
The <code>as</code> keyword is optional. The result name can be omitted. In this case the result is stored to a field with the name equal to string representation
of the corresponding math expression.</p>
<p><code>exprX</code> may reference <code>resultNameY</code> calculated before the given <code>exprX</code>.</p>
<p>For example, the following query divides <code>duration_msecs</code> field value by 1000, then rounds it to integer and stores the result in the <code>duration_secs</code> field:</p>
<pre><code class="language-logsql">_time:5m | math round(duration_msecs / 1000) as duration_secs
</code></pre>
<p>The following mathematical operations are supported by <code>math</code> pipe:</p>
<ul>
<li><code>arg1 + arg2</code> - returns the sum of <code>arg1</code> and <code>arg2</code></li>
<li><code>arg1 - arg2</code> - returns the difference between <code>arg1</code> and <code>arg2</code></li>
<li><code>arg1 * arg2</code> - multiplies <code>arg1</code> by <code>arg2</code></li>
<li><code>arg1 / arg2</code> - divides <code>arg1</code> by <code>arg2</code></li>
<li><code>arg1 % arg2</code> - returns the remainder of the division of <code>arg1</code> by <code>arg2</code></li>
<li><code>arg1 ^ arg2</code> - returns the power of <code>arg1</code> by <code>arg2</code></li>
<li><code>arg1 &amp; arg2</code> - returns bitwise <code>and</code> for <code>arg1</code> and <code>arg2</code>. It is expected that <code>arg1</code> and <code>arg2</code> are in the range <code>[0 .. 2^53-1]</code></li>
<li><code>arg1 or arg2</code> - returns bitwise <code>or</code> for <code>arg1</code> and <code>arg2</code>. It is expected that <code>arg1</code> and <code>arg2</code> are in the range <code>[0 .. 2^53-1]</code></li>
<li><code>arg1 xor arg2</code> - returns bitwise <code>xor</code> for <code>arg1</code> and <code>arg2</code>. It is expected that <code>arg1</code> and <code>arg2</code> are in the range <code>[0 .. 2^53-1]</code></li>
<li><code>arg1 default arg2</code> - returns <code>arg2</code> if <code>arg1</code> is non-<a href="https://docs.victoriametrics.com/victorialogs/logsql/#numeric-values">numeric</a> or equals <code>NaN</code></li>
<li><code>abs(arg)</code> - returns an absolute value for the given <code>arg</code></li>
<li><code>ceil(arg)</code> - returns the least integer value greater than or equal to <code>arg</code></li>
<li><code>exp(arg)</code> - powers <a href="https://en.wikipedia.org/wiki/E_(mathematical_constant)"><code>e</code></a> by <code>arg</code></li>
<li><code>floor(arg)</code> - returns the greatest integer value less than or equal to <code>arg</code></li>
<li><code>ln(arg)</code> - returns <a href="https://en.wikipedia.org/wiki/Natural_logarithm">natural logarithm</a> for the given <code>arg</code></li>
<li><code>max(arg1, ..., argN)</code> - returns the maximum value among the given <code>arg1</code>, ..., <code>argN</code></li>
<li><code>min(arg1, ..., argN)</code> - returns the minimum value among the given <code>arg1</code>, ..., <code>argN</code></li>
<li><code>now()</code> - returns the current <a href="https://en.wikipedia.org/wiki/Unix_time">Unix timestamp</a> in nanoseconds.</li>
<li><code>rand()</code> - returns pseudo-random number in the range <code>[0...1)</code>.</li>
<li><code>round(arg)</code> - returns rounded to integer value for the given <code>arg</code>. The <code>round()</code> accepts optional <code>nearest</code> arg, which allows rounding the number to the given <code>nearest</code> multiple.
For example, <code>round(temperature, 0.1)</code> rounds <code>temperature</code> field to one decimal digit after the point.</li>
</ul>
<p>Every <code>argX</code> argument in every mathematical operation can contain one of the following values:</p>
<ul>
<li>The name of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field</a>. For example, <code>errors_total / requests_total</code>.
The log field is parsed into numeric value if it contains <a href="https://docs.victoriametrics.com/victorialogs/logsql/#numeric-values">supported numeric value</a>. The log field is parsed into <a href="https://en.wikipedia.org/wiki/Unix_time">Unix timestamp</a>
in nanoseconds if it contains <a href="https://www.rfc-editor.org/rfc/rfc3339">rfc3339 time</a>. The log field is parsed into <code>uint32</code> number if it contains IPv4 address.
The log field is parsed into <code>NaN</code> in other cases.</li>
<li>Any <a href="https://docs.victoriametrics.com/victorialogs/logsql/#numeric-values">supported numeric value</a>, <a href="https://www.rfc-editor.org/rfc/rfc3339">rfc3339 time</a> or IPv4 address. For example, <code>1MiB</code>, <code>&quot;2024-05-15T10:20:30.934324Z&quot;</code> or <code>&quot;12.34.56.78&quot;</code>.</li>
<li>Another mathematical expression, which can be put inside <code>(...)</code>. For example, <code>(a + b) * c</code>.</li>
</ul>
<p>The parsed time, duration and IPv4 address can be converted back to string representation after math transformations with the help of <a href="https://docs.victoriametrics.com/victorialogs/logsql/#format-pipe"><code>format</code> pipe</a>. For example,
the following query rounds the <code>request_duration</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">field</a> to seconds before converting it back to string representation:</p>
<pre><code class="language-logsql">_time:5m | math round(request_duration, 1e9) as request_duration_nsecs | format &#39;&lt;duration:request_duration_nsecs&gt;&#39; as request_duration
</code></pre>
<p>The <code>eval</code> keyword can be used instead of <code>math</code> for convenience. For example, the following query calculates <code>duration_msecs</code> field
by multiplying <code>duration_secs</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">field</a> to <code>1000</code>:</p>
<pre><code class="language-logsql">_time:5m | eval (duration_secs * 1000) as duration_msecs
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe"><code>stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#format-pipe"><code>format</code> pipe</a></li>
</ul>
</div>`},{id:"offset-pipe",value:"offset",title:"offset pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#offset-pipe target="_blank" rel="noreferrer">offset pipe</a></h5><p>If some selected logs must be skipped after <a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code></a>, then <code>| offset N</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> can be used, where <code>N</code> can contain any <a href="https://docs.victoriametrics.com/victorialogs/logsql/#numeric-values">supported integer numeric value</a>.
For example, the following query skips the first 100 logs over the last 5 minutes after sorting them by <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#time-field"><code>_time</code></a>:</p>
<pre><code class="language-logsql">_time:5m | sort by (_time) | offset 100
</code></pre>
<p><code>skip</code> keyword can be used instead of <code>offset</code> keyword for convenience. For example, <code>_time:5m | skip 10</code> is equivalent to <code>_time:5m | offset 10</code>.</p>
<p>Note that skipping rows without sorting makes little sense, since they can be returned in arbitrary order for performance reasons.
Rows can be sorted with <a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a>.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#limit-pipe"><code>limit</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a></li>
</ul>
</div>`},{id:"pack_json-pipe",value:"pack_json",title:"pack_json pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#pack_json-pipe target="_blank" rel="noreferrer">pack_json pipe</a></h5><p><code>&lt;q&gt; | pack_json as field_name</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> packs all the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">fields</a> of every log
entry returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> into JSON object and stores it as a string in the given <code>field_name</code>.</p>
<p>For example, the following query packs all the fields into JSON object and stores it into <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>
for logs over the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | pack_json as _msg
</code></pre>
<p>The <code>as _msg</code> part can be omitted if packed JSON object is stored into <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>.
The following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | pack_json
</code></pre>
<p>If only a subset of fields must be packed into JSON, then it must be listed inside <code>fields (...)</code> after <code>pack_json</code>. For example, the following query builds JSON with <code>foo</code> and <code>bar</code> fields
only and stores the result in <code>baz</code> field:</p>
<pre><code class="language-logsql">_time:5m | pack_json fields (foo, bar) as baz
</code></pre>
<p>It is possible to pass field prefixes into <code>fields (...)</code> in order to pack only the fields, which start with the given prefixes.
For example, the following query builds JSON with all the fields, which start with either <code>foo.</code> or <code>bar.</code>:</p>
<pre><code class="language-logsql">_time:5m | pack_json fields (foo.*, bar.*) as baz
</code></pre>
<p>The <code>pack_json</code> doesn&#39;t modify or delete other fields. If you do not need them, then add <a href="https://docs.victoriametrics.com/victorialogs/logsql/#fields-pipe"><code>| fields ...</code></a> after the <code>pack_json</code> pipe. For example, the following query
leaves only the <code>foo</code> field with the original log fields packed into JSON:</p>
<pre><code class="language-logsql">_time:5m | pack_json as foo | fields foo
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#pack_logfmt-pipe"><code>pack_logfmt</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_json-pipe"><code>unpack_json</code> pipe</a></li>
</ul>
</div>`},{id:"pack_logfmt-pipe",value:"pack_logfmt",title:"pack_logfmt pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#pack_logfmt-pipe target="_blank" rel="noreferrer">pack_logfmt pipe</a></h5><p><code>&lt;q&gt; | pack_logfmt as field_name</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> packs all the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">fields</a> for every log entry
returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> into <a href="https://brandur.org/logfmt">logfmt</a> message and stores it as a string in the given <code>field_name</code>.</p>
<p>For example, the following query packs all the fields into <a href="https://brandur.org/logfmt">logfmt</a> message and stores it
into <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a> for logs over the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | pack_logfmt as _msg
</code></pre>
<p>The <code>as _msg</code> part can be omitted if packed message is stored into <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>.
The following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | pack_logfmt
</code></pre>
<p>If only a subset of fields must be packed into <a href="https://brandur.org/logfmt">logfmt</a>, then it must be listed inside <code>fields (...)</code> after <code>pack_logfmt</code>.
For example, the following query builds <a href="https://brandur.org/logfmt">logfmt</a> message with <code>foo</code> and <code>bar</code> fields only and stores the result in <code>baz</code> field:</p>
<pre><code class="language-logsql">_time:5m | pack_logfmt fields (foo, bar) as baz
</code></pre>
<p>It is possible to pass field prefixes into <code>fields (...)</code> in order to pack only the fields, which start with the given prefixes.
For example, the following query builds <code>logfmt</code> message with all the fields, which start with either <code>foo.</code> or <code>bar.</code>:</p>
<pre><code class="language-logsql">_time:5m | pack_logfmt fields (foo.*, bar.*) as baz
</code></pre>
<p>The <code>pack_logfmt</code> doesn&#39;t modify or delete other fields. If you do not need them, then add <a href="https://docs.victoriametrics.com/victorialogs/logsql/#fields-pipe"><code>| fields ...</code></a> after the <code>pack_logfmt</code> pipe. For example, the following query
leaves only the <code>foo</code> field with the original log fields packed into <a href="https://brandur.org/logfmt">logfmt</a>:</p>
<pre><code class="language-logsql">_time:5m | pack_logfmt as foo | fields foo
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#pack_json-pipe"><code>pack_json</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_logfmt-pipe"><code>unpack_logfmt</code> pipe</a></li>
</ul>
</div>`},{id:"query_stats-pipe",value:"query_stats",title:"query_stats pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#query_stats-pipe target="_blank" rel="noreferrer">query_stats pipe</a></h5><p>The <code>&lt;q&gt; | query_stats</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> returns the following execution statistics for the given <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query <code>&lt;q&gt;</code></a>:</p>
<ul>
<li><code>BytesReadColumnsHeaders</code> - the number of bytes read from disk for column headers. Use <a href="https://docs.victoriametrics.com/victorialogs/logsql/#fields-pipe"><code>fields</code> pipe</a> for reducing the number of bytes read for column headers.</li>
<li><code>BytesReadColumnsHeaderIndexes</code> - the number of bytes read from disk for column header indexes.</li>
<li><code>BytesReadBloomFilters</code> - the number of bytes read from disk for bloom filters.</li>
<li><code>BytesReadValues</code> - the number of bytes read from disk for <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>.
 Use <a href="https://docs.victoriametrics.com/victorialogs/logsql/#fields-pipe"><code>fields</code> pipe</a> for reducing the number of bytes read for log field values.</li>
<li><code>BytesReadTimestamps</code> - the number of bytes read from disk for <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#time-field"><code>_time</code> field</a>.</li>
<li><code>BytesReadBlockHeaders</code> - the number of bytes read from disk for block headers.</li>
<li><code>BytesReadTotal</code> - the total number of bytes read from disk.</li>
<li><code>BlocksProcessed</code> - the number of data blocks processed during query execution. Use more narrow <a href="https://docs.victoriametrics.com/victorialogs/logsql/#time-filter">time filter</a> and <a href="https://docs.victoriametrics.com/victorialogs/logsql/#stream-filter">log stream filter</a>
for reducing the number of data blocks processed.</li>
<li><code>RowsProcessed</code> - the number of log entries processed during query execution. Use more narrow <a href="https://docs.victoriametrics.com/victorialogs/logsql/#time-filter">time filter</a> and <a href="https://docs.victoriametrics.com/victorialogs/logsql/#stream-filter">log stream filter</a>
for reducing the number of processed log entries.</li>
<li><code>RowsFound</code> - the number of log entries found by the query.</li>
<li><code>ValuesRead</code> - the number of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field values</a> read during query processing.
Use <a href="https://docs.victoriametrics.com/victorialogs/logsql/#fields-pipe"><code>fields</code> pipe</a> for reducing the number of field values read.</li>
<li><code>TimestampsRead</code> - the number of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#time-field"><code>_time</code> fields</a> read during query processing.</li>
<li><code>BytesProcessedUncompressedValues</code> - the number of uncompressed bytes for <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field values</a>,
which are processed during query execution.</li>
<li><code>QueryDurationNsecs</code> - the duration of the query in nanoseconds. It can be used for calculating various rates over the query stats with the <a href="https://docs.victoriametrics.com/victorialogs/logsql/#math-pipe"><code>math</code> pipe</a>.</li>
</ul>
<p>This pipe is useful for investigation and optimizing slow queries.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#block_stats-pipe"><code>block_stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#troubleshooting">query troubleshooting</a></li>
</ul>
</div>`},{id:"rename-pipe",value:"rename",title:"rename pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#rename-pipe target="_blank" rel="noreferrer">rename pipe</a></h5><p>If some <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> must be renamed, then <code>| rename src1 as dst1, ..., srcN as dstN</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> can be used.
For example, the following query renames <code>host</code> field to <code>server</code> for logs over the last 5 minutes, so the output contains <code>server</code> field instead of <code>host</code> field:</p>
<pre><code class="language-logsql">_time:5m | rename host as server
</code></pre>
<p>Multiple fields can be renamed with a single <code>| rename ...</code> pipe. For example, the following query renames <code>host</code> to <code>instance</code> and <code>app</code> to <code>job</code>:</p>
<pre><code class="language-logsql">_time:5m | rename host as instance, app as job
</code></pre>
<p>The <code>as</code> keyword is optional.</p>
<p><code>mv</code> keyword can be used instead of <code>rename</code> keyword for convenience. For example, <code>_time:5m | mv foo bar</code> is equivalent to <code>_time:5m | rename foo as bar</code>.</p>
<p>It is possible to rename multiple fields with the given prefix to fields with another prefix. For example, the following query renames all the fields
starting with <code>foo</code> prefix to fields starting with <code>bar</code> prefix:</p>
<pre><code class="language-logsql">_time:5m | rename foo* as bar*
</code></pre>
<p>It is also possible to remove the common prefix from some fields. For example, the following query removes the <code>foo</code> prefix from all the fields that start with <code>foo</code>:</p>
<pre><code class="language-logsql">_time:5m | rename foo* as *
</code></pre>
<p>It is also possible to add a common prefix to all the fields. For example, the following query adds the <code>foo</code> prefix to all the fields:</p>
<pre><code class="language-logsql">_time:5m | rename * as foo*
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#copy-pipe"><code>copy</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#fields-pipe"><code>fields</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#delete-pipe"><code>delete</code> pipe</a></li>
</ul>
</div>`},{id:"replace_regexp-pipe",value:"replace_regexp",title:"replace_regexp pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#replace_regexp-pipe target="_blank" rel="noreferrer">replace_regexp pipe</a></h5><p><code>&lt;q&gt; | replace_regexp (&quot;regexp&quot;, &quot;replacement&quot;) at field</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> replaces all the substrings matching the given <code>regexp</code> with the given <code>replacement</code>
in the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>field</code></a> over all the logs returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>.</p>
<p>The <code>regexp</code> must contain regular expression with <a href="https://github.com/google/re2/wiki/Syntax">RE2 syntax</a>.
The <code>replacement</code> may contain <code>$N</code> or <code>\${N}</code> placeholders, which are substituted with the <code>N-th</code> capturing group in the <code>regexp</code>.</p>
<p>For example, the following query replaces all the substrings starting with <code>host-</code> and ending with <code>-foo</code> with the contents between <code>host-</code> and <code>-foo</code> in the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a> for logs over the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | replace_regexp (&quot;host-(.+?)-foo&quot;, &quot;$1&quot;) at _msg
</code></pre>
<p>The <code>at _msg</code> part can be omitted if the replacement occurs in the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>.
The following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | replace_regexp (&quot;host-(.+?)-foo&quot;, &quot;$1&quot;)
</code></pre>
<p>The number of replacements can be limited with <code>limit N</code> at the end of <code>replace_regexp</code>. For example, the following query replaces only the first <code>password: ...</code> substring
ending with whitespace with empty substring at the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field</a> <code>baz</code>:</p>
<pre><code class="language-logsql">_time:5m | replace_regexp (&#39;password: [^ ]+&#39;, &#39;&#39;) at baz limit 1
</code></pre>
<p>Performance tips:</p>
<ul>
<li>It is recommended to use the <a href="https://docs.victoriametrics.com/victorialogs/logsql/#replace-pipe"><code>replace</code> pipe</a> instead of <code>replace_regexp</code> if possible, since it works faster.</li>
<li>It is recommended to use more specific <a href="https://docs.victoriametrics.com/victorialogs/logsql/#filters">log filters</a> in order to reduce the number of log entries that are passed to <code>replace_regexp</code>.
See <a href="https://docs.victoriametrics.com/victorialogs/logsql/#performance-tips">general performance tips</a> for details.</li>
</ul>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#conditional-replace_regexp">Conditional replace_regexp</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#replace-pipe"><code>replace</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#collapse_nums-pipe"><code>collapse_nums</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#format-pipe"><code>format</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#decolorize-pipe"><code>decolorize</code> pipe</a></li>
</ul>
</div>`},{id:"replace-pipe",value:"replace",title:"replace pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#replace-pipe target="_blank" rel="noreferrer">replace pipe</a></h5><p><code>&lt;q&gt; | replace (&quot;old&quot;, &quot;new&quot;) at field</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> replaces all the occurrences of the <code>old</code> substring with the <code>new</code> substring
in the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>field</code></a> over all the logs returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>.</p>
<p>For example, the following query replaces all the <code>secret-password</code> substrings with <code>***</code> in the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>
for logs over the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | replace (&quot;secret-password&quot;, &quot;***&quot;) at _msg
</code></pre>
<p>The <code>at _msg</code> part can be omitted if the replacement occurs in the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>.
The following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | replace (&quot;secret-password&quot;, &quot;***&quot;)
</code></pre>
<p>The number of replacements can be limited with <code>limit N</code> at the end of <code>replace</code>. For example, the following query replaces only the first <code>foo</code> substring with <code>bar</code>
at the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field</a> <code>baz</code>:</p>
<pre><code class="language-logsql">_time:5m | replace (&#39;foo&#39;, &#39;bar&#39;) at baz limit 1
</code></pre>
<p>Performance tip: it is recommended using more specific <a href="https://docs.victoriametrics.com/victorialogs/logsql/#filters">log filters</a> in order to reduce the number of log entries, which are passed to <code>replace</code>.
See <a href="https://docs.victoriametrics.com/victorialogs/logsql/#performance-tips">general performance tips</a> for details.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#conditional-replace">Conditional replace</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#replace_regexp-pipe"><code>replace_regexp</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#collapse_nums-pipe"><code>collapse_nums</code></a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#format-pipe"><code>format</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a></li>
</ul>
</div>`},{id:"running_stats-pipe",value:"running_stats",title:"running_stats pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#running_stats-pipe target="_blank" rel="noreferrer">running_stats pipe</a></h5><p>The <code>&lt;q&gt; | running_stats ...</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> calculates running stats (such as <a href="https://docs.victoriametrics.com/victorialogs/logsql/#count-running_stats">running count</a> or <a href="https://docs.victoriametrics.com/victorialogs/logsql/#sum-running_stats">running sum</a>)
over the specified <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>
and stores the stats in the specified log fields for each input log entry.</p>
<p>The running stats is calculated over the logs sorted by time, so the <code>&lt;q&gt;</code> must return the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#time-field"><code>_time</code> field</a>
in order to properly calculate the running stats.</p>
<p>The <code>running_stats</code> pipe puts all the logs returned by <code>&lt;q&gt;</code> in memory, so make sure the <code>&lt;q&gt;</code> returns the limited number of logs in order to avoid high memory usage.</p>
<p>For example, the following LogsQL query calculates <a href="https://docs.victoriametrics.com/victorialogs/logsql/#sum-running_stats">running sum</a> for the <code>hits</code> field over the logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | running_stats sum(hits) as running_hits
</code></pre>
<p>The <code>| running_stats ...</code> pipe has the following basic format:</p>
<pre><code class="language-logsql">... | running_stats
  stats_func1(...) as result_name1,
  ...
  stats_funcN(...) as result_nameN
</code></pre>
<p>Where <code>stats_func*</code> is any of the supported <a href="https://docs.victoriametrics.com/victorialogs/logsql/#running_stats-pipe-functions">running stats function</a>, while the <code>result_name*</code> is the name of the log field
to store the result of the corresponding stats function. The <code>as</code> keyword is optional.</p>
<p>For example, the following query calculates the following running stats for logs over the last 5 minutes:</p>
<ul>
<li>the number of logs with the help of <a href="https://docs.victoriametrics.com/victorialogs/logsql/#count-running_stats"><code>count</code> function</a>;</li>
<li>the sum of <code>hits</code> field with the help of <a href="https://docs.victoriametrics.com/victorialogs/logsql/#sum-running_stats"><code>sum</code> function</a>:</li>
</ul>
<pre><code class="language-logsql">_time:5m
    | running_stats
        count() as running_logs,
        sum(hits) as running_hits
</code></pre>
<p>It is allowed omitting the result name. In this case the result name equals the string representation of the used <a href="https://docs.victoriametrics.com/victorialogs/logsql/#running_stats-pipe-functions">running stats function</a>.
For example, the following query returns the same stats as the previous one, but gives <code>count(*)</code> and <code>sum(hits)</code> names for the returned fields:</p>
<pre><code class="language-logsql">_time:5m | running_stats count(), sum(hits)
</code></pre>
<p>It is useful to combine <code>running_stats</code> with <a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-by-time-buckets">stats by time buckets</a>. For example, the following query returns per-hour number of logs over the last day,
plus running number of logs.</p>
<pre><code class="language-logsql">_time:1d
    | stats by (_time:hour) count() as hits
    | running_stats sum(hits) as running_hits
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#running_stats-pipe-functions"><code>running_stats</code> pipe functions</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#running_stats-by-fields"><code>running_stats</code> by fields</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#total_stats-pipe"><code>total_stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe"><code>stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a></li>
</ul>
</div>`},{id:"sample-pipe",value:"sample",title:"sample pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#sample-pipe target="_blank" rel="noreferrer">sample pipe</a></h5><p>The <code>&lt;q&gt; | sample N</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> returns <code>1/N</code>th random sample of logs for the <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>.
For example, the following query returns ~1% (1/100th random sample) of logs over the last hour with the <code>error</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#word">word</a>
in the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>:</p>
<pre><code class="language-logsql">_time:1h error | sample 100
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#limit-pipe"><code>limit</code> pipe</a></li>
</ul>
</div>`},{id:"set_stream_fields-pipe",value:"set_stream_fields",title:"set_stream_fields pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#set_stream_fields-pipe target="_blank" rel="noreferrer">set_stream_fields pipe</a></h5><p>The <code>| set_stream_fields field1, ..., fieldN</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a>
sets the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>
as <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#stream-fields"><code>_stream</code> fields</a>.</p>
<p>For example, if the logs returned by <code>_time:5m</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#filters">filter</a> have <code>host=&quot;foo&quot;</code> and <code>path=&quot;/bar&quot;</code> fields,
then the following query sets <code>_stream</code> field to <code>{host=&quot;foo&quot;, path=&quot;/bar&quot;}</code>:</p>
<pre><code class="language-logsql">_time:5m | set_stream_fields host, path
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#conditional-set_stream_fields">conditional <code>set_stream_fields</code></a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#format-pipe"><code>format</code> pipe</a></li>
</ul>
</div>`},{id:"sort-pipe",value:"sort",title:"sort pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe target="_blank" rel="noreferrer">sort pipe</a></h5><p>By default logs are selected in arbitrary order for performance reasons. If logs must be sorted, then <code>&lt;q&gt; | sort by (field1, ..., fieldN)</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> can be used
for sorting logs returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> by the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">fields</a>
using <a href="https://en.wikipedia.org/wiki/Natural_sort_order">natural sorting</a>.</p>
<p>For example, the following query returns logs for the last 5 minutes sorted by <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#stream-fields"><code>_stream</code></a>
and then by <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#time-field"><code>_time</code></a>:</p>
<pre><code class="language-logsql">_time:5m | sort by (_stream, _time)
</code></pre>
<p>Add <code>desc</code> after the given log field in order to sort in reverse order of this field. For example, the following query sorts logs in reverse order of <code>request_duration_seconds</code> field:</p>
<pre><code class="language-logsql">_time:5m | sort by (request_duration_seconds desc)
</code></pre>
<p>The reverse order can be applied globally via <code>desc</code> keyword after <code>by(...)</code> clause:</p>
<pre><code class="language-logsql">_time:5m | sort by (foo, bar) desc
</code></pre>
<p>The <code>by</code> keyword can be skipped in <code>sort ...</code> pipe. For example, the following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | sort (foo, bar) desc
</code></pre>
<p>The <code>order</code> alias can be used instead of <code>sort</code>, so the following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | order by (foo, bar) desc
</code></pre>
<p>Sorting a large number of logs can consume a lot of CPU time and memory. Sometimes it is enough to return the first <code>N</code> entries with the biggest
or the smallest values. This can be done by adding <code>limit N</code> to the end of <code>sort ...</code> pipe.
Such a query consumes less memory when sorting a large number of logs, since it keeps in memory only <code>N</code> log entries.
For example, the following query returns top 10 log entries with the biggest values
for the <code>request_duration</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">field</a> during the last hour:</p>
<pre><code class="language-logsql">_time:1h | sort by (request_duration desc) limit 10
</code></pre>
<p>This query is equivalent to the following one, which uses <a href="https://docs.victoriametrics.com/victorialogs/logsql/#last-pipe"><code>last</code> pipe</a>:</p>
<pre><code class="language-logsql">_time:1h | last 10 by (request_duration)
</code></pre>
<p>If the first <code>N</code> sorted results must be skipped, then <code>offset N</code> can be added to <code>sort</code> pipe. For example,
the following query skips the first 10 logs with the biggest <code>request_duration</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">field</a>,
and then returns the next 20 sorted logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:1h | sort by (request_duration desc) offset 10 limit 20
</code></pre>
<p>It is possible to sort the logs and apply the <code>limit</code> individually for each group of logs with the same set of <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">fields</a>,
by enumerating the set of these fields in <code>partition by (...)</code>.
For example, the following query returns up to 3 logs with the biggest <code>request_duration</code> for each host over the last hour:</p>
<pre><code class="language-logsql">_time:1h | sort by (request_duration desc) partition by (host) limit 3
</code></pre>
<p>It is possible to return a rank (sort order number) for every sorted log by adding <code>rank as &lt;fieldName&gt;</code> to the end of the <code>| sort ...</code> pipe.
For example, the following query stores rank for sorted by <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#time-field"><code>_time</code></a> logs
into <code>position</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">field</a>:</p>
<pre><code class="language-logsql">_time:5m | sort by (_time) rank as position
</code></pre>
<p>Note that sorting a large number of logs can be slow and can consume a lot of additional memory.
It is recommended to limit the number of logs before sorting with the following approaches:</p>
<ul>
<li>Adding <code>limit N</code> to the end of <code>sort ...</code> pipe.</li>
<li>Reducing the selected time range with <a href="https://docs.victoriametrics.com/victorialogs/logsql/#time-filter">time filter</a>.</li>
<li>Using more specific <a href="https://docs.victoriametrics.com/victorialogs/logsql/#filters">filters</a>, so they select less logs.</li>
<li>Limiting the number of selected <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">fields</a> via <a href="https://docs.victoriametrics.com/victorialogs/logsql/#fields-pipe"><code>fields</code> pipe</a>.</li>
</ul>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#first-pipe"><code>first</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#last-pipe"><code>last</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#top-pipe"><code>top</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe"><code>stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#limit-pipe"><code>limit</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#offset-pipe"><code>offset</code> pipe</a></li>
</ul>
</div>`},{id:"split-pipe",value:"split",title:"split pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#split-pipe target="_blank" rel="noreferrer">split pipe</a></h5><p>The <code>&lt;q&gt; | split &lt;separator&gt; from &lt;src_field&gt; as &lt;dst_field&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> splits <code>&lt;src_field&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field</a>
obtained from <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> results into <code>&lt;dst_field&gt;</code> as a JSON array, by using the given <code>&lt;separator&gt;</code>.</p>
<p>For example, the following query splits <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field">log messages</a> by <code>,</code> and stores the results into <code>items</code> field:</p>
<pre><code class="language-logsql">_time:5m | split &quot;,&quot; from _msg as items
</code></pre>
<p>The <code>as &lt;dst_field&gt;</code> part is optional. If it is missing, then the result is stored in the <code>&lt;src_field&gt;</code> specified in <code>from &lt;src_field&gt;</code>.
For example, the following query stores the split result into <code>_msg</code> field:</p>
<pre><code class="language-logsql">_time:5m | split &quot;,&quot; from _msg
</code></pre>
<p>The <code>from &lt;src_field&gt;</code> part is optional. If it is missing, then the <code>_msg</code> field is used as a source field. The following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | split &quot;,&quot;
</code></pre>
<p>It is convenient to use <a href="https://docs.victoriametrics.com/victorialogs/logsql/#unroll-pipe"><code>unroll</code> pipe</a> for unrolling the JSON array with the split results.
For example, the following query returns top 5 most frequently seen comma-separated items across <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field">log messages</a>
for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | split &quot;,&quot; as items | unroll items | top 5 (items)
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unroll-pipe"><code>unroll</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_words-pipe"><code>unpack_words</code> pipe</a></li>
</ul>
</div>`},{id:"stats-pipe",value:"stats",title:"stats pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe target="_blank" rel="noreferrer">stats pipe</a></h5><p>The <code>&lt;q&gt; | stats ...</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> calculates various stats over the logs returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>.
For example, the following LogsQL query uses <a href="https://docs.victoriametrics.com/victorialogs/logsql/#count-stats"><code>count</code> stats function</a> for calculating the number of logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | stats count() as logs_total
</code></pre>
<p>The <code>| stats ...</code> pipe has the following basic format:</p>
<pre><code class="language-logsql">... | stats
  stats_func1(...) as result_name1,
  ...
  stats_funcN(...) as result_nameN
</code></pre>
<p>Where <code>stats_func*</code> is any of the supported <a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe-functions">stats function</a>, while the <code>result_name*</code> is the name of the log field
to store the result of the corresponding stats function. The <code>as</code> keyword is optional.</p>
<p>For example, the following query calculates the following stats for logs over the last 5 minutes:</p>
<ul>
<li>the number of logs with the help of <a href="https://docs.victoriametrics.com/victorialogs/logsql/#count-stats"><code>count</code> stats function</a>;</li>
<li>the number of unique <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#stream-fields">log streams</a> with the help of <a href="https://docs.victoriametrics.com/victorialogs/logsql/#count_uniq-stats"><code>count_uniq</code> stats function</a>:</li>
</ul>
<pre><code class="language-logsql">_time:5m | stats count() logs_total, count_uniq(_stream) streams_total
</code></pre>
<p>It is allowed omitting <code>stats</code> prefix for convenience. So the following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | count() logs_total, count_uniq(_stream) streams_total
</code></pre>
<p>It is allowed omitting the result name. In this case the result name equals the string representation of the used <a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe-functions">stats function</a>.
For example, the following query returns the same stats as the previous one, but gives <code>count(*)</code> and <code>count_uniq(_stream)</code> names for the returned fields:</p>
<pre><code class="language-logsql">_time:5m | count(), count_uniq(_stream)
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe-functions">stats pipe functions</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-by-fields">stats by fields</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-by-time-buckets">stats by time buckets</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-by-time-buckets-with-timezone-offset">stats by time buckets with timezone offset</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-by-field-buckets">stats by field buckets</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-by-ipv4-buckets">stats by IPv4 buckets</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-with-additional-filters">stats with additional filters</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#running_stats-pipe"><code>running_stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#total_stats-pipe"><code>total_stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#math-pipe"><code>math</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#uniq-pipe"><code>uniq</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#top-pipe"><code>top</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#join-pipe"><code>join</code> pipe</a></li>
</ul>
</div>`},{id:"stream_context-pipe",value:"stream_context",title:"stream_context pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#stream_context-pipe target="_blank" rel="noreferrer">stream_context pipe</a></h5><p><code>&lt;q&gt; | stream_context ...</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> allows selecting surrounding logs in a <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#stream-fields">log stream</a>
across the logs returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> in the way similar to <code>grep -A</code> / <code>grep -B</code>.
The returned log chunks are delimited with <code>---</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field">log message</a> for easier investigation.</p>
<p>For example, the following query returns up to 10 additional logs after every log message with the <code>panic</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#word">word</a> across all the logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m panic | stream_context after 10
</code></pre>
<p>The following query returns up to 5 additional logs in front of every log message with the <code>stacktrace</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#word">word</a> across all the logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m stacktrace | stream_context before 5
</code></pre>
<p>The following query returns up to 2 logs in front of the log message with the <code>error</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#word">word</a> and up to 5 logs after this log message
across all the logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m error | stream_context before 2 after 5
</code></pre>
<p>By default <code>stream_context</code> pipe looks for surrounding logs in a one-hour window. This window can be changed via the <code>time_window</code> option at query time.
For example, the following query searches for surrounding logs in a one-week window:</p>
<pre><code class="language-logsql">_time:5m error | stream_context before 10 time_window 1w
</code></pre>
<p>The <code>| stream_context</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> must go first just after the <a href="https://docs.victoriametrics.com/victorialogs/logsql/#filters">filters</a>.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stream-filter">stream filter</a></li>
</ul>
</div>`},{id:"time_add-pipe",value:"time_add",title:"time_add pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#time_add-pipe target="_blank" rel="noreferrer">time_add pipe</a></h5><p><code>&lt;q&gt; | time_add &lt;duration&gt;</code> adds the given <code>&lt;duration&gt;</code> to the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#time-field"><code>_time</code> field</a>.
The <code>&lt;duration&gt;</code> can be in any format described <a href="https://docs.victoriametrics.com/victorialogs/logsql/#duration-values">here</a>.</p>
<p>For example, the following query adds one hour to <code>_time</code> field in the selected logs:</p>
<pre><code class="language-logsql">_time:5m | time_add 1h
</code></pre>
<p>Specify negative duration for subtracting it from the <code>_time</code> field:</p>
<pre><code class="language-logsql">_time:5m | time_add -1h
</code></pre>
<p>Add <code>at &lt;field_name&gt;</code> to the end of the <code>time_add</code> pipe in order to add the given <code>&lt;duration&gt;</code> to the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field</a>
with the given <code>&lt;field_name&gt;</code>. For example, the following query adds one week to the field <code>transaction_time</code>:</p>
<pre><code class="language-logsql">_time:5m | time_add 1w at transaction_time
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#time-filter"><code>_time</code> filter</a>.</li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-options"><code>time_offset</code> option</a>.</li>
</ul>
</div>`},{id:"top-pipe",value:"top",title:"top pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#top-pipe target="_blank" rel="noreferrer">top pipe</a></h5><p><code>&lt;q&gt; | top N by (field1, ..., fieldN)</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> returns top <code>N</code> sets for <code>(field1, ..., fieldN)</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>
with the maximum number of matching log entries across logs returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>.</p>
<p>For example, the following query returns top 7 <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#stream-fields">log streams</a>
with the maximum number of log entries over the last 5 minutes. The number of entries is returned in the <code>hits</code> field:</p>
<pre><code class="language-logsql">_time:5m | top 7 by (_stream)
</code></pre>
<p>The <code>N</code> is optional. If it is skipped, then top 10 entries are returned. For example, the following query returns top 10 values
for <code>ip</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">field</a> seen in logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | top by (ip)
</code></pre>
<p>It is possible to give another name for the <code>hits</code> field via <code>hits as &lt;new_name&gt;</code> syntax. For example, the following query returns top per-<code>path</code> hits in the <code>visits</code> field:</p>
<pre><code class="language-logsql">_time:5m | top by (path) hits as visits
</code></pre>
<p>It is possible to set a <code>rank</code> field for each returned entry for the <code>top</code> pipe by adding <code>rank</code>. For example, the following query sets the <code>rank</code> field for each returned <code>ip</code>:</p>
<pre><code class="language-logsql">_time:5m | top 10 by (ip) rank
</code></pre>
<p>The <code>rank</code> field can have other name. For example, the following query uses the <code>position</code> field name instead of <code>rank</code> field name in the output:</p>
<pre><code class="language-logsql">_time:5m | top 10 by (ip) rank as position
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#first-pipe"><code>first</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#last-pipe"><code>last</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#facets-pipe"><code>facets</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#uniq-pipe"><code>uniq</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe"><code>stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#histogram-stats"><code>histogram</code> stats function</a></li>
</ul>
</div>`},{id:"total_stats-pipe",value:"total_stats",title:"total_stats pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#total_stats-pipe target="_blank" rel="noreferrer">total_stats pipe</a></h5><p>The <code>&lt;q&gt; | total_stats ...</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> calculates total (global) stats (such as <a href="https://docs.victoriametrics.com/victorialogs/logsql/#count-total_stats">global count</a> or <a href="https://docs.victoriametrics.com/victorialogs/logsql/#sum-total_stats">global sum</a>)
over the specified <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>
and stores these stats in the specified log fields for each input log entry.</p>
<p>The <code>total_stats</code> pipe sorts the logs returned by <code>&lt;q&gt;</code> by the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#time-field"><code>_time</code> field</a> inside each <code>by(...)</code> group
before calculating stats and returning results.
If <code>&lt;q&gt;</code> doesn&#39;t return <code>_time</code>, then the output order is undefined.</p>
<p>The <code>total_stats</code> pipe puts all the logs returned by <code>&lt;q&gt;</code> in memory (up to a certain limit) before it can return results, so make sure the <code>&lt;q&gt;</code> returns the limited number of logs in order to avoid high memory usage.</p>
<p>For example, the following LogsQL query calculates <a href="https://docs.victoriametrics.com/victorialogs/logsql/#sum-total_stats">total sum</a> for the <code>hits</code> field over the logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | total_stats sum(hits) as total_hits
</code></pre>
<p>The <code>| total_stats ...</code> pipe has the following basic format:</p>
<pre><code class="language-logsql">... | total_stats
  stats_func1(...) as result_name1,
  ...
  stats_funcN(...) as result_nameN
</code></pre>
<p>Where <code>stats_func*</code> is any of the supported <a href="https://docs.victoriametrics.com/victorialogs/logsql/#total_stats-pipe-functions">total stats function</a>, while the <code>result_name*</code> is the name of the log field
to store the result of the corresponding stats function. The <code>as</code> keyword is optional.</p>
<p>For example, the following query calculates the following total stats for logs over the last 5 minutes:</p>
<ul>
<li>the number of logs with the help of <a href="https://docs.victoriametrics.com/victorialogs/logsql/#count-total_stats"><code>count</code> function</a>;</li>
<li>the sum of <code>hits</code> field with the help of <a href="https://docs.victoriametrics.com/victorialogs/logsql/#sum-total_stats"><code>sum</code> function</a>:</li>
</ul>
<pre><code class="language-logsql">_time:5m
    | total_stats
        count() as total_logs,
        sum(hits) as total_hits
</code></pre>
<p>It is allowed omitting the result name. In this case the result name equals the string representation of the used <a href="https://docs.victoriametrics.com/victorialogs/logsql/#total_stats-pipe-functions">total stats function</a>.
For example, the following query returns the same stats as the previous one, but gives <code>count(*)</code> and <code>sum(hits)</code> names for the returned fields:</p>
<pre><code class="language-logsql">_time:5m | total_stats count(), sum(hits)
</code></pre>
<p>It is useful to combine <code>total_stats</code> with <a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-by-time-buckets">stats by time buckets</a>. For example, the following query returns per-hour number of logs over the last day,
plus the total number of logs, and then calculates the per-hour percent of hits over the daily hits.</p>
<pre><code class="language-logsql">_time:1d
    | stats by (_time:hour) count() as hits
    | total_stats sum(hits) as total_hits
    | math round((hits / total_hits)*100) as hits_percent
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#total_stats-pipe-functions"><code>total_stats</code> pipe functions</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#total_stats-by-fields"><code>total_stats</code> by fields</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#running_stats-pipe"><code>running_stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe"><code>stats</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a></li>
</ul>
</div>`},{id:"union-pipe",value:"union",title:"union pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#union-pipe target="_blank" rel="noreferrer">union pipe</a></h5><p><code>&lt;q1&gt; | union (&lt;q2&gt;)</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> returns results of <code>&lt;q1&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> followed by results of <code>&lt;q2&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>.
It works similarly to <code>UNION ALL</code> in SQL. <code>&lt;q1&gt;</code> and <code>q2</code> may contain arbitrary <a href="https://docs.victoriametrics.com/victorialogs/logsql/#logsql-tutorial">LogsQL queries</a>.
For example, the following query returns logs with <code>error</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#word">word</a> for the last 5 minutes, plus logs with <code>panic</code> word for the last hour:</p>
<pre><code class="language-logsql">_time:5m error | union (_time:1h panic)
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#join-pipe"><code>join</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#subquery-filter">subquery filter</a></li>
</ul>
</div>`},{id:"uniq-pipe",value:"uniq",title:"uniq pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#uniq-pipe target="_blank" rel="noreferrer">uniq pipe</a></h5><p><code>&lt;q&gt; | uniq by (field1, ..., fieldN)</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> returns unique values for the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a>
over the logs returned by <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a>. For example, the following LogsQL query
returns unique values for <code>ip</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field</a>
over logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | uniq by (ip)
</code></pre>
<p>It is possible to specify multiple fields inside <code>by(...)</code> clause. In this case all the unique sets for the given fields
are returned. For example, the following query returns all the unique <code>(host, path)</code> pairs for the logs over the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | uniq by (host, path)
</code></pre>
<p>The unique entries are returned in arbitrary order. Use <a href="https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe"><code>sort</code> pipe</a> in order to sort them if needed.</p>
<p>Add <code>with hits</code> after <code>uniq by (...)</code> in order to return the number of matching logs for each field value:</p>
<pre><code class="language-logsql">_time:5m | uniq by (host) with hits
</code></pre>
<p>Unique entries are stored in memory during query execution. Big number of unique selected entries may require a lot of memory.
Sometimes it is enough to return up to <code>N</code> unique entries. This can be done by adding <code>limit N</code> after <code>by (...)</code> clause.
This allows limiting memory usage. For example, the following query returns up to 100 unique <code>(host, path)</code> pairs for the logs over the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | uniq by (host, path) limit 100
</code></pre>
<p>If the <code>limit</code> is reached, then arbitrary subset of unique values can be returned. If <code>with hits</code> is used, then all the returned <code>hits</code> are set to <code>0</code> when the <code>limit</code> is reached.</p>
<p>The <code>by</code> keyword can be skipped in <code>uniq ...</code> pipe. For example, the following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | uniq (host, path) limit 100
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#uniq_values-stats"><code>uniq_values</code> stats function</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#top-pipe"><code>top</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#stats-pipe"><code>stats</code> pipe</a></li>
</ul>
</div>`},{id:"unpack_json-pipe",value:"unpack_json",title:"unpack_json pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#unpack_json-pipe target="_blank" rel="noreferrer">unpack_json pipe</a></h5><p><code>&lt;q&gt; | unpack_json from field_name</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> unpacks <code>{&quot;k1&quot;:&quot;v1&quot;, ..., &quot;kN&quot;:&quot;vN&quot;}</code> JSON from the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>field_name</code></a>
of <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> results into <code>k1</code>, ... <code>kN</code> output field names with the corresponding <code>v1</code>, ..., <code>vN</code> values.
It overrides existing fields with names from the <code>k1</code>, ..., <code>kN</code> list. Other fields remain untouched.</p>
<p>Nested JSON is unpacked according to the rules defined <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">here</a>.
If values for some JSON keys must be preserved from flattening, then enumerate the needed keys in <code>preserve_keys (...)</code>.
For example, the following query flattens all the JSON fields except <code>foo</code> and <code>bar</code> from the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>
across logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | unpack_json from _msg preserve_keys (foo, bar)
</code></pre>
<p>The <code>from _msg</code> part can be omitted when JSON fields are unpacked from the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>:</p>
<pre><code class="language-logsql">_time:5m | unpack_json
</code></pre>
<p>If only some fields must be extracted from JSON, then they can be enumerated inside <code>fields (...)</code>. For example, the following query unpacks only <code>foo</code> and <code>bar</code>
fields from JSON value stored in <code>my_json</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field</a>:</p>
<pre><code class="language-logsql">_time:5m | unpack_json from my_json fields (foo, bar)
</code></pre>
<p>If it is needed to extract all the fields with some common prefix, then this can be done via <code>fields(prefix*)</code> syntax.</p>
<p>If it is needed to preserve the original non-empty field values, then add <code>keep_original_fields</code> to the end of <code>unpack_json ...</code>. For example,
the following query preserves the original non-empty values for <code>ip</code> and <code>host</code> fields instead of overwriting them with the unpacked values:</p>
<pre><code class="language-logsql">_time:5m | unpack_json from foo fields (ip, host) keep_original_fields
</code></pre>
<p>Add <code>skip_empty_results</code> to the end of <code>unpack_json ...</code> if the original field values must be preserved when the corresponding unpacked values are empty.
For example, the following query preserves the original <code>ip</code> and <code>host</code> field values for empty unpacked values:</p>
<pre><code class="language-logsql">_time:5m | unpack_json fields (ip, host) skip_empty_results
</code></pre>
<p>Performance tip: if you need to extract a single field from long JSON, it is faster to use the <a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a>. For example, the following query extracts the <code>&quot;ip&quot;</code> field from JSON
stored in <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a> faster than parsing the full JSON object:</p>
<pre><code>_time:5m | extract &#39;&quot;ip&quot;:&lt;ip&gt;&#39;
</code></pre>
<p>If you want to reduce the chance that the unpacked JSON fields clash with the existing fields, then specify common prefix for all the fields extracted from JSON,
by adding <code>result_prefix &quot;prefix_name&quot;</code> to <code>unpack_json</code>. For example, the following query adds the <code>foo_</code> prefix for all the unpacked fields
from <code>foo</code>:</p>
<pre><code class="language-logsql">_time:5m | unpack_json from foo result_prefix &quot;foo_&quot;
</code></pre>
<p>Performance tips:</p>
<ul>
<li><p>It is better from performance and resource usage PoV ingesting parsed JSON logs into VictoriaLogs
according to the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">supported data model</a>
instead of ingesting unparsed JSON lines into VictoriaLogs and then parsing them at query time with <a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_json-pipe"><code>unpack_json</code> pipe</a>.</p>
</li>
<li><p>It is recommended to use more specific <a href="https://docs.victoriametrics.com/victorialogs/logsql/#filters">log filters</a> in order to reduce the number of log entries that are passed to <code>unpack_json</code>.
See <a href="https://docs.victoriametrics.com/victorialogs/logsql/#performance-tips">general performance tips</a> for details.</p>
</li>
</ul>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#conditional-unpack_json">Conditional <code>unpack_json</code></a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_logfmt-pipe"><code>unpack_logfmt</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_syslog-pipe"><code>unpack_syslog</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#split-pipe"><code>split</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unroll-pipe"><code>unroll</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#pack_json-pipe"><code>pack_json</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#pack_logfmt-pipe"><code>pack_logfmt</code> pipe</a></li>
</ul>
</div>`},{id:"unpack_logfmt-pipe",value:"unpack_logfmt",title:"unpack_logfmt pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#unpack_logfmt-pipe target="_blank" rel="noreferrer">unpack_logfmt pipe</a></h5><p><code>&lt;q&gt; | unpack_logfmt from field_name</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> unpacks <code>k1=v1 ... kN=vN</code> <a href="https://brandur.org/logfmt">logfmt</a> fields
from the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>field_name</code></a> of <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> results into <code>k1</code>, ... <code>kN</code> field names
with the corresponding <code>v1</code>, ..., <code>vN</code> values. It overrides existing fields with names from the <code>k1</code>, ..., <code>kN</code> list. Other fields remain untouched.</p>
<p>For example, the following query unpacks <a href="https://brandur.org/logfmt">logfmt</a> fields from the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>
across logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | unpack_logfmt from _msg
</code></pre>
<p>The <code>from _msg</code> part can be omitted when <a href="https://brandur.org/logfmt">logfmt</a> fields are unpacked from the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>.
The following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | unpack_logfmt
</code></pre>
<p>If only some fields must be unpacked from logfmt, then they can be enumerated inside <code>fields (...)</code>. For example, the following query extracts only <code>foo</code> and <code>bar</code> fields
from logfmt stored in the <code>my_logfmt</code> field:</p>
<pre><code class="language-logsql">_time:5m | unpack_logfmt from my_logfmt fields (foo, bar)
</code></pre>
<p>If it is needed to extract all the fields with some common prefix, then this can be done via <code>fields(prefix*)</code> syntax.</p>
<p>If it is needed to preserve the original non-empty field values, then add <code>keep_original_fields</code> to the end of <code>unpack_logfmt ...</code>. For example,
the following query preserves the original non-empty values for <code>ip</code> and <code>host</code> fields instead of overwriting them with the unpacked values:</p>
<pre><code class="language-logsql">_time:5m | unpack_logfmt from foo fields (ip, host) keep_original_fields
</code></pre>
<p>Add <code>skip_empty_results</code> to the end of <code>unpack_logfmt ...</code> if the original field values must be preserved when the corresponding unpacked values are empty.
For example, the following query preserves the original <code>ip</code> and <code>host</code> field values for empty unpacked values:</p>
<pre><code class="language-logsql">_time:5m | unpack_logfmt fields (ip, host) skip_empty_results
</code></pre>
<p>Performance tip: if you need to extract a single field from a long <a href="https://brandur.org/logfmt">logfmt</a> line, it is faster to use the <a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a>.
For example, the following query extracts <code>&quot;ip&quot;</code> field from <a href="https://brandur.org/logfmt">logfmt</a> line stored
in <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>:</p>
<pre><code>_time:5m | extract &#39; ip=&lt;ip&gt;&#39;
</code></pre>
<p>If you want to make sure that the unpacked <a href="https://brandur.org/logfmt">logfmt</a> fields do not clash with the existing fields, then specify common prefix for all the fields extracted from logfmt,
by adding <code>result_prefix &quot;prefix_name&quot;</code> to <code>unpack_logfmt</code>. For example, the following query adds <code>foo_</code> prefix for all the unpacked fields
from <code>foo</code> field:</p>
<pre><code class="language-logsql">_time:5m | unpack_logfmt from foo result_prefix &quot;foo_&quot;
</code></pre>
<p>Performance tips:</p>
<ul>
<li><p>It is better from performance and resource usage PoV ingesting parsed <a href="https://brandur.org/logfmt">logfmt</a> logs into VictoriaLogs
according to the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">supported data model</a>
instead of ingesting unparsed logfmt lines into VictoriaLogs and then parsing them at query time with <a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_logfmt-pipe"><code>unpack_logfmt</code> pipe</a>.</p>
</li>
<li><p>It is recommended to use more specific <a href="https://docs.victoriametrics.com/victorialogs/logsql/#filters">log filters</a> in order to reduce the number of log entries that are passed to <code>unpack_logfmt</code>.
See <a href="https://docs.victoriametrics.com/victorialogs/logsql/#performance-tips">general performance tips</a> for details.</p>
</li>
</ul>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#conditional-unpack_logfmt">Conditional unpack_logfmt</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_json-pipe"><code>unpack_json</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_syslog-pipe"><code>unpack_syslog</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a></li>
</ul>
</div>`},{id:"unpack_syslog-pipe",value:"unpack_syslog",title:"unpack_syslog pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#unpack_syslog-pipe target="_blank" rel="noreferrer">unpack_syslog pipe</a></h5><p><code>&lt;q&gt; | unpack_syslog from field_name</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> unpacks <a href="https://en.wikipedia.org/wiki/Syslog">syslog</a> message
from the given <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model"><code>field_name</code></a> of <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> results.
It understands the following Syslog formats:</p>
<ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc3164">RFC3164</a> aka <code>&lt;PRI&gt;MMM DD hh:mm:ss HOSTNAME APP-NAME[PROCID]: MESSAGE</code></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc5424">RFC5424</a> aka <code>&lt;PRI&gt;1 TIMESTAMP HOSTNAME APP-NAME PROCID MSGID [STRUCTURED-DATA] MESSAGE</code></li>
</ul>
<p>The following fields are unpacked:</p>
<ul>
<li><code>level</code> - obtained from <code>PRI</code>.</li>
<li><code>priority</code> - obtained from <code>PRI</code>.</li>
<li><code>facility</code> - calculated as <code>PRI / 8</code>.</li>
<li><code>facility_keyword</code> - string representation of the <code>facility</code> field according to <a href="https://en.wikipedia.org/wiki/Syslog#Facility">these docs</a>.</li>
<li><code>severity</code> - calculated as <code>PRI % 8</code>.</li>
<li><code>format</code> - either <code>rfc3164</code> or <code>rfc5424</code> depending on which Syslog format is unpacked.</li>
<li><code>timestamp</code> - timestamp in <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO8601 format</a>. The <code>MMM DD hh:mm:ss</code> timestamp in <a href="https://datatracker.ietf.org/doc/html/rfc3164">RFC3164</a>
is automatically converted into <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO8601 format</a> by assuming the current year and adjusting the year to the previous one if the parsed timestamp
would be more than a day in the future.</li>
<li><code>hostname</code></li>
<li><code>app_name</code></li>
<li><code>proc_id</code></li>
<li><code>msg_id</code></li>
<li><code>message</code></li>
</ul>
<p>The <code>&lt;PRI&gt;</code> part is optional. If it is missing, then <code>level</code>, <code>priority</code>, <code>facility</code>, <code>facility_keyword</code> and <code>severity</code> fields aren&#39;t set.</p>
<p>The <code>[STRUCTURED-DATA]</code> is parsed into fields with the <code>SD-ID.param1</code>, <code>SD-ID.param2</code>, ..., <code>SD-ID.paramN</code> names and the corresponding values
according to <a href="https://datatracker.ietf.org/doc/html/rfc5424#section-6.3">the specification</a>.</p>
<p>If the <code>app_name</code> equals <code>CEF</code> and the <code>message</code> contains Common Event Format data for SIEM
aka <a href="https://www.microfocus.com/documentation/arcsight/arcsight-smartconnectors-8.3/cef-implementation-standard/Content/CEF/Chapter%201%20What%20is%20CEF.htm">CEF for Syslog</a>,
then it is automatically parsed into the following fields:</p>
<ul>
<li><code>cef.version</code> - the CEF version</li>
<li><code>cef.device_vendor</code> - the device vendor field</li>
<li><code>cef.device_product</code> - the device product field</li>
<li><code>cef.device_version</code> - the device version field</li>
<li><code>cef.device_event_class_id</code> - the device event class id</li>
<li><code>cef.name</code> - the CEF name</li>
<li><code>cef.severity</code> - the severity field</li>
</ul>
<p>Optional extension fields are parsed into <code>cef.extension.&lt;key&gt;</code> fields with the corresponding values.</p>
<p>For example, the following query unpacks <a href="https://en.wikipedia.org/wiki/Syslog">syslog</a> message from the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>
across logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | unpack_syslog from _msg
</code></pre>
<p>The <code>from _msg</code> part can be omitted when <a href="https://en.wikipedia.org/wiki/Syslog">syslog</a> message is unpacked
from the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field"><code>_msg</code> field</a>.
The following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | unpack_syslog
</code></pre>
<p>By default timestamps in <a href="https://datatracker.ietf.org/doc/html/rfc3164">RFC3164 format</a> are interpreted in the local timezone. It is possible to change the timezone
offset via <code>offset</code> option. For example, the following query interprets <code>rfc3164</code> timestamps as if they were generated in the <code>+05:30</code> timezone:</p>
<pre><code class="language-logsql">_time:5m | unpack_syslog offset 5h30m
</code></pre>
<p>If it is needed to preserve the original non-empty field values, then add <code>keep_original_fields</code> to the end of <code>unpack_syslog ...</code>:</p>
<pre><code class="language-logsql">_time:5m | unpack_syslog keep_original_fields
</code></pre>
<p>If you want to reduce the chance that the unpacked <a href="https://en.wikipedia.org/wiki/Syslog">syslog</a> fields clash with the existing fields,
then specify common prefix for all the fields extracted from syslog, by adding <code>result_prefix &quot;prefix_name&quot;</code> to <code>unpack_syslog</code>.
For example, the following query adds <code>foo_</code> prefix for all the unpacked fields from <code>foo</code> field:</p>
<pre><code class="language-logsql">_time:5m | unpack_syslog from foo result_prefix &quot;foo_&quot;
</code></pre>
<p>Performance tips:</p>
<ul>
<li><p>It is better from performance and resource usage PoV ingesting parsed <a href="https://en.wikipedia.org/wiki/Syslog">syslog</a> messages into VictoriaLogs
according to the <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">supported data model</a>
instead of ingesting unparsed syslog lines into VictoriaLogs and then parsing them at query time with <a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_syslog-pipe"><code>unpack_syslog</code> pipe</a>.</p>
</li>
<li><p>It is recommended to use more specific <a href="https://docs.victoriametrics.com/victorialogs/logsql/#filters">log filters</a> in order to reduce the number of log entries that are passed to <code>unpack_syslog</code>.
See <a href="https://docs.victoriametrics.com/victorialogs/logsql/#performance-tips">general performance tips</a> for details.</p>
</li>
</ul>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#conditional-unpack_syslog">Conditional unpack_syslog</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_json-pipe"><code>unpack_json</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_logfmt-pipe"><code>unpack_logfmt</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a></li>
</ul>
</div>`},{id:"unpack_words-pipe",value:"unpack_words",title:"unpack_words pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#unpack_words-pipe target="_blank" rel="noreferrer">unpack_words pipe</a></h5><p>The <code>&lt;q&gt; | unpack_words from &lt;src_field&gt; as &lt;dst_field&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> unpacks <a href="https://docs.victoriametrics.com/victorialogs/logsql/#word">words</a> from the given
<code>&lt;src_field&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log field</a>
of <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> results into <code>&lt;dst_field&gt;</code> as a JSON array.</p>
<p>For example, the following query unpacks words from <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field">log messages</a> into <code>words</code> field:</p>
<pre><code class="language-logsql">_time:5m | unpack_words from _msg as words
</code></pre>
<p>The <code>as &lt;dst_field&gt;</code> part is optional. If it is missing, then the result is stored in the <code>&lt;src_field&gt;</code> specified in <code>from &lt;src_field&gt;</code>.
For example, the following query stores the unpacked words into <code>_msg</code> field:</p>
<pre><code class="language-logsql">_time:5m | unpack_words from _msg
</code></pre>
<p>The <code>from &lt;src_field&gt;</code> part is optional. If it is missing, then words are unpacked from the <code>_msg</code> field. The following query is equivalent to the previous one:</p>
<pre><code class="language-logsql">_time:5m | unpack_words
</code></pre>
<p>By default <code>unpack_words</code> pipe unpacks all the words, including duplicates, from the <code>&lt;src_field&gt;</code>. It is possible to drop duplicate words by adding <code>drop_duplicates</code> suffix to the pipe.
For example, the following query extracts only unique words from every <code>text</code> field:</p>
<pre><code class="language-logsql">_time:5m | unpack_words from text as words drop_duplicates
</code></pre>
<p>It is convenient to use <a href="https://docs.victoriametrics.com/victorialogs/logsql/#unroll-pipe"><code>unroll</code> pipe</a> for unrolling the JSON array with unpacked words from the destination field.
For example, the following query returns top 5 most frequently seen words across <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#message-field">log messages</a> for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | unpack_words as words | unroll words | top 5 (words)
</code></pre>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unroll-pipe"><code>unroll</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#split-pipe"><code>split</code> pipe</a></li>
</ul>
</div>`},{id:"unroll-pipe",value:"unroll",title:"unroll pipe",description:`<div class='vm-markdown'><h5><a href=https://docs.victoriametrics.com/victorialogs/logsql/#unroll-pipe target="_blank" rel="noreferrer">unroll pipe</a></h5><p><code>&lt;q&gt; | unroll [by] (field1, ..., fieldN)</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#pipes">pipe</a> can be used for unrolling JSON arrays from <code>field1</code>, ..., <code>fieldN</code>
<a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> of <code>&lt;q&gt;</code> <a href="https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax">query</a> results into separate rows.</p>
<p>For example, the following query unrolls <code>timestamp</code> and <code>value</code> <a href="https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model">log fields</a> from logs for the last 5 minutes:</p>
<pre><code class="language-logsql">_time:5m | unroll (timestamp, value)
</code></pre>
<p>The <code>by</code> keyword can be skipped in <code>unroll ...</code> pipe.
If multiple fields are unrolled, then the longest JSON array among the fields defines the number of returned rows,
while missing items for shorter arrays are substituted with empty strings.</p>
<p>If the unrolled JSON array contains JSON objects, then it may be handy to use <a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_json-pipe"><code>unpack_json</code></a> for unpacking
the unrolled array items into separate fields for further processing.</p>
<p>See also:</p>
<ul>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_json-pipe"><code>unpack_json</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#unpack_words-pipe"><code>unpack_words</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe"><code>extract</code> pipe</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#uniq_values-stats"><code>uniq_values</code> stats function</a></li>
<li><a href="https://docs.victoriametrics.com/victorialogs/logsql/#values-stats"><code>values</code> stats function</a></li>
</ul>
</div>`}],Eo=Dn.map(t=>({...t,type:J.PipeName,icon:e($t,{})})),zn=["AND","OR","NOT"],Hn=Eo.map(t=>t.value),sr=["'",'"',"`"],rr=["(","[","{"],Vn=[")","]","}"],Bn=[...rr,...Vn],$n=t=>{const o=t,{isBalancedQuotes:i,unclosedQuoteIndex:s}=Kn(o),r=[];let a="",c="",l=!1,n=!1,m="",d=0,u=0;for(let p=0;p<o.length;p++){const h=o[p];if(!i&&p>=s&&(n=!1),sr.includes(h)&&!nr(o,p)&&(n?h===m&&(n=!1,m=""):(n=!0,m=h)),!n&&Bn.includes(h)){const g=rr.includes(h)?1:-1;d=Math.max(0,d+g)}if(!n&&d===0&&h==="|"){const g=a.match(/^ */)?.[0].length||0,f=a.match(/ *$/)?.[0].length||0;go(a,l,[u+g,p-f-1],r,c),a="",c="|",l=!0,u=p+1;continue}if(!l&&!n&&!d&&h===" "){const g=o.slice(p).replace(/^\s*/,""),f=o.slice(0,p).replace(/\s*$/,"");if(!g.startsWith(":")&&!f.endsWith(":")){go(a+h,!1,[u,p],r,c),a="",u=p+1;continue}}a+=h}return go(a,l,[u,o.length],r,c),r},go=(t,o,i,s,r)=>{if(!t.trim().length)return;const a=zn.includes(t.toUpperCase()),c=[Se.Pipe,Se.FilterOrPipe],l=s.length>0&&c.includes(s[s.length-1].type),n=/(?:\r?\n[ \t]*)+$/,m=t.match(n)?.[0]??"",d=m.length>0,u=()=>l?Se.FilterOrPipe:o?Se.Pipe:a?Se.Operator:Se.Filter;s.push({id:s.length,value:t.replace(n,""),position:i,type:u(),separator:r}),d&&s.push({id:s.length,value:m,position:i,type:Se.LineBreak,separator:""})},Un=(t,o)=>{const i=t.value.substring(0,o),s=t.value.substring(o),r={valueBeforeCursor:i,valueAfterCursor:s,valueContext:t.value,contextType:J.Unknown};return Yn(t,i,s,r),r.valueContext=r.valueContext.replace(/^["']|["']$/g,""),r},ar=t=>Hn.some(o=>t.startsWith(o)),jn=(t,o)=>!t.includes(":")&&!o.includes(":"),cr=(t,o)=>{const[i,...s]=t.split(":");o.contextType=J.FilterValue,o.filterName=i;const a=["=","-","!"].find(c=>c===s[0]);a?(o.valueContext=s.slice(1).join(":"),o.operator=`:${a}`):(o.valueContext=s.join(":"),o.operator=":")},Yn=(t,o,i,s)=>{switch(t.type){case Se.Filter:Qn(o,i,s);break;case Se.Pipe:s.contextType=ar(t.value)?J.PipeValue:J.PipeName;break;case Se.FilterOrPipe:Gn(t.value,o,s);break}},Qn=(t,o,i)=>{jn(t,o)?i.contextType=J.FilterUnknown:t.includes(":")?cr(t,i):i.contextType=J.FilterName},Gn=(t,o,i)=>{ar(t)?i.contextType=J.PipeValue:o.includes(":")?cr(o,i):i.contextType=J.FilterOrPipeName},nr=(t,o)=>{let i=0;for(let s=o-1;s>=0&&t[s]==="\\";s--)i++;return i%2===1},Kn=t=>{let o=null,i=null;for(let s=0;s<t.length;s++){const r=t[s];if(sr.includes(r)&&!nr(t,s)){if(o===null){o=r,i=s;continue}r===o&&(o=null,i=null)}}return{isBalancedQuotes:o===null,unclosedQuoteIndex:i}},Wn={[J.FilterName]:e(Co,{}),[J.FilterUnknown]:e(Co,{}),[J.FilterValue]:e(Ao,{}),[J.PipeName]:e($t,{}),[J.PipeValue]:e(Ms,{}),[J.Unknown]:e(Ao,{}),[J.FilterOrPipeName]:e($t,{})},Zn=t=>{const{serverUrl:o}=se(),{period:{start:i,end:s}}=ce(),{autocompleteCache:r}=Wo(),a=bs(),c=Je(),[l,n]=S(!1),[m,d]=S([]),[u,p]=S([]),h=D(new AbortController),g=M(y=>{const b=O(i*1e3).startOf("day").valueOf()/1e3,v=O(s*1e3).endOf("day").valueOf()/1e3;return new URLSearchParams({...y||{},limit:`${yt.queryLimit}`,start:`${b}`,end:`${v}`})},[i,s]),f=(y,b)=>y.map(v=>({value:v.value,type:`${b}`,icon:Wn[b]})),_=async({urlSuffix:y,setter:b,params:v})=>{h.current.abort(),h.current=new AbortController;const{signal:k}=h.current,w=new URLSearchParams(c).toString(),x=`${y}?${v?.toString()}&${w}`;n(!0);try{const q=r.get(x);if(q){b(q),n(!1);return}const N=await fetch(`${o}/select/logsql/${y}`,{signal:k,method:"POST",headers:{...c},body:v});if(N.ok){const C=(await N.json())?.values||[];b(C||[]),a({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:x,value:C}})}n(!1)}catch(q){q instanceof Error&&q.name!=="AbortError"&&(a({type:"SET_AUTOCOMPLETE_CACHE",payload:{key:x,value:[]}}),n(!1),console.error(q))}};return A(()=>{const b=![J.FilterName,J.FilterUnknown,J.FilterOrPipeName].includes(t?.contextType||J.Unknown);return!o||b?void 0:(d([]),_({urlSuffix:"field_names",setter:k=>{d(f(k,J.FilterName))},params:g({query:t?.queryBeforeIncompleteFilter||"*"})}),()=>h.current?.abort())},[o,t]),A(()=>{const y=t?.contextType!==J.FilterValue;return!o||y||!t?.filterName?void 0:(p([]),_({urlSuffix:"field_values",setter:v=>{p(f(v,J.FilterValue))},params:g({query:Pn(t),field:t.filterName})}),()=>h.current?.abort())},[o,t]),{fieldNames:m,fieldValues:u,loading:l}},Jn=({value:t,anchorEl:o,caretPosition:i,hasHelperText:s,onSelect:r,onFoundOptions:a,isOpen:c})=>{const[l,n]=S({top:0,left:0}),m=F(()=>{if(i[0]!==i[1])return{valueBeforeCursor:t,valueAfterCursor:""};const v=t.substring(0,i[0]),k=t.substring(i[1]);return{valueBeforeCursor:v,valueAfterCursor:k}},[t,i]),d=F(()=>$n(t),[t]),u=F(()=>{if(i[0]!==i[1])return;const v=d.find(q=>i[0]>=q.position[0]&&i[0]<=q.position[1]);if(!v)return;const k=i[0]-v.position[0],w=d.find(q=>q.id===v.id-1),x=w?t.substring(0,w.position[1]+1):void 0;return{...v,queryBeforeIncompleteFilter:x,query:t,...Un(v,k)}},[d,i,t]),{fieldNames:p,fieldValues:h,loading:g}=Zn(u),f=F(()=>{switch(u?.contextType){case J.FilterName:case J.FilterUnknown:return p;case J.FilterValue:return h;case J.PipeName:return Eo;case J.FilterOrPipeName:return[...p,...Eo];default:return[]}},[u,p,h]),_=(v,k,w)=>k.reduce((x,q)=>{const N=q.id===w?v:q.value;return`${x}${q.separator}${N}`},"").trim(),y=(v,k,w="",x)=>{let q=v;if(x===J.FilterName)q+=":";else if(k===J.FilterValue){const C=w.startsWith("_stream:")?q:`${JSON.stringify(q)}`;q=`${u?.filterName||""}${u?.operator||":"}${C}`}const N=w.match(/^[ \t]+/)?.[0]??"",T=w.match(/[ \t]+$/)?.[0]??"";return`${N}${q}${T}`},b=M((v,k)=>{const{id:w,contextType:x=J.FilterUnknown,value:q="",position:N=[0,0]}=u||{},T=y(v,x,q,k.type),C=_(T,d,w),L=(N[0]||1)+T.trim().length;r(C,L)},[u,d]);if(A(()=>{if(!o.current){n({top:0,left:0});return}const v=o.current.querySelector("textarea")||o.current,k=window.getComputedStyle(v),w=`${k.getPropertyValue("font-size")}`,x=`${k.getPropertyValue("font-family")}`,q=parseInt(`${k.getPropertyValue("line-height")}`),N=document.createElement("div");N.style.font=`${w} ${x}`,N.style.padding=k.getPropertyValue("padding"),N.style.lineHeight=`${q}px`,N.style.width=`${v.offsetWidth}px`,N.style.maxWidth=`${v.offsetWidth}px`,N.style.whiteSpace=k.getPropertyValue("white-space"),N.style.overflowWrap=k.getPropertyValue("overflow-wrap");const T=document.createElement("span");N.appendChild(document.createTextNode(m.valueBeforeCursor||"")),N.appendChild(T),N.appendChild(document.createTextNode(m.valueAfterCursor||"")),document.body.appendChild(N);const C=N.getBoundingClientRect(),L=T.getBoundingClientRect(),E=L.left-C.left,z=L.bottom-C.bottom-(s?q:0);n({top:z,left:E}),N.remove(),T.remove()},[o,i,s,m]),!!c)return e(V,{children:e(Js,{loading:g,disabledFullScreen:!0,value:u?.valueContext||"",options:f,anchor:o,minLength:0,offset:l,onSelect:b,onFoundOptions:a,maxDisplayResults:{limit:yt.displayResults,message:"Please, specify the query more precisely."}})})},Xn=({query:t,favorites:o,onRun:i,onToggleFavorite:s})=>{const r=ve(),a=F(()=>o.includes(t),[t,o]);return e("div",{className:"vm-query-history-item",children:[e("span",{className:"vm-query-history-item__value",children:t}),e("div",{className:"vm-query-history-item__buttons",children:[e(Q,{title:"Execute query",children:e(R,{size:"small",variant:"text",onClick:()=>{i(t)},startIcon:e(ti,{})})}),e(Q,{title:"Copy query",children:e(R,{size:"small",variant:"text",onClick:async()=>{await r(t,"Query has been copied")},startIcon:e(we,{})})}),e(Q,{title:a?"Remove Favorite":"Add to Favorites",children:e(R,{size:"small",variant:"text",color:a?"warning":"primary",onClick:()=>{s(t,a)},startIcon:a?e(Is,{}):e(Es,{})})})]})]})},je={session:"session",storage:"saved",favorite:"favorite"},Vi=[{label:"Session history",value:je.session},{label:"Saved history",value:je.storage},{label:"Favorite queries",value:je.favorite}],el=({handleSelectQuery:t,historyKey:o})=>{const{queryHistory:i}=Nt(),{isMobile:s}=G(),{value:r,setTrue:a,setFalse:c}=ee(),[l,n]=S(Vi[0].value),[m,d]=S(ut(o,"QUERY_HISTORY")),[u,p]=S(ut(o,"QUERY_FAVORITES")),h=F(()=>i.map(w=>w.values.filter(x=>x).reverse()),[i]),g=F(()=>{switch(l){case je.favorite:return u;case je.storage:return m;default:return h}},[l,u,m,h]),f=g?.every(w=>!w.length),_=F(()=>l===je.favorite?`Favorites queries are empty.
To see your favorites, mark a query as a favorite.`:`Query history is empty.
To see the history, please make a query.`,[l]),y=w=>x=>{t(x,w),c()},b=(w,x)=>{p(q=>{const N=q[0]||[];return x?[N.filter(T=>T!==w)]:!x&&!N.includes(w)?[[...N,w]]:q})},v=()=>{d(ut(o,"QUERY_HISTORY")),p(ut(o,"QUERY_FAVORITES"))},k=()=>{Ta(o,"QUERY_HISTORY")};return A(()=>{const w=u[0]||[],x=ut(o,"QUERY_FAVORITES")[0]||[];Us(w,x)||Aa(o,u)},[u]),ie("storage",v),e(V,{children:[e(R,{color:"primary",variant:"outlined",onClick:a,startIcon:e(Vt,{}),ariaLabel:"Query history",children:!s&&"Query history"}),r&&e(ke,{title:"Query history",onClose:c,children:e("div",{className:I({"vm-query-history":!0,"vm-query-history_mobile":s}),children:[e("div",{className:I({"vm-query-history__tabs":!0,"vm-section-header__tabs":!0,"vm-query-history__tabs_mobile":s}),children:e(ni,{activeItem:l,items:Vi,onChange:n})}),e("div",{className:"vm-query-history-list",children:[f&&e("div",{className:"vm-query-history-list__no-data",children:_}),g.map((w,x)=>e("div",{children:[g.length>1&&e("div",{className:I({"vm-query-history-list__group-title":!0,"vm-query-history-list__group-title_first":x===0}),children:["Query ",x+1]}),w.map((q,N)=>e(Xn,{query:q,favorites:u.flat(),onRun:y(x),onToggleFavorite:b},N))]},x)),l===je.storage&&!f&&e("div",{className:"vm-query-history-footer",children:e(R,{color:"error",variant:"outlined",size:"small",startIcon:e(St,{}),onClick:k,children:"clear history"})})]})]})})]})},tl=()=>{const t=Go(),o=M(s=>{t({type:"SET_AUTOCOMPLETE_QUICK",payload:s})},[t]);return ie("keydown",s=>{const{code:r,ctrlKey:a,altKey:c}=s;r==="Space"&&(a||c)&&(s.preventDefault(),o(!0))}),o},tt=e("code",{children:He}),lr=e(V,{children:[e("code",{children:Ho()?mt:"Ctrl"})," + ",e("code",{children:"Space"})]}),ol=[{title:"Query",list:[{keys:e("code",{children:"Enter"}),description:"Run"},{keys:e(V,{children:[e("code",{children:"Shift"})," + ",e("code",{children:"Enter"})]}),description:"Multi-line queries"},{keys:e(V,{children:[tt," + ",e("code",{children:"Arrow Up"})]}),description:"Previous command from the Query history"},{keys:e(V,{children:[tt," + ",e("code",{children:"Arrow Down"})]}),description:"Next command from the Query history"},{keys:lr,description:"Show quick autocomplete tips"}]},{title:"Graph",list:[{keys:e(V,{children:[tt," + ",e("code",{children:"scroll Up"})," or ",e("code",{children:"+"})]}),description:"Zoom in"},{keys:e(V,{children:[tt," + ",e("code",{children:"scroll Down"})," or ",e("code",{children:"-"})]}),description:"Zoom out"},{keys:e(V,{children:[tt," + ",e("code",{children:"drag"})]}),description:"Move the graph left/right"},{keys:e(V,{children:[e("code",{children:"click"})," on legend item"]}),description:"Open the legend item menu"},{keys:e(V,{children:[e("code",{children:mt})," + ",e("code",{children:"click"})," on legend item"]}),description:"Hide or show this series"},{keys:e(V,{children:[tt," + ",e("code",{children:"click"})," on legend item"]}),description:"Show only this series or show all series"}]}],il=({query:t,queryDurationMs:o,limit:i,error:s,isLoading:r,onChange:a,onChangeLimit:c,onRun:l})=>{const{isMobile:n}=G(),{autocomplete:m,queryHistory:d,autocompleteQuick:u}=Nt(),p=Go(),h=tl(),{value:g,setValue:f}=ee(),_=()=>{p({type:"TOGGLE_AUTOCOMPLETE"})},y=w=>{const{values:x,index:q}=d[0],N=q+w;N<0||N>=x.length||(a(x[N]||""),p({type:"SET_QUERY_HISTORY_BY_INDEX",payload:{value:{values:x,index:N},queryNumber:0}}))},b=w=>{a(w),f(!0)},v=w=>()=>{y(w)};A(()=>{g&&(l(),f(!1))},[t,g]);const k=w=>{a(w),u&&h(!1)};return e("div",{className:I({"vm-query-page-header":!0,"vm-block":!0,"vm-block_mobile":n}),children:[e("div",{className:"vm-query-page-header-top",children:[e(Rn,{value:t,autocomplete:m||u,autocompleteEl:Jn,onArrowUp:v(-1),onArrowDown:v(1),onEnter:l,onChange:k,label:"Log query",error:s,stats:{executionTimeMsec:o}}),e(ir,{limit:i,onChangeLimit:c,onPressEnter:l})]}),e("div",{className:"vm-query-page-header-bottom",children:[e("div",{className:"vm-query-page-header-bottom-contols",children:e(Q,{title:e(V,{children:["Quick tip: ",lr]}),children:e(ue,{label:"Autocomplete",value:m,onChange:_})})}),!n&&e("div",{className:"vm-query-page-header-bottom-helpful",children:[e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/victorialogs/logsql/",rel:"help noreferrer",children:[e(Kt,{}),"Query language docs"]}),e("a",{className:"vm-link vm-link_with-icon",target:"_blank",href:"https://docs.victoriametrics.com/victorialogs/",rel:"help noreferrer",children:[e(ii,{}),"Documentation"]})]}),e("div",{className:"vm-query-page-header-bottom-buttons",children:[e(el,{handleSelectQuery:b,historyKey:"LOGS_QUERY_HISTORY"}),e("div",{className:"vm-query-page-header-bottom-execute",children:e(R,{startIcon:r?e(eo,{}):e(ei,{}),onClick:l,fullWidth:!0,children:e("div",{children:[e("span",{className:"vm-query-page-header-bottom-execute__text",children:r?"Cancel Query":"Execute Query"}),e("span",{className:"vm-query-page-header-bottom-execute__text_hidden",children:"Execute Query"})]})})})]})]})]})},sl="Shortcut keys",rl="F1",dr=({children:t,withHotkey:o=!0})=>{const{value:i,setTrue:s,setFalse:r}=ee(),a=M(c=>{if(!o)return;c.key==="F1"&&s()},[s,o]);return ie("keydown",a),e(V,{children:[e(Q,{title:`${sl} (${rl})`,placement:"bottom-center",children:e("div",{onClick:s,children:t})}),i&&e(ke,{title:"Shortcut keys",onClose:r,children:e("div",{className:"vm-shortcuts",children:ol.map(c=>e("div",{className:"vm-shortcuts-section",children:[e("h3",{className:"vm-shortcuts-section__title",children:c.title}),e("div",{className:"vm-shortcuts-section-list",children:c.list.map((l,n)=>e("div",{className:"vm-shortcuts-section-list-item",children:[e("div",{className:"vm-shortcuts-section-list-item__key",children:l.keys}),e("p",{className:"vm-shortcuts-section-list-item__description",children:l.description})]},`${c.title}_${n}`))})]},c.title))})})]})},Et=()=>{const[t,o]=te(),i=F(()=>{const m=Number(t.get("top_hits"));return Number.isFinite(m)&&m>0?m:vt},[t]),s=F(()=>{const m=Number(t.get("bars_count"));return Number.isFinite(m)&&m>0?m:ea},[t]),r=t.get("group_hits")||Ce,a=M((m,d)=>{o(u=>{const p=new URLSearchParams(u),h=u.get(m);return d&&d!==h?p.set(m,String(d)):p.delete(m),p})},[o]),c=M(m=>{a("top_hits",m)},[a]),l=M(m=>{a("group_hits",m)},[a]),n=M(m=>{a("bars_count",m)},[a]);return{topHits:{value:i,set:c},groupFieldHits:{value:r,set:l},barsCount:{value:s,set:n}}};var Z=(t=>(t.Equals="=",t.NotEquals="!=",t.Regex="~",t.NotRegex="!~",t))(Z||{});const mr=t=>JSON.stringify(t).slice(1,-1),al=["eq","neq","regex","nregex"],cl=t=>typeof t=="string"&&al.includes(t),nl={eq:Z.Equals,neq:Z.NotEquals,regex:Z.Regex,nregex:Z.NotRegex},ll={[Z.Equals]:"eq",[Z.NotEquals]:"neq",[Z.Regex]:"regex",[Z.NotRegex]:"nregex"},dl=t=>t.replace(/"/g,'\\"'),jt=t=>{const{field:o,operator:i,value:s}=t,r=o==="_stream",a=s==='""',c=s==="*",n=!r&&!c&&!a?`"${dl(s)}"`:s;switch(i){case Z.Equals:case Z.NotEquals:{const m=c||r?`${o}:${n}`:`${o}:=${n}`;return i===Z.NotEquals?`(NOT ${m})`:m}case Z.Regex:case Z.NotRegex:{const m=`${o}:~${n}`;return i===Z.NotRegex?`(NOT ${m})`:m}default:return""}},Oe=()=>{const[t,o]=te(),i=F(()=>t.getAll("filter").flatMap((d,u)=>{try{const p=JSON.parse(d);if(!p||typeof p!="object")return[];const{f:h,o:g,v:f}=p;return typeof h!="string"||typeof f!="string"||!cl(g)?[]:[{id:u,field:h,operator:nl[g],value:f}]}catch{return[]}}),[t]),s=F(()=>{const d=new URLSearchParams;return js(i,["field","operator"]).forEach(({values:u})=>{const{field:p,operator:h,value:g}=u[0];if(!p||!u.length||!h)return;const f=p==="_stream"?"extra_stream_filters":"extra_filters";if(u.length===1)d.append(f,jt({field:p,operator:h,value:g}));else{const _=u.map(b=>`"${mr(b.value)}"`),y=`${p}:in(
${_.join(`,
`)}
)`;d.append(f,h===Z.NotEquals?`(NOT ${y})`:y)}}),d},[i]),r=M(d=>{const u=new URLSearchParams(t);u.delete("filter");for(const p of d)u.append("filter",JSON.stringify({f:p.field,o:ll[p.operator],v:p.value}));o(u,{replace:!0})},[t,o]),a=M(d=>{r([...i,d])},[i,r]),c=M((d,u)=>{const p=[...i];p[u]=d,r(p)},[i,r]),l=M(d=>{const u=new Map;for(const h of i)u.set(`${h.field}\0${h.value}`,h);for(const h of d)u.set(`${h.field}\0${h.value}`,h);const p=Array.from(u.values());r(p)},[i,r]),n=M(d=>{const u=i.filter((p,h)=>h!==d);r(u)},[i,r]),m=M(()=>r([]),[r]);return{extraFilters:i,extraParams:s,addNewFilter:a,updateFilter:c,upsertFilters:l,removeFilter:n,clearFilters:m}},ml=["_msg","_time"],pl=["_stream","_stream_id"],pr=()=>{const{serverUrl:t}=se(),{fieldNames:o,fieldNamesParamsKey:i}=lt(),s=Jo(),r=Je(),[a,c]=S([]),[l,n]=S(!1),[m,d]=S(""),u=(h,g)=>{const f=g?h:h.filter(_=>!ml.concat(pl).includes(_.value));c(f)},p=M(async h=>{n(!0),d("");try{const g=new URLSearchParams({start:h.start.toString(),end:h.end.toString(),query:h.query||"*"}),f=new URLSearchParams([...g,...h.extraParams??[]]),_={...r},b=f.toString()+JSON.stringify(r);if(i===b){u(o,h.showAllFields),n(!1);return}const v=`${t}/select/logsql/field_names`,k=await fetch(v,{method:"POST",headers:_,body:f});if(!k.ok){const x=await k.text(),q=`${k.status} ${k.statusText}: ${x}`;console.error(q),d(q);return}const w=await k.json();u(w.values,h.showAllFields),s({type:"SET_FIELD_NAMES",payload:{rows:w.values,key:b}})}catch(g){console.error(g),d(g)}finally{n(!1)}},[t,r,o,i]);return{fieldNames:a,loading:l,error:m,fetchFieldNames:p}},ul=({query:t,isHitsMode:o,isOverview:i,onChange:s})=>{const{isMobile:r}=G(),{value:a,toggle:c,setFalse:l}=ee(),[n,m]=te(),{topHits:d,groupFieldHits:u,barsCount:p}=Et(),{extraParams:h}=Oe(),{period:{start:g,end:f}}=ce(),{fetchFieldNames:_,fieldNames:y,loading:b,error:v}=pr(),[k,w]=de(me.hits,"graph_mode"),x=k===me.stats,[q,N]=de(!1,"stacked"),[T,C]=de(!1,"cumulative"),[L,E]=de(!1,"hide_chart"),z=F(()=>({graphStyle:Ue.BAR,queryMode:k,stacked:q,cumulative:T,fill:!0,hideChart:L}),[q,T,L,k]),U=F(()=>y.map(j=>j.value).sort((j,X)=>j.localeCompare(X)),[y]),Y=M(()=>{_({start:g,end:f,extraParams:h,showAllFields:!0,query:t})},[g,f,h.toString(),_,t]),W=M((j,X,le)=>{const re=new URLSearchParams(n);X?re.set(j,le??String(X)):re.delete(j),m(re)},[n,m]),K=M(j=>{const X=j?me.stats:me.hits;w(X),W("graph_mode",j,X)},[w,W]),H=M(j=>{N(j),W("stacked",j)},[N,W]),P=M(j=>{C(j),W("cumulative",j)},[C,W]),B=M(()=>{E(j=>{const X=!j;return W("hide_chart",X),X})},[E,W]);A(()=>{s(z)},[z]);const $=()=>e(V,{children:[e("div",{className:"vm-bar-hits-options vm-bar-hits-options_selections",children:[e("div",{className:"vm-bar-hits-options-item",children:e(ye,{label:"Top hits",options:[5,10,25,50],limit:d.value,onChange:d.set})}),e("div",{className:"vm-bar-hits-options-item",children:e(ye,{label:"Bars",options:ta,limit:p.value,onChange:p.set})}),o&&e(V,{children:e("div",{className:"vm-bar-hits-options-item",children:e(ye,{searchable:!0,label:"Group by",limit:u.value,options:U,textNoOptions:"No fields found",isLoading:b,error:v?String(v):"",onOpenSelect:Y,onChange:u.set})})})]}),e("div",{className:"vm-bar-hits-options-item",children:e(ue,{label:"Cumulative",value:T,onChange:P})}),!i&&e("div",{className:"vm-bar-hits-options-item",children:e(ue,{label:"Stats view",value:x,onChange:K})}),e("div",{className:"vm-bar-hits-options-item",children:e(ue,{label:"Stacked",value:q,onChange:H})})]});return e("div",{className:I({"vm-bar-hits-options":!0,"vm-bar-hits-options_mobile":r}),children:[!r&&e(V,{children:[e($,{}),e(dr,{withHotkey:!1,children:e(R,{variant:"text",color:"gray",startIcon:e(Ls,{})})})]}),e(Q,{title:L?"Show chart and resume hits updates":"Hide chart and pause hits updates",children:e(R,{variant:"text",color:"primary",startIcon:L?e(Zt,{}):e(rt,{}),onClick:B,ariaLabel:"settings"})}),r&&e(V,{children:[e(R,{variant:"text",color:"primary",startIcon:e(Xt,{}),onClick:c,ariaLabel:"settings"}),e(ke,{title:"Hits Options",onClose:l,isOpen:a,className:I({"vm-header-controls-modal":!0,"vm-header-controls-modal_open":a}),children:e("div",{className:"vm-bar-hits-options vm-bar-hits-options_mobile",children:e($,{})})})]})]})},hl=()=>{const[t,o]=S(null),[i,s]=S({width:0,height:0}),r=M(()=>{s({width:t?.offsetWidth||0,height:t?.offsetHeight||0})},[t?.offsetHeight,t?.offsetWidth]);return ie("resize",r),A(r,[t?.offsetHeight,t?.offsetWidth]),[o,i]},gl=({period:t,setPeriod:o})=>{const[i,s]=S({min:t.start,max:t.end}),r=({min:a,max:c})=>{const l=(c-a)*1e3;l<bi.min||l>bi.max||o({from:O(a*1e3).toDate(),to:O(c*1e3).toDate()})};return A(()=>{s({min:t.start,max:t.end})},[t]),{xRange:i,setPlotScale:r}},fl=t=>t instanceof MouseEvent,Bi=t=>fl(t)?t.clientX:t.touches[0].clientX,vl=({dragSpeed:t=.85,setPanning:o,setPlotScale:i})=>{const s=D({leftStart:0,xUnitsPerPx:0,scXMin:0,scXMax:0}),r=l=>{l.preventDefault();const n=Bi(l),{leftStart:m,xUnitsPerPx:d,scXMin:u,scXMax:p}=s.current,h=d*((n-m)*t);i({min:u-h,max:p-h})},a=()=>{o(!1),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",a),document.removeEventListener("touchmove",r),document.removeEventListener("touchend",a)},c=()=>{document.addEventListener("mousemove",r),document.addEventListener("mouseup",a),document.addEventListener("touchmove",r),document.addEventListener("touchend",a)};return({e:l,u:n})=>{l.preventDefault(),o(!0),s.current={leftStart:Bi(l),xUnitsPerPx:n.posToVal(1,"x")-n.posToVal(0,"x"),scXMin:n.scales.x.min||0,scXMax:n.scales.x.max||0},c()}},_l=t=>{const{ctrlKey:o,metaKey:i,button:s}=t;return s===0&&(o||i)},fo=.9,yl=t=>{const[o,i]=S(!1),s=vl({dragSpeed:fo,setPanning:i,setPlotScale:t});return{onReadyChart:a=>{const c=n=>{const m=n instanceof MouseEvent&&_l(n),d=window.TouchEvent&&n instanceof TouchEvent&&n.touches.length>1;(m||d)&&s({u:a,e:n})},l=n=>{if(!n.ctrlKey&&!n.metaKey)return;n.preventDefault();const{width:m}=a.over.getBoundingClientRect(),d=a.cursor.left&&a.cursor.left>0?a.cursor.left:0,u=a.posToVal(d,"x"),p=(a.scales.x.max||0)-(a.scales.x.min||0),h=n.deltaY<0?p*fo:p/fo,g=u-d/m*h,f=g+h;a.batch(()=>t({min:g,max:f}))};a.over.addEventListener("mousedown",c),a.over.addEventListener("touchstart",c),a.over.addEventListener("wheel",l)},isPanning:o}},$i=t=>{const o=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.sqrt(o*o+i*i)},bl=({uPlotInst:t,xRange:o,setPlotScale:i})=>{const[s,r]=S(0),a=M(n=>{const{target:m,ctrlKey:d,metaKey:u,key:p}=n,h=m instanceof HTMLInputElement||m instanceof HTMLTextAreaElement;if(!t||h)return;const g=p==="+"||p==="=";if((p==="-"||g)&&!(d||u)){n.preventDefault();const y=(o.max-o.min)/10*(g?1:-1);i({min:o.min+y,max:o.max-y})}},[t,o]),c=n=>{n.touches.length===2&&(n.preventDefault(),r($i(n.touches)))},l=M(n=>{if(!t||n.touches.length!==2)return;n.preventDefault();const m=$i(n.touches),d=s-m,u=t.scales.x.max||o.max,p=t.scales.x.min||o.min,h=u-p,g=d>0?-1:1,f=h/50*g;t.batch(()=>i({min:p+f,max:u-f}))},[t,s,o]);return ie("keydown",a),ie("touchmove",l),ie("touchstart",c),null};function wl(t,o){const i=[];let s=[];const r=t[0].length,a=Array(r);for(let c=0;c<r;c++)a[c]=0;for(let c=1;c<t.length;c++)i.push(o(c)?t[c]:t[c].map((l,n)=>a[n]+=+(l??0)));for(let c=1;c<t.length;c++)!o(c)&&s.push({series:[t.findIndex((l,n)=>n>c&&!o(n)),c]});return s=s.filter(c=>c.series[1]>-1),{data:[t[0]].concat(i),bands:s}}const Ui=t=>O(t*1e3).tz().format(Ae),kl=({data:t,focusDataIdx:o,uPlotInst:i})=>{const[s,r]=S(!1),a=D(null),c=F(()=>{if(!i||o<0||!t.length||!t[0]?.length)return;const n=t[0][o]||0,m=t[0][1]-t[0][0],d=n+m,u=t.slice(1).map(_=>_[o]||0),p=i.series.slice(1);let h=0;const g=p.reduce((_,y,b)=>{if(!y?.show)return _;const v=u[b];return v<=0||(_.push({value:v,label:y.label,stroke:y.stroke?.(),show:!0}),h+=v),_},[]);return g.sort(Ws("value")),g.length?{point:{top:i.valToPos?.(g[0]?.value??0,"y")||0,left:i.valToPos?.(n,"x")||0},total:h,values:g,timestamp:`${Ui(n)} - ${Ui(d)}`}:void 0},[o,i,t]),l=F(()=>{if(!i||!c||!a.current||!s)return;const{top:n,left:m}=c.point,d={left:parseFloat(i.over.style.left),top:parseFloat(i.over.style.top)},{width:u,height:p}=i.over.getBoundingClientRect(),{width:h,height:g}=a.current.getBoundingClientRect(),f=50,_=m+h>=u?h+2*f:0,y=n+g>=p?g+2*f:0,b={top:n+d.top+f-y,left:m+d.left+f-_};return b.left<0&&(b.left=20),b.top<0&&(b.top=20),b},[c,i,s]);return Ir(()=>{a.current?r(!0):r(!1)},[c]),c?e("div",{className:I({"vm-chart-tooltip":!0,"vm-chart-tooltip_hits":!0,"vm-bar-hits-tooltip":!0}),ref:a,style:l,children:[e("div",{children:c.values.map(n=>e("div",{className:"vm-chart-tooltip-data",children:[e("span",{className:"vm-chart-tooltip-data__marker",style:{background:n.stroke}}),e("p",{className:"vm-bar-hits-tooltip-item",children:[e("span",{className:"vm-bar-hits-tooltip-item__label",children:n.label}),e("span",{children:n.value&&n.value.toLocaleString("en-US")})]})]},n.label))}),c.values.length>1&&e("div",{className:"vm-chart-tooltip-data",children:[e("span",{}),e("p",{className:"vm-bar-hits-tooltip-item",children:[e("span",{className:"vm-bar-hits-tooltip-item__label",children:"Total"}),e("span",{children:c.total.toLocaleString("en-US")})]})]}),e("div",{className:"vm-chart-tooltip-header",children:e("div",{className:"vm-chart-tooltip-header__title vm-bar-hits-tooltip__date",children:c.timestamp})})]}):null},ur=t=>t>=1e9?(t/1e9).toFixed(1).replace(/\.0$/,"")+"B":t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":t.toString(),ql=({legend:t})=>{const o=t.total.toLocaleString("en-US"),i=Math.round(t.total/t.totalHits*100);return e("div",{className:"vm-legend-hits-menu-section",children:e("div",{className:"vm-legend-hits-menu-row",children:e("div",{className:"vm-legend-hits-menu-row__title",children:["Total: ",o," (",i,"%)"]})})})},It=({title:t,shortcut:o,handler:i,iconStart:s,iconEnd:r,className:a,submenu:c})=>{const l=D(null),n=D(null),m=D(null),[d,u]=S(!1),[p,h]=S(!1),[g,f]=S(!1),_=!!c?.length,y=()=>{h(w=>!w)},b=()=>{h(!1)},v=()=>{i&&i(),_&&y()};A(()=>{n.current&&u(n.current.scrollWidth>n.current.clientWidth)},[t,n]),A(()=>{requestAnimationFrame(()=>{if(!p||!m.current){f(!1);return}const{left:w,width:x}=m.current.getBoundingClientRect();f(w+x>window.innerWidth)})},[m,p]),Ft(l,b);const k=e("div",{ref:n,className:"vm-legend-hits-menu-row__title",children:t});return e("div",{ref:l,className:I({"vm-legend-hits-menu-row":!0,"vm-legend-hits-menu-row_interactive":!!i||_,[`${a}`]:a}),onClick:v,children:[s&&e("div",{className:"vm-legend-hits-menu-row__icon",children:s}),d?e(Q,{title:t,children:k}):k,r&&!_&&e("div",{className:"vm-legend-hits-menu-row__icon",children:r}),o&&e("div",{className:"vm-legend-hits-menu-row__shortcut",children:o}),_&&e("div",{className:"vm-legend-hits-menu-row__icon vm-legend-hits-menu-row__icon_drop",children:e(Ve,{})}),p&&c&&e("div",{ref:m,className:I({"vm-legend-hits-menu":!0,"vm-legend-hits-menu_submenu":!0,"vm-legend-hits-menu_submenu_left":g}),children:e("div",{className:"vm-legend-hits-menu-section",children:c.map(({...w})=>e(It,{...w},w.title))})})]})},xl=({legend:t,onApplyFilter:o,onClose:i})=>{const s=ve(),{groupFieldHits:{value:r}}=Et(),a=n=>()=>{o({field:r,value:t.label,operator:n}),i()},c=async()=>{await s(t.label,`${t.label} has been copied`),i()},l=[{title:`Copy ${r} name`,iconStart:e(we,{}),handler:c},{title:`Add ${r} to filter`,iconStart:e(We,{}),handler:a(Z.Equals)},{title:`Exclude ${r} to filter`,iconStart:e(Ze,{}),handler:a(Z.NotEquals)}];return e("div",{className:"vm-legend-hits-menu-section",children:l.map(({...n})=>e(It,{...n},n.title))})},Nl=t=>t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.slice(1,-1):t,Sl=t=>{const[o,i]=t.split(":").map(r=>r.trim()),s=Nl(i);return{field:o,value:s}},Cl=({fields:t,onApplyFilter:o,onClose:i})=>{const s=ve(),{groupFieldHits:{value:r}}=Et(),a=m=>async()=>{await s(m,`${m} has been copied`),i()},c=(m,d)=>()=>{o({...Sl(m),operator:d}),i()},l=m=>[{title:"Copy",iconStart:e(we,{}),handler:a(m)},{title:"Add to filter",iconStart:e(We,{}),handler:c(m,Z.Equals)},{title:"Exclude to filter",iconStart:e(Ze,{}),handler:c(m,Z.NotEquals)}],n=F(()=>t.map(m=>{const d=Ks(m,r);return{title:d,submenu:l(d)}}),[t]);return e("div",{className:"vm-legend-hits-menu-section",children:n?.map(m=>e(It,{...m},m.title))})},Al=({options:t})=>e("div",{className:"vm-legend-hits-menu-section",children:t.map(({...o})=>e(It,{...o},o.title))}),Tl=`Aggregated results for fields not in the top ${vt}`,Ll=({legend:t,fields:o,optionsVisibilitySection:i,onApplyFilter:s,onClose:r})=>e("div",{className:"vm-legend-hits-menu",children:[e(Al,{options:i}),!t.isOther&&e(xl,{legend:t,onApplyFilter:s,onClose:r}),!t.isOther&&e(Cl,{fields:o,onApplyFilter:s,onClose:r}),e(ql,{legend:t}),t.isOther&&e("div",{className:"vm-legend-hits-menu-section vm-legend-hits-menu-section_info",children:e(It,{title:Tl})})]}),Fl=({targetSeries:t,isOnlyTargetVisible:o,handleVisibilityToggle:i,handleFocusToggle:s})=>{const r=!!t?.show;return F(()=>[{title:r?"Hide this series":"Show this series",iconStart:r?e(Zt,{}):e(rt,{}),shortcut:`${mt} + Click`,handler:i},{title:o?"Show all series":"Show only this series",iconStart:o?e(Tt,{}):e(At,{}),shortcut:`${He} + Click`,handler:s}],[o,r,i,s])},El=({legend:t,series:o,onRedrawGraph:i,onApplyFilter:s})=>{const{value:r,setTrue:a,setFalse:c}=ee(),l=D(null),[n,m]=S(null),d=F(()=>o.find(k=>k.label===t.label),[o]),u=o.every(k=>k===d||!k.show),p=F(()=>Gs(t.label),[t.label]),h=p.join(", "),g=ur(t.total),f=k=>{k.preventDefault(),m({top:k.clientY,left:k.clientX}),a()},_=M(()=>{d&&(d.show=!d.show,i(),c())},[d,i,c]),y=M(()=>{o.forEach(k=>{k.show=u||k===d}),i(),c()},[o,u,d,i,c]),b=k=>{const{ctrlKey:w,metaKey:x,altKey:q}=k;if(q){_();return}if(w||x){y();return}f(k)},v=Fl({targetSeries:d,isOnlyTargetVisible:u,handleVisibilityToggle:_,handleFocusToggle:y});return e("div",{ref:l,className:I({"vm-bar-hits-legend-item":!0,"vm-bar-hits-legend-item_other":t.isOther,"vm-bar-hits-legend-item_active":r,"vm-bar-hits-legend-item_hide":!d?.show}),onClick:b,children:[e("div",{className:"vm-bar-hits-legend-item__marker",style:{backgroundColor:`${t.stroke}`}}),e("div",{className:"vm-bar-hits-legend-item__label",children:h}),e("span",{className:"vm-bar-hits-legend-item__total",children:["(",g,")"]}),e(Fe,{placement:"fixed",open:r,buttonRef:l,placementPosition:n,onClose:c,children:e(Ll,{legend:t,fields:p,optionsVisibilitySection:v,onApplyFilter:s,onClose:c})})]})},Il=({uPlotInst:t,legendDetails:o,onApplyFilter:i})=>{const[s,r]=S([]),a=()=>t.series.filter(l=>l.scale!=="x"),c=()=>{t.redraw()};return A(()=>{t.hooks.draw||(t.hooks.draw=[]),t.hooks.draw.push(()=>{r(a())})},[t]),e("div",{className:"vm-bar-hits-legend",children:o.map(l=>e(El,{legend:l,series:s,onRedrawGraph:c,onApplyFilter:i},l.label))})},Ml=t=>t.map((o,i)=>i===0?o:Pl(o)),Pl=t=>{const o=[];let i=0;for(const s of t)i+=s??0,o.push(i);return o},Ol=({graphOptions:t,logHits:o,totalHits:i,data:s,period:r,setPeriod:a,onApplyFilter:c})=>{const{isMobile:l}=G(),{isDarkTheme:n}=se(),{timezone:m}=ce(),[d,u]=hl(),p=D(null),[h,g]=S(),{xRange:f,setPlotScale:_}=gl({period:r,setPeriod:a}),{onReadyChart:y,isPanning:b}=yl(_);bl({uPlotInst:h,xRange:f,setPlotScale:_});const v=F(()=>t.cumulative?Ml(s):s,[t.cumulative,s]),{data:k,bands:w}=F(()=>t.stacked?wl(v,()=>!1):{data:v,bands:[]},[t.stacked,v]),{options:x,series:q,focusDataIdx:N}=Vc({data:k,logHits:o,bands:w,xRange:f,containerSize:u,onReadyChart:y,setPlotScale:_,graphOptions:t,timezone:m}),T=F(()=>o.map(C=>{const L=Qs(C);return{label:L,isOther:C._isOther,fields:C.fields,total:C.total||0,totalHits:i,stroke:q.find(z=>z.label===L)?.stroke}}).sort(Ws("total")),[o,i,q]);return A(()=>{if(!h)return;const C=new Map(h.series.map(E=>[E.label,E])),L=q.map(E=>{const z=C.get(E.label);return z?{...E,show:z.show}:E});Ys(h),Ec(h,L,!0),Pc(h,L),h.redraw()},[q,h]),A(()=>{h&&(h.delBand(),w.forEach(C=>{h.addBand(C)}),h.redraw())},[w]),A(()=>{if(!p.current)return;const C=new Oo(x,k,p.current);return g(C),()=>C.destroy()},[p.current,n,m]),A(()=>{h&&(h.scales.x.range=()=>[f.min,f.max],h.redraw())},[f]),A(()=>{h&&(h.setSize(u),h.redraw())},[u]),A(()=>{h&&(h.setData(k),h.redraw())},[k]),e(V,{children:[e("div",{className:I({"vm-bar-hits-chart":!0,"vm-bar-hits-chart_panning":b}),ref:d,children:[e("div",{className:"vm-line-chart__u-plot",ref:p}),!l&&e(kl,{uPlotInst:h,data:v,focusDataIdx:N})]}),h&&e(Il,{uPlotInst:h,onApplyFilter:c,legendDetails:T})]})},Rl=({totalHits:t,isHitsMode:o,durationMs:i})=>{const{isMobile:s}=G(),r=s?ur(t):t.toLocaleString("en-US"),a=i?$o(i):null;return e("div",{className:"vm-bar-hits-stats",children:[o&&e("p",{className:"vm-bar-hits-stats__item",children:["Total: ",e("b",{children:r})," hits"]}),a&&e("p",{className:"vm-bar-hits-stats__item",children:["Duration: ",e("b",{children:a})]})]})},Dl=({logHits:t,data:o,query:i,period:s,setPeriod:r,onApplyFilter:a,durationMs:c,isOverview:l})=>{const[n,m]=S({graphStyle:Ue.BAR,queryMode:me.hits,stacked:!1,cumulative:!1,fill:!1,hideChart:!1}),d=n.queryMode===me.hits,u=F(()=>$c(t),[t]);return e("div",{className:I({"vm-bar-hits-chart__wrapper":!0,"vm-bar-hits-chart__wrapper_hidden":n.hideChart}),children:[e("div",{className:"vm-bar-hits-chart-header",children:[e(Rl,{totalHits:u,isHitsMode:d,durationMs:c}),e(ul,{query:i,isHitsMode:d,isOverview:l,onChange:m})]}),!n.hideChart&&e(Ol,{logHits:t,totalHits:u,data:o,period:s,setPeriod:r,onApplyFilter:a,graphOptions:n})]})},hr=({query:t,logHits:o,durationMs:i,period:s,error:r,isLoading:a,isOverview:c,onApplyFilter:l})=>{const{isMobile:n}=G(),m=nt(),[d]=te(),u=F(()=>d.get("hide_chart"),[d]),p=(y,b)=>y.map(v=>{const k=new Map;return v.timestamps.forEach((w,x)=>{k.set(xi(w),v.values[x]||null)}),b.map(w=>k.get(w)||null)}),h=y=>{const b=y.map(w=>w.timestamps).flat();return Array.from(new Set(b)).map(w=>xi(O(w))).sort((w,x)=>w-x)},g=F(()=>{if(!o.length)return[[],[]];const y=h(o),b=p(o,y);return[y,...b]},[o]),f=F(()=>{if(a)return"";const y=g.every(k=>k.length===0),b=g[0].length===0,v=g[1].length===0;return u?"Chart hidden. Hits updates paused.":y?`No logs volume available
No volume information available for the current queries and time range.`:b?"No timestamp information available for the current queries and time range.":v?"No value information available for the current queries and time range.":""},[g,u,a]),_=({from:y,to:b})=>{m({type:"SET_PERIOD",payload:{from:y,to:b}})};return e("section",{className:I({"vm-query-page-chart":!0,"vm-block":!0,"vm-block_mobile":n}),children:[a&&e(dt,{}),!r&&f&&e("div",{className:"vm-query-page-chart__empty",children:e(fe,{variant:"info",children:f})}),r&&f&&e("div",{className:"vm-query-page-chart__empty",children:e(fe,{variant:"error",children:e("pre",{children:r})})}),g&&e(Dl,{isOverview:c,logHits:o,durationMs:i,query:t,data:g,period:s,setPeriod:_,onApplyFilter:l})]})};function zl(t){return Object.keys(t).length===0}const vo=t=>{switch(t){case"NaN":return NaN;case"Inf":case"+Inf":return 1/0;case"-Inf":return-1/0;default:return parseFloat(t)}},Hl=t=>{if(!t)return"";const{__name__:o,...i}=t,s=o??"",r=Object.entries(i).filter(([a,c])=>c).sort(([a],[c])=>a.localeCompare(c)).map(([a,c])=>`${a}:"${c}"`).join(", ");return!s&&!r?"":r?`${s} {${r}}`:s},Vl=({setLogHits:t,setError:o})=>(i,s)=>{const r=[],a=i?.data?.result,c=a?.length,l=Number.isFinite(s)?s:vt;if(!a)return o("Error: No 'result' field in response"),t([]),r;if(!c)return t([]),r;const n=new Array(c);for(let g=0;g<c;g++){const f=a[g];let _=0;for(let y=0;y<f.values.length;y++){const[,b]=f.values[y];_+=vo(b)}n[g]={idx:g,total:_}}n.sort((g,f)=>f.total-g.total);const m=Math.min(l,c),d=n.slice(0,m),u=n.slice(m),p=new Map;let h=0;for(let g=0;g<u.length;g++){const f=u[g].idx,_=a[f];for(let y=0;y<_.values.length;y++){const[b,v]=_.values[y],k=vo(v),w=p.get(b)??0;p.set(b,w+k),h+=k}}if(u.length>0){const g=Array.from(p.keys()).sort((b,v)=>b-v),f=g.map(b=>new Date(b*1e3).toISOString()),_=g.map(b=>p.get(b)??0),y={timestamps:f,values:_,total:h,fields:{},_isOther:!0};r.push(y)}for(let g=0;g<d.length;g++){const f=d[g].idx,_=a[f],y=_.values.length,b=new Array(y),v=new Array(y);for(let k=0;k<y;k++){const[w,x]=_.values[k];b[k]=new Date(w*1e3).toISOString(),v[k]=vo(x)}r.push({timestamps:b,values:v,total:d[g].total,fields:{name:Hl(_.metric)},_isOther:!1})}return t(r),r},gr=(t="*")=>{const{serverUrl:o}=se(),i=Je(),[s]=te(),[r,a]=S([]),[c,l]=S([]),[n,m]=S(),[d,u]=S(),p=D(new AbortController),h=Vl({setLogHits:a,setError:m}),g=F(()=>s.get("hide_chart"),[s]),f=M(v=>{switch(v){case me.hits:return kc(o);case me.stats:return qc(o)}},[o]),_=({query:v=t,period:k,extraParams:w,signal:x,fieldsLimit:q,field:N,barsCount:T})=>{const{start:C,end:L,step:E}=Bc(k,T),z=O().tz().utcOffset(),U=new URLSearchParams({query:v.trim(),step:`${E}ms`,offset:`${z}m`,start:C.toISOString(),end:L.toISOString(),fields_limit:`${q||vt}`,field:N||Ce});return{body:new URLSearchParams([...U,...w??[]]),signal:x,method:"POST",headers:{...i}}},y=v=>{const k=v?.hits;if(!k)return m("Error: No 'hits' field in response"),[];const w=k.map(Bl).sort($l);return a(w),w},b=M(async v=>{const k=v.queryMode||me.hits;p.current.abort(),p.current=new AbortController;const{signal:w}=p.current,x=Date.now();l(q=>({...q,[x]:!0})),m(void 0);try{const q=_({...v,signal:w}),N=f(k),T=await fetch(N,q),C=T.headers.get("vl-request-duration-seconds");if(u(C?Number(C)*1e3:void 0),!T.ok||!T.body){const E=await T.text();try{m(JSON.stringify(JSON.parse(E),null,2))}catch{m(E)}a([]),l(z=>({...z,[x]:!1}));return}const L=await T.json();switch(k){case me.hits:return y(L);case me.stats:{const E=+(q.body.get("fields_limit")||vt);return h(L,E)}}}catch(q){q instanceof Error&&q.name!=="AbortError"&&(m(String(q)),console.error(q),a([]))}finally{l(q=>({...q,[x]:!1}))}},[f,t,i]);return A(()=>()=>{p.current.abort()},[]),A(()=>{g&&(a([]),m(void 0))},[g]),{logHits:r,isLoading:Object.values(c).some(v=>v),error:n,fetchLogHits:b,durationMs:d,abortController:p.current}},Bl=t=>({...t,_isOther:zl(t.fields)}),$l=(t,o)=>t._isOther!==o._isOther?t._isOther?-1:1:o.total-t.total;function Ul(t){const o=D(t);A(()=>{o.current=t},[t]),A(()=>()=>{o.current()},[])}function ji(t,o=500,i){const s=D(t);s.current=t;const r=F(()=>{const a=as((...l)=>s.current(...l),o,i),c=(...l)=>{a(...l)};return c.cancel=a.cancel,c.flush=a.flush,c},[o,i]);return Ul(()=>{r.cancel()}),r}function $e(t){const o=D();return A(()=>{o.current=t},[t]),o.current}const jl=({setLimit:t})=>{const{value:o,setFalse:i,setTrue:s}=ee(),[r,a]=S(0),[c,l]=S(0),[n,m]=S(()=>{try{return!!sessionStorage.getItem(ao)}catch{return!1}}),d=D(),u=D(null),p=M(async y=>{if(u.current)return u.current;const b=Number(y.get("limit")??0),v=Number.isFinite(b)&&b>=0?b:0,k=v===0||v>gt,w=v>Xr&&!n;if(!(k||w))return{action:"proceed"};a(v),l(v),s();const q=new Promise(N=>{d.current=N});return u.current=q,q},[s,n]),h=M(()=>{const y=d.current;if(!y){i();return}let b=Math.floor(Number.isFinite(c)?c:0);b<0&&(b=0),b>gt&&(b=gt),t(b);const v=new URLSearchParams;v.set("limit",String(b)),y({action:"modify",body:v}),d.current=void 0,u.current=null,i()},[c,t,i]),g=M(()=>{const y=d.current;y&&y({action:"abort"}),d.current=void 0,u.current=null,i()},[i]),f=M(y=>{m(y);try{y?sessionStorage.setItem(ao,"true"):sessionStorage.removeItem(ao)}catch(b){console.error(b)}},[]);return A(()=>()=>{d.current&&(d.current({action:"abort"}),d.current=void 0,u.current=null)},[]),{beforeFetch:p,modalProps:{isOpen:o,initialLimit:r,limitDraft:c,setLimitDraft:l,suppressWarning:n,onChangeSuppressWarning:f,onConfirm:h,onCancel:g}}},Yl=({initialLimit:t,limitDraft:o,setLimitDraft:i,isOpen:s,suppressWarning:r,queryParams:a,onChangeSuppressWarning:c,onConfirm:l,onCancel:n})=>{const m=t?t.toLocaleString("en-US"):"an unlimited number of",[d,u]=S(!1);return A(()=>()=>n(),[n]),s?e(ke,{title:"Confirm large load",isOpen:s,onClose:n,children:e("div",{className:"vm-logs-limit-modal",children:[e("div",{className:"vm-logs-limit-modal-text",children:[e("p",{children:["Youre about to load ",e("b",{children:m})," logs."]}),e("p",{children:"This may slow down the app or make the UI unresponsive."}),e("p",{children:"Are you sure you want to continue?"})]}),e("div",{className:"vm-logs-limit-modal-input",children:e(ir,{limit:o,onChangeLimit:i,onPressEnter:l,onError:u})}),e(tr,{queryParams:a,children:e("p",{className:"vm-logs-limit-modal-download vm-link vm-link_colored vm-link_underlined",children:"Click to download all matching logs without a limit."})}),e("div",{className:"vm-logs-limit-modal-footer",children:[e("div",{children:e(Lo,{color:"primary",label:"Don't show again in this tab",checked:r,onChange:c})}),e("div",{className:"vm-logs-limit-modal-footer__actions",children:[e(R,{color:"error",variant:"outlined",onClick:n,children:"Cancel"}),e(R,{onClick:l,disabled:d,children:"Load Logs"})]})]})]})}):null},Ql=t=>!!t&&t.includes("_time"),Gl=t=>{const{serverUrl:o}=se(),i=Je(),[s,r]=S(null),[a,c]=S(!1),[l,n]=S();return{fetchQueryTime:M(async({period:d,query:u})=>{if(!Yo()||!Ql(u))return;const p=new URLSearchParams({query:u||t||"",start:d.start.toString(),end:d.end.toString()});r(null),c(!0),n("");try{const h=`${o}/select/logsql/query_time_range`,g=await fetch(h,{method:"POST",headers:{...i},body:p});if(!g.ok||!g.body){const N=await g.text();n(N),c(!1);return}const{start:f,end:_,hasTimeFilter:y}=await g.json(),b=O(f),v=O(_);if(!b.isValid()||!v.isValid()){n("Invalid date range"),c(!1);return}const k={from:b.toDate(),to:v.toDate()},w=gs(k),q={...ze(w,k.to),hasTimeFilter:y};return r(q),q}catch(h){h instanceof Error&&h.name!=="AbortError"&&(n(String(h)),console.error(h))}finally{c(!1)}},[t,o,i]),serverPeriod:s,isLoading:a,error:l}},Yi=Number(be("LOGS_LIMIT")),Kl=isNaN(Yi)?Jr:Yi,Wl=()=>{const{queryHistory:t,queryHasTimeFilter:o}=Nt(),i=Go(),{duration:s,relativeTime:r,period:a}=ce(),c=nt(),{setSearchParamsFromKeys:l}=Lt(),{topHits:{value:n},groupFieldHits:{value:m},barsCount:{value:d}}=Et(),u=$e(n),p=$e(m),h=$e(d),[g]=te(),f=F(()=>!!g.get("hide_chart"),[g]),_=$e(f),y=F(()=>!!g.get("hide_logs"),[g]),b=$e(y),[v]=de(me.hits,"graph_mode"),k=$e(v),[w,x]=de(Kl,oe.LIMIT),[q,N]=de("*","query"),[T,C]=S(!1),L=ae=>{x(ae),l({limit:ae}),he("LOGS_LIMIT",`${ae}`)},{beforeFetch:E,modalProps:z}=jl({setLimit:L}),U=()=>{const ae=La(q,t[0]);i({type:"SET_QUERY_HISTORY",payload:{key:"LOGS_QUERY_HISTORY",history:[ae]}})},[Y,W]=S(!1),[K,H]=S(a),[P,B]=S(""),{logs:$,isLoading:j,error:X,fetchLogs:le,abortController:re,durationMs:ne,queryParams:Ee}=Xe(q,w),{fetchLogHits:De,...qe}=gr(q),{fetchQueryTime:so}=Gl(q),qr=ji(async(ae,xe)=>{xe.logs&&!await le({period:ae,beforeFetch:E})||xe.hits&&await De({period:ae,barsCount:d,field:m,fieldsLimit:n,queryMode:v})},300),ui=()=>{const ae=Ht.find(hi=>hi.id===r);if(!ae)return a;const{duration:xe,until:Re}=ae;return ze(xe,Re())},ro=ji(async()=>{if(!q){B(ls.validQuery);return}B("");const ae=ui(),xe=await so({query:q,period:ae}),Re=xe??ae;i({type:"SET_QUERY_HAS_TIME_FILTER",payload:!!xe?.hasTimeFilter}),xe?.hasTimeFilter&&(C(!0),c({type:"SET_PERIOD",payload:{from:new Date(Re.start*1e3),to:new Date(Re.end*1e3)}})),H(Re),qe.abortController.abort?.(),re.abort?.(),qr(Re,{logs:!y,hits:!f}),l({query:q,"g0.range_input":s,"g0.end_input":Re.date,"g0.relative_time":r||"none"}),U()},300),xr=ae=>{N(xe=>`${jt(ae)} AND ${xe}`),W(!0)},Nr=()=>{j||qe.isLoading?(re.abort?.(),qe.abortController.abort?.()):ro()};return A(()=>{if(q){if(T){C(!1);return}H(ui()),ro()}},[a]),A(()=>{Y&&(ro(),W(!1))},[q,Y]),A(()=>{(u&&n!==u||p&&m!==p||_&&!f||k&&v!==k||h&&d!==h)&&(qe.abortController.abort?.(),De({period:K,barsCount:d,field:m,fieldsLimit:n,queryMode:v}))},[f,_,K,m,p,n,u,d,h,v,k,De]),A(()=>{y||!b||le({period:K,beforeFetch:E})},[y,b,K,le,E]),e("div",{className:"vm-query-page",children:[e(Yl,{...z,queryParams:Ee}),e(il,{query:q,queryDurationMs:y?void 0:ne,error:P,limit:w,onChange:N,onChangeLimit:L,onRun:Nr,isLoading:j||qe.isLoading}),X&&e(fe,{variant:"error",children:X}),o&&e(fe,{variant:"warning",children:e("p",{children:"Time range is overridden by the query `_time` filter. Remove `_time` from the query to use manual selection. Disable query time override in Settings."})}),!X&&e(hr,{...qe,query:q,period:K,onApplyFilter:xr}),e(or,{data:$,queryParams:Ee,isLoading:j})]})};var wt=(t=>(t[t.internalLink=0]="internalLink",t[t.externalLink=1]="externalLink",t))(wt||{});const Zl=()=>[{label:bt[pe.home].title,value:pe.home},{label:bt[pe.overview].title,value:pe.overview}],Io=({activeMenu:t,label:o,value:i,type:s,color:r})=>s===wt.externalLink?e("a",{className:I({"vm-header-nav-item":!0,"vm-header-nav-item_active":t===i}),style:{color:r},href:i,target:"_blank",rel:"noreferrer",children:o}):e(ss,{className:I({"vm-header-nav-item":!0,"vm-header-nav-item_active":t===i}),style:{color:r},to:i,children:o}),Jl=({activeMenu:t,label:o,color:i,background:s,submenu:r,direction:a})=>{const{pathname:c}=Ge(),[l,n]=S(null),m=D(null),{value:d,setFalse:u,setTrue:p}=ee(),h=()=>{p(),l&&clearTimeout(l)},g=()=>{l&&clearTimeout(l);const _=setTimeout(u,300);n(_)},f=()=>{l&&clearTimeout(l)};return A(()=>{u()},[c]),a==="column"?e(V,{children:r.map(_=>e(Io,{activeMenu:t,value:_.value||"",label:_.label||"",type:_.type||wt.internalLink},_.value))}):e("div",{className:I({"vm-header-nav-item":!0,"vm-header-nav-item_sub":!0,"vm-header-nav-item_open":d,"vm-header-nav-item_active":r.find(_=>_.value===t)}),style:{color:i},onMouseEnter:h,onMouseLeave:g,ref:m,children:[o,e(Ve,{}),e(Fe,{open:d,placement:"bottom-left",offset:{top:12,left:0},onClose:u,buttonRef:m,children:e("div",{className:"vm-header-nav-item-submenu",style:{background:s},onMouseLeave:g,onMouseEnter:f,children:r.map(_=>e(Io,{activeMenu:t,value:_.value||"",label:_.label||"",color:i,type:_.type||wt.internalLink},_.value))})})]})},Xl=t=>{try{return t.replace(/^\/+/,"").replace(/-/g," ").trim().replace(/^\w/,o=>o.toUpperCase())}catch{return t}},fr=t=>t.filter(o=>!o.hide).map(o=>{const i={...o};return i.value&&!i.label&&(i.label=bt[i.value]?.title||Xl(i.value)),i.submenu&&i.submenu.length>0&&(i.submenu=fr(i.submenu)),i}),ed=()=>{const t=Zl();return fr(t)},vr=({color:t,background:o,direction:i})=>{const{pathname:s}=Ge(),[r,a]=S(s),c=ed();return A(()=>{a(s)},[s]),e("nav",{className:I({"vm-header-nav":!0,[`vm-header-nav_${i}`]:i}),children:c.map(l=>l.submenu?e(Jl,{activeMenu:r,label:l.label||"",submenu:l.submenu,color:t,background:o,direction:i},l.label):e(Io,{activeMenu:r,value:l.value||"",label:l.label||"",color:t,type:l.type||wt.internalLink},l.value))})},td=({open:t})=>e("button",{className:I({"vm-menu-burger":!0,"vm-menu-burger_opened":t}),"aria-label":"menu",children:e("span",{})}),od=({background:t,color:o})=>{const{pathname:i}=Ge(),s=D(null),{value:r,toggle:a,setFalse:c}=ee();return A(c,[i]),Ft(s,c),e("div",{className:"vm-header-sidebar",ref:s,children:[e("div",{className:I({"vm-header-sidebar-button":!0,"vm-header-sidebar-button_open":r}),onClick:a,children:e(td,{open:r})}),e("div",{className:I({"vm-header-sidebar-menu":!0,"vm-header-sidebar-menu_open":r}),children:e("div",{children:e(vr,{color:o,background:t,direction:"column"})})})]})},id=({controlsComponent:t,isMobile:o,...i})=>{const s=Be(),{pathname:r}=Ge(),{value:a,toggle:c,setFalse:l}=ee(),n=F(()=>Object.entries(bt).find(([u])=>cs(u,r))?.[1]?.header||{},[r]),m=e(t,{...i,isMobile:o,headerSetup:n});return o?e(V,{children:[e("div",{children:e(R,{className:I({"vm-header-button":!s}),startIcon:e(Xt,{}),onClick:c,ariaLabel:"controls"})}),e(ke,{title:"Controls",onClose:l,isOpen:a,className:I({"vm-header-controls-modal":!0,"vm-header-controls-modal_open":a}),children:m})]}):m},Qi=()=>e(ws,{}),sd=({controlsComponent:t})=>{const{isMobile:o}=G(),i=qt(),s=F(()=>window.innerWidth<1e3,[i]),{isDarkTheme:r}=se(),a=Be(),c=F(()=>Pe(r?"color-background-block":"color-primary"),[r]),{background:l,color:n}=F(()=>{const{headerStyles:{background:u=a?"#FFF":c,color:p=a?c:"#FFF"}={}}=ci();return{background:u,color:p}},[c]),m=Yt(),d=()=>{m({pathname:pe.home}),window.location.reload()};return e("header",{className:I({"vm-header":!0,"vm-header_app":a,"vm-header_dark":r,"vm-header_sidebar":s,"vm-header_mobile":o}),style:{background:l,color:n},children:[s?e(od,{background:l,color:n}):e(V,{children:[!a&&e("div",{className:"vm-header-logo",onClick:d,style:{color:n},children:e(Qi,{})}),e(vr,{color:n,background:l})]}),s&&e("div",{className:I({"vm-header-logo":!0,"vm-header-logo_mobile":!0}),onClick:d,style:{color:n},children:e(Qi,{})}),e(id,{controlsComponent:t,displaySidebar:s,isMobile:o})]})},rd={href:"https://github.com/VictoriaMetrics/VictoriaLogs/issues/new/choose",Icon:Ts,title:"Create an issue"},_r=[{href:"https://docs.victoriametrics.com/victorialogs/logsql/",Icon:oi,title:"LogsQL"},{href:"https://docs.victoriametrics.com/victorialogs/",Icon:ii,title:"Documentation"},rd],ad=t=>`${t}/select/buildinfo`,cd=()=>{const{serverUrl:t}=se(),[o,i]=S("");return A(()=>{(async()=>{try{const a=await(await fetch(ad(t))).json();i(a?.data?.version)}catch(r){console.error(r)}})()},[t]),{version:o}},nd=ct(({links:t=_r})=>{const o=`2019-${new Date().getFullYear()}`,{version:i}=cd();return e("footer",{className:"vm-footer",children:[e("a",{className:"vm-link vm-footer__website",target:"_blank",href:"https://victoriametrics.com/",rel:"me noreferrer",children:[e(ks,{}),"victoriametrics.com"]}),t.map(({href:s,Icon:r,title:a})=>e("a",{className:"vm-link vm-footer__link",target:"_blank",href:s,rel:"help noreferrer",children:[e(r,{}),a]},`${s}-${a}`)),e("div",{className:"vm-footer__copyright",children:[" ",o," VictoriaMetrics."]}),i&&e("span",{className:"vm-footer__version",children:["Version: ",i]})]})}),ld="Browser timezone is not recognized, supported, or could not be determined.",dd=()=>e(Q,{title:ld,children:e(Wt,{})}),Dt=vs(),md=({onChange:t})=>{const{isMobile:o}=G(),{defaultTimezone:i}=ce(),s=ki(),[r,a]=S(""),c=F(()=>[{title:`Default time (${i})`,region:i,utc:i?_t(i):"UTC"},{title:Dt.title,region:Dt.region,utc:_t(Dt.region),isInvalid:!Dt.isValid},{title:"UTC (Coordinated Universal Time)",region:"UTC",utc:"UTC"}].filter(p=>p.region),[i]),l=F(()=>{if(!r)return s;try{return ki(r)}catch{return{}}},[r,s]),n=F(()=>Object.keys(l),[l]),m=p=>{a(p)},d=p=>{t(p),a("")},u=p=>()=>{d(p)};return e("div",{className:I({"vm-timezones-list":!0,"vm-timezones-list_mobile":o}),children:[e("div",{className:"vm-timezones-list-header",children:[e("div",{className:"vm-timezones-list-header__search",children:e(Te,{autofocus:!0,label:"Search",value:r,onChange:m})}),c.map((p,h)=>p&&e("div",{className:"vm-timezones-item vm-timezones-list-group-options__item",onClick:u(p),children:[e("div",{className:"vm-timezones-item__title",children:[p.title,p.isInvalid&&e(dd,{})]}),e("div",{className:"vm-timezones-item__utc",children:p.utc})]},`${h}_${p.region}`))]}),n.map(p=>e("div",{className:"vm-timezones-list-group",children:e($s,{defaultExpanded:!0,title:e("div",{className:"vm-timezones-list-group__title",children:p}),children:e("div",{className:"vm-timezones-list-group-options",children:l[p]&&l[p].map(h=>e("div",{className:"vm-timezones-item vm-timezones-list-group-options__item",onClick:u(h),children:[e("div",{className:"vm-timezones-item__title",children:h.region}),e("div",{className:"vm-timezones-item__utc",children:h.utc})]},h.search))})})},p))]})},pd=Qt((t,o)=>{const{isMobile:i}=G(),{timezone:s}=ce(),r=nt(),[a,c]=S(s),l=D(null),{value:n,toggle:m,setFalse:d}=ee(),u=F(()=>({region:a,utc:_t(a)}),[a]),p=h=>{c(h.region),d()};return A(()=>{c(s)},[s]),ns(o,()=>({handleApply:()=>{r({type:"SET_TIMEZONE",payload:a})}}),[a]),e("div",{className:"vm-timezones",children:[e("div",{className:"vm-server-configurator__title",children:"Time zone"}),e("div",{className:"vm-timezones-item vm-timezones-item_selected",onClick:m,ref:l,children:[e("div",{className:"vm-timezones-item__title",children:u.region}),e("div",{className:"vm-timezones-item__utc",children:u.utc}),e("div",{className:I({"vm-timezones-item__icon":!0,"vm-timezones-item__icon_open":n}),children:e(Ve,{})})]}),e(Fe,{open:n,buttonRef:l,placement:"bottom-left",onClose:d,fullWidth:!0,title:i?"Time zone":void 0,children:e(md,{onChange:p})})]})}),ud=({options:t,value:o,label:i,onChange:s})=>{const r=D(null),[a,c]=S({width:"0px",left:"0px",borderRadius:"0px"}),l=n=>()=>{s(n)};return A(()=>{if(!r.current){c({width:"0px",left:"0px",borderRadius:"0px"});return}const n=t.findIndex(h=>h.value===o),{width:m}=r.current.getBoundingClientRect();let d=m,u=n*d,p="0";n===0&&(p="16px 0 0 16px"),n===t.length-1&&(p="10px",u-=1,p="0 16px 16px 0"),n!==0&&n!==t.length-1&&(d+=1,u-=1),c({width:`${d}px`,left:`${u}px`,borderRadius:p})},[r,o,t]),e("div",{className:"vm-toggles",children:[i&&e("label",{className:"vm-toggles__label",children:i}),e("div",{className:"vm-toggles-group",style:{gridTemplateColumns:`repeat(${t.length}, 1fr)`},children:[a.borderRadius&&e("div",{className:"vm-toggles-group__highlight",style:a}),t.map((n,m)=>e("div",{className:I({"vm-toggles-group-item":!0,"vm-toggles-group-item_first":m===0,"vm-toggles-group-item_active":n.value===o,"vm-toggles-group-item_icon":n.icon&&n.title}),onClick:l(n.value),ref:n.value===o?r:null,children:[n.icon,n.title]},n.value))]})]})},hd=Object.values(_e).map(t=>({title:t,value:t})),gd=()=>{const{isMobile:t}=G(),o=us(),{theme:i}=se(),s=r=>{o({type:"SET_THEME",payload:r})};return e("div",{className:I({"vm-theme-control":!0,"vm-theme-control_mobile":t}),children:[e("div",{className:"vm-server-configurator__title",children:"Theme preferences"}),e("div",{className:"vm-theme-control__toggle",children:e(ud,{options:hd,value:i,onChange:s})},`${t}`)]})},_o="Settings",fd=Qt((t,o)=>{const{isMobile:i}=G(),s=Be(),r=D(null),a=D(null),c=D(null),{value:l,setTrue:n,setFalse:m}=ee(),d=()=>{r.current&&r.current.handleApply(),a.current&&a.current.handleApply(),c.current&&c.current.handleApply(),m()},u=[{show:!0,component:e(pd,{ref:c})},{show:!0,component:e(Ia,{})},{show:!s,component:e(gd,{})}].filter(p=>p.show);return ns(o,()=>({open:n})),e(V,{children:[i?e("div",{className:"vm-mobile-option",onClick:n,children:[e("span",{className:"vm-mobile-option__icon",children:e(st,{})}),e("div",{className:"vm-mobile-option-text",children:e("span",{className:"vm-mobile-option-text__label",children:_o})}),e("span",{className:"vm-mobile-option__arrow",children:e(ge,{})})]}):e(Q,{title:_o,children:e(R,{className:I({"vm-header-button":!s}),variant:"contained",color:"primary",startIcon:e(st,{}),onClick:n,ariaLabel:"settings"})}),l&&e(ke,{title:_o,onClose:m,children:e("div",{className:I({"vm-server-configurator":!0,"vm-server-configurator_mobile":i}),children:[u.map((p,h)=>e("div",{className:"vm-server-configurator__input",children:p.component},h)),e("div",{className:"vm-server-configurator-footer",children:[e(R,{color:"error",variant:"outlined",onClick:m,children:"Cancel"}),e(R,{color:"primary",variant:"contained",onClick:d,children:"Apply"})]})]})})]})}),vd=({relativeTime:t,setDuration:o})=>{const{isMobile:i}=G(),s=r=>()=>{o(r)};return e("div",{className:I({"vm-time-duration":!0,"vm-time-duration_mobile":i}),children:Ht.map(({id:r,duration:a,until:c,title:l})=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":i,"vm-list-item_active":r===t}),onClick:s({duration:a,until:c(),id:r}),children:l||a},r))})},_d=({viewDate:t,showArrowNav:o,onChangeViewDate:i,toggleDisplayYears:s})=>{const r=()=>{i(t.subtract(1,"month"))},a=()=>{i(t.add(1,"month"))};return e("div",{className:"vm-calendar-header",children:[e("div",{className:"vm-calendar-header-left",onClick:s,children:[e("span",{className:"vm-calendar-header-left__date",children:t.format("MMMM YYYY")}),e("div",{className:"vm-calendar-header-left__select-year",children:e(Ve,{})})]}),o&&e("div",{className:"vm-calendar-header-right",children:[e("div",{className:"vm-calendar-header-right__prev",onClick:r,children:e(ge,{})}),e("div",{className:"vm-calendar-header-right__next",onClick:a,children:e(ge,{})})]})]})},yd=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],bd=({viewDate:t,selectDate:o,onChangeSelectDate:i})=>{const s="YYYY-MM-DD",r=O.tz(),a=O(t.format(s)),c=F(()=>{const n=new Array(42).fill(null),m=a.startOf("month"),u=a.endOf("month").diff(m,"day")+1,p=new Array(u).fill(m).map((g,f)=>g.add(f,"day")),h=m.day();return n.splice(h,u,...p),n},[a]),l=n=>()=>{n&&i(n)};return e("div",{className:"vm-calendar-body",children:[yd.map(n=>e(Q,{title:n,children:e("div",{className:"vm-calendar-body-cell vm-calendar-body-cell_weekday",children:n[0]})},n)),c.map((n,m)=>e("div",{className:I({"vm-calendar-body-cell":!0,"vm-calendar-body-cell_day":!0,"vm-calendar-body-cell_day_empty":!n,"vm-calendar-body-cell_day_active":(n&&n.format(s))===o.format(s),"vm-calendar-body-cell_day_today":(n&&n.format(s))===r.format(s)}),onClick:l(n),children:n&&n.format("D")},n?n.format(s):m))]})},wd=({viewDate:t,onChangeViewDate:o})=>{const i=O().format("YYYY"),s=F(()=>t.format("YYYY"),[t]),r=F(()=>{const n=O().subtract(18/2,"year");return new Array(18).fill(n).map((m,d)=>m.add(d,"year"))},[t]);A(()=>{const c=document.getElementById(`vm-calendar-year-${s}`);c&&c.scrollIntoView({block:"center"})},[]);const a=c=>()=>{o(c)};return e("div",{className:"vm-calendar-years",children:r.map(c=>e("div",{className:I({"vm-calendar-years__year":!0,"vm-calendar-years__year_selected":c.format("YYYY")===s,"vm-calendar-years__year_today":c.format("YYYY")===i}),id:`vm-calendar-year-${c.format("YYYY")}`,onClick:a(c),children:c.format("YYYY")},c.format("YYYY")))})},kd=({viewDate:t,selectDate:o,onChangeViewDate:i})=>{const s=O().format("MM"),r=F(()=>o.format("MM"),[o]),a=F(()=>new Array(12).fill("").map((l,n)=>O(t).month(n)),[t]);A(()=>{const l=document.getElementById(`vm-calendar-year-${r}`);l&&l.scrollIntoView({block:"center"})},[]);const c=l=>()=>{i(l)};return e("div",{className:"vm-calendar-years",children:a.map(l=>e("div",{className:I({"vm-calendar-years__year":!0,"vm-calendar-years__year_selected":l.format("MM")===r,"vm-calendar-years__year_today":l.format("MM")===s}),id:`vm-calendar-year-${l.format("MM")}`,onClick:c(l),children:l.format("MMMM")},l.format("MM")))})},qd=({date:t,format:o=Ae,onChange:i})=>{const[s,r]=S(0),[a,c]=S(O.tz(t)),[l,n]=S(O.tz(t)),m=O.tz(),d=m.format(_i)===a.format(_i),{isMobile:u}=G(),p=()=>{r(_=>_===2?0:2)},h=_=>{c(_),r(y=>y===2?1:0)},g=_=>{n(_)},f=()=>{c(m)};return A(()=>{l.format()!==O.tz(t).format()&&i(l.format(o))},[l]),A(()=>{const _=O.tz(t);c(_),n(_)},[t]),e("div",{className:I({"vm-calendar":!0,"vm-calendar_mobile":u}),children:[e(_d,{viewDate:a,onChangeViewDate:h,toggleDisplayYears:p,showArrowNav:s===0}),s===0&&e(bd,{viewDate:a,selectDate:l,onChangeSelectDate:g}),s===2&&e(wd,{viewDate:a,onChangeViewDate:h}),s===1&&e(kd,{selectDate:l,viewDate:a,onChangeViewDate:h}),!d&&s===0&&e("div",{className:"vm-calendar-footer",children:e(R,{variant:"text",size:"small",onClick:f,children:"show today"})})]})},xd=Qt(({date:t,targetRef:o,format:i=Ae,onChange:s,label:r},a)=>{const c=F(()=>O(t).isValid()?O.tz(t):O().tz(),[t]),{isMobile:l}=G(),{value:n,toggle:m,setFalse:d}=ee(),u=h=>{s(h),d()},p=h=>{(h.key==="Escape"||h.key==="Enter")&&d()};return ie("click",m,o),ie("keyup",p),e(V,{children:e(Fe,{open:n,buttonRef:o,placement:"bottom-right",onClose:d,title:l?r:void 0,children:e("div",{ref:a,children:e(qd,{date:c,format:i,onChange:u})})})})}),Gi=t=>O(t).isValid()?O.tz(t).format(Ae):t,Ki=({value:t="",label:o,pickerLabel:i,pickerRef:s,onChange:r,onEnter:a})=>{const c=D(null),[l,n]=S(null),[m,d]=S(Gi(t)),[u,p]=S(!1),[h,g]=S(!1),f=O(m).isValid()?"":"Invalid date format",_=k=>{d(k.currentTarget.value)},y=()=>{r(m)},b=k=>{k.key==="Enter"&&(r(m),g(!0))},v=k=>{d(k),p(!0)};return A(()=>{const k=Gi(t);k!==m&&d(k),h&&(a(),g(!1))},[t]),A(()=>{u&&l&&(l.focus(),l.setSelectionRange(11,11),p(!1))},[u]),e("div",{className:I({"vm-date-time-input":!0,"vm-date-time-input_error":f}),children:[e("label",{children:o}),e(Mr,{tabIndex:1,inputRef:n,mask:"9999-99-99 99:99:99",placeholder:"YYYY-MM-DD HH:mm:ss",value:m,autoCapitalize:"none",inputMode:"numeric",maskChar:null,onChange:_,onBlur:y,onKeyUp:b}),f&&e("span",{className:"vm-date-time-input__error-text",children:f}),e("div",{className:"vm-date-time-input__icon",ref:c,children:e(R,{variant:"text",color:"gray",size:"small",startIcon:e(Ns,{}),ariaLabel:"calendar"})}),e(xd,{label:i,ref:s,date:m,onChange:v,targetRef:c})]})},Nd=({onOpenSettings:t})=>{const{isMobile:o}=G(),{isDarkTheme:i}=se(),{queryHasTimeFilter:s}=Nt(),r=D(null),a=qt(),c=F(()=>a.width>1120,[a]),[l,n]=S(),[m,d]=S(),{period:{end:u,start:p},relativeTime:h,timezone:g,duration:f}=ce(),_=nt(),y=Be(),b=$e(g),{value:v,toggle:k,setFalse:w}=ee(),x=F(()=>({region:g,utc:_t(g)}),[g]);A(()=>{n(Ot(Ie(u)))},[g,u]),A(()=>{d(Ot(Ie(p)))},[g,p]);const q=({duration:K,until:H,id:P})=>{_({type:"SET_RELATIVE_TIME",payload:{duration:K,until:H,id:P}}),w()},N=F(()=>{const K=O.tz(Ie(p)).format(Ae),H=O.tz(Ie(u)).format(Ae);return{start:K,end:H}},[p,u,g]),T=F(()=>h&&h!=="none"?h.replace(/_/g," "):`${N.start} - ${N.end}`,[h,N]),C=D(null),L=D(null),E=D(null),z=()=>{m&&l&&_({type:"SET_PERIOD",payload:{from:O.tz(m).toDate(),to:O.tz(l).toDate()}}),w()},U=()=>_({type:"RUN_QUERY_TO_NOW"}),Y=()=>{n(Ot(Ie(u))),d(Ot(Ie(p))),w()},W=()=>{t&&t(),w()};return A(()=>{const K=Uo({relativeTimeId:h,defaultDuration:f,defaultEndInput:Ie(u)});b&&g!==b&&q({id:K.relativeTimeId,duration:K.duration,until:K.endInput})},[g,b]),Ft(r,K=>{if(o)return;const H=K.target,P=C?.current&&C?.current?.contains(H),B=L?.current&&L?.current?.contains(H);P||B||w()}),e(V,{children:[e("div",{ref:E,children:o?e("div",{className:"vm-mobile-option",onClick:k,children:[e("span",{className:"vm-mobile-option__icon",children:e(Vt,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Time range"}),e("span",{className:"vm-mobile-option-text__value",children:T})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ge,{})})]}):e(Q,{title:c?"Time range controls":T,children:e(R,{className:y?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e(Vt,{}),onClick:k,ariaLabel:"time range controls",children:c&&e("span",{children:T})})})}),e(Fe,{open:v,buttonRef:E,placement:"bottom-right",onClose:w,clickOutside:!1,title:o?"Time range controls":"",children:e("div",{className:I({"vm-time-selector":!0,"vm-time-selector_mobile":o}),ref:r,children:[s&&e("div",{className:"vm-time-selector-warning",children:[e("p",{children:"Time range is overridden by the query `_time` filter."}),e("p",{children:"Remove `_time` from the query to use manual selection."}),e("p",{className:"vm-time-selector-warning__interactive",onClick:W,children:"To disable query time override in settings, click here."})]}),e("div",{className:"vm-time-selector-left",children:[e("div",{className:I({"vm-time-selector-left-inputs":!0,"vm-time-selector-left-inputs_dark":i}),children:[e(Ki,{value:m,label:"From:",pickerLabel:"Date From",pickerRef:C,onChange:d,onEnter:z}),e(Ki,{value:l,label:"To:",pickerLabel:"Date To",pickerRef:L,onChange:n,onEnter:z})]}),e("div",{className:"vm-time-selector-left-timezone",onClick:W,children:[e("div",{className:"vm-time-selector-left-timezone__title",children:x.region}),e("div",{className:"vm-time-selector-left-timezone__utc",children:x.utc})]}),e(R,{variant:"text",startIcon:e(Ss,{}),onClick:U,children:"switch to now"}),e("div",{className:"vm-time-selector-left__controls",children:[e(R,{color:"error",variant:"outlined",onClick:Y,children:"Cancel"}),e(R,{color:"primary",onClick:z,children:"Apply"})]})]}),e(vd,{relativeTime:h||"",setDuration:q})]})})]})},Sd=t=>`${t}/select/tenant_ids`,Cd=()=>{const{serverUrl:t}=se(),[o,i]=S(!1),[s,r]=S(),[a,c]=S([]),l=F(()=>Sd(t),[t]);return A(()=>{(async()=>{i(!0);try{const u=(await(await fetch(l)).json()).map(({account_id:p,project_id:h})=>`${p}:${h}`);c(u.sort((p,h)=>p.localeCompare(h)))}catch(m){m instanceof Error&&r(`${m.name}: ${m.message}`)}i(!1)})().catch(console.error)},[l]),{accountIds:a,isLoading:o,error:s}},Ad=({accountIds:t,tenantId:o,onChange:i})=>{const{isMobile:s}=G(),[r,a]=S(""),c=F(()=>{if(!r)return t;try{const n=new RegExp(r,"i");return t.filter(d=>n.test(d)).sort((d,u)=>(d.match(n)?.index||0)-(u.match(n)?.index||0))}catch{return[]}},[r,t]),l=n=>()=>{const[m,d]=n.split(":");i({accountId:m,projectId:d})};return e("div",{className:I({"vm-list vm-tenant-input-list":!0,"vm-list vm-tenant-input-list_mobile":s}),children:[e("div",{className:"vm-tenant-input-list__search",children:e(Te,{autofocus:!0,label:"Search",value:r,onChange:a,type:"search"})}),c.map(n=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":s,"vm-list-item_active":n===o}),onClick:l(n),children:n},n)),e("div",{className:"vm-tenant-input-list__buttons",children:e("a",{href:"https://docs.victoriametrics.com/victorialogs/#multitenancy",target:"_blank",rel:"help noreferrer",children:e(R,{variant:"text",color:"primary",children:"Read more"})})})]})},Td=({accountId:t,projectId:o,onChange:i})=>{const{isMobile:s}=G(),[r,a]=S(t),[c,l]=S(o),n=M(()=>{i({accountId:r||t,projectId:c||o})},[r,t,c,o]);return A(()=>{a(t),l(o)},[t,o]),e("div",{className:I({"vm-list vm-tenant-input-list":!0,"vm-list vm-tenant-input-list_mobile":s}),children:[e("div",{className:"vm-tenant-input-list__fields",children:[e(Te,{autofocus:!0,label:"accountID",value:r,onChange:a,type:"number"}),e(Te,{autofocus:!0,label:"projectID",value:c,onChange:l,type:"number"})]}),e("div",{className:"vm-tenant-input-list__buttons",children:[e("a",{href:"https://docs.victoriametrics.com/victorialogs/#multitenancy",target:"_blank",rel:"help noreferrer",children:e(R,{variant:"text",color:"primary",children:"Read more"})}),e(R,{variant:"contained",color:"primary",onClick:n,children:"Apply"})]})]})},Ld=()=>{const{accountIds:t}=Cd(),{isMobile:o}=G(),i=nt(),[s,r]=te(),a=s.get("accountID")||"0",c=s.get("projectID")||"0",l=`${a}:${c}`,n=D(null),{value:m,toggle:d,setFalse:u}=ee(),h={tenantId:l,accountIds:t,accountId:a,projectId:c,onChange:({accountId:g,projectId:f})=>{g&&s.set("accountID",g),f&&s.set("projectID",f),r(s),i({type:"RUN_QUERY"}),u()}};return e("div",{className:"vm-tenant-input",children:[e(Q,{title:"Define Tenant ID if you need request to another storage",children:e("div",{ref:n,children:o?e("div",{className:"vm-mobile-option",onClick:d,children:[e("span",{className:"vm-mobile-option__icon",children:e(Bt,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Tenant ID"}),e("span",{className:"vm-mobile-option-text__value",children:l})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ge,{})})]}):e(R,{className:"vm-header-button",variant:"contained",color:"primary",fullWidth:!0,startIcon:e(Bt,{}),endIcon:e("div",{className:I({"vm-execution-controls-buttons__arrow":!0,"vm-execution-controls-buttons__arrow_open":m}),children:e(ge,{})}),onClick:d,children:l})})}),e(Fe,{open:m,placement:"bottom-right",onClose:u,buttonRef:n,title:o?"Define Tenant ID":void 0,children:t.length?e(Ad,{...h}):e(Td,{...h})})]})},yo=[{seconds:0,title:"Off"},{seconds:1,title:"1s"},{seconds:2,title:"2s"},{seconds:5,title:"5s"},{seconds:10,title:"10s"},{seconds:30,title:"30s"},{seconds:60,title:"1m"},{seconds:300,title:"5m"},{seconds:900,title:"15m"},{seconds:1800,title:"30m"},{seconds:3600,title:"1h"},{seconds:7200,title:"2h"}],Fd=()=>{const{isMobile:t}=G(),o=nt(),i=Be(),[s,r]=S(!1),[a,c]=S(yo[0]),{value:l,toggle:n,setFalse:m}=ee(),d=D(null),u=g=>{(s&&!g.seconds||!s&&g.seconds)&&r(f=>!f),c(g),m()},p=()=>{o({type:"RUN_QUERY"})};A(()=>{const g=a.seconds;let f;return s?f=setInterval(()=>{o({type:"RUN_QUERY"})},g*1e3):c(yo[0]),()=>{f&&clearInterval(f)}},[a,s]);const h=g=>()=>{u(g)};return e(V,{children:[e("div",{className:"vm-execution-controls",children:e("div",{className:I({"vm-execution-controls-buttons":!0,"vm-execution-controls-buttons_mobile":t,"vm-header-button":!i}),children:[!t&&e(Q,{title:"Refresh dashboard",children:e(R,{variant:"contained",color:"primary",onClick:p,startIcon:e(Xo,{}),ariaLabel:"refresh dashboard"})}),t?e("div",{className:"vm-mobile-option",onClick:n,children:[e("span",{className:"vm-mobile-option__icon",children:e(ft,{})}),e("div",{className:"vm-mobile-option-text",children:[e("span",{className:"vm-mobile-option-text__label",children:"Auto-refresh"}),e("span",{className:"vm-mobile-option-text__value",children:a.title})]}),e("span",{className:"vm-mobile-option__arrow",children:e(ge,{})})]}):e(Q,{title:"Auto-refresh control",children:e("div",{ref:d,children:e(R,{variant:"contained",color:"primary",fullWidth:!0,endIcon:e("div",{className:I({"vm-execution-controls-buttons__arrow":!0,"vm-execution-controls-buttons__arrow_open":l}),children:e(ge,{})}),onClick:n,children:a.title})})})]})}),e(Fe,{open:l,placement:"bottom-right",onClose:m,buttonRef:d,title:t?"Auto-refresh duration":void 0,children:e("div",{className:I({"vm-execution-controls-list":!0,"vm-execution-controls-list_mobile":t}),children:yo.map(g=>e("div",{className:I({"vm-list-item":!0,"vm-list-item_mobile":t,"vm-list-item_active":g.seconds===a.seconds}),onClick:h(g),children:g.title},g.seconds))})})]})},Ed=({isMobile:t,headerSetup:o})=>{const i=Be(),s=D(null);return e("div",{className:I({"vm-header-controls":!0,"vm-header-controls_mobile":t}),children:[o?.tenant&&e(Ld,{}),o?.timeSelector&&e(Nd,{onOpenSettings:s?.current?.open}),o?.executionControls&&e(Fd,{}),e(fd,{ref:s}),!t&&e(dr,{children:e(R,{className:i?"":"vm-header-button",variant:"contained",color:"primary",startIcon:e(Cs,{})})})]})};var Me=(t=>(t.NO_STORAGE="NO_STORAGE",t.SECURITY_ERROR="SECURITY_ERROR",t.QUOTA_EXCEEDED="QUOTA_EXCEEDED",t.UNKNOWN="UNKNOWN",t))(Me||{});const Id={[Me.NO_STORAGE]:{title:"Storage unavailable",description:"Browser storage is not available for this website.",fix:["Disable Private/Incognito mode and reload the page.","Disable privacy or ad-blocking extensions for this site and reload.","Open the site in another browser."]},[Me.SECURITY_ERROR]:{title:"Storage access blocked",description:"Browser settings or an extension are blocking access to browser storage.",fix:["Disable Private/Incognito mode and reload the page.","Disable privacy or ad-blocking extensions for this site and reload.","Open the site in a regular browser tab (not embedded)."]},[Me.QUOTA_EXCEEDED]:{title:"Storage quota exceeded",description:"The storage limit for this website has been reached.",fix:["Clear this websites stored data and reload the page.","Close other tabs for this website and try again.","Use another browser or browser profile."]},[Me.UNKNOWN]:{title:"Storage error",description:"An unexpected error occurred while accessing browser storage.",fix:["Reload the page.","Update the browser and try again.","Disable browser extensions and reload."]}},Md=t=>{if(!(t instanceof DOMException))return Me.UNKNOWN;switch(t.name){case"QuotaExceededError":return Me.QUOTA_EXCEEDED;case"SecurityError":return Me.SECURITY_ERROR;default:return Me.UNKNOWN}},Pd=t=>{if(!t)return Me.NO_STORAGE;try{const o="__vmui_test__";return t.setItem(o,"1"),t.removeItem(o),null}catch(o){return Md(o)}},Od=()=>{const{showInfoMessage:t}=Vs();return A(()=>{const o=Pd(window.localStorage);if(o){const{title:i,description:s,fix:r}=Id[o],a=e("div",{className:"vm-storage-check",children:[e("h3",{children:i}),e("p",{children:s}),!!r?.length&&e("div",{className:"vm-storage-check__fix",children:[e("div",{children:"Try this:"}),e("ul",{children:r.map((c,l)=>e("li",{children:c},`${l}-${c}`))})]})]});t({text:a,type:"error",timeout:6e5})}},[]),null},Rd=()=>{const t=Be(),{isMobile:o}=G(),{pathname:i}=Ge();return A(()=>{const a=Object.entries(bt).find(([l])=>cs(l,i))?.[1]?.title,c="UI for VictoriaLogs";document.title=a?`${a} - ${c}`:c},[i]),A(()=>{const r=Yr();(r.removed.length||r.migrated.length)&&console.info(r)},[]),e("section",{className:"vm-container",children:[e(sd,{controlsComponent:Ed}),e("div",{className:I({"vm-container-body":!0,"vm-container-body_mobile":o,"vm-container-body_app":t}),children:e(Pr,{})}),!t&&e(nd,{links:_r}),e(Od,{})]})},Mo=({filter:t,isFocusable:o,onRemove:i})=>e("div",{className:I({"vm-filters-bar-item":!0,"vm-filters-bar-item_focusable":o}),children:[t.field," ",t.operator," ",t.value,e("div",{className:"vm-filters-bar-item-actions",onClick:s=>s.stopPropagation(),children:e(R,{size:"small",color:"gray",variant:"text",startIcon:e(Ke,{}),onClick:i})})]}),Dd=()=>{const{extraFilters:t,removeFilter:o,clearFilters:i}=Oe();return t.length?e("div",{className:"vm-filters-bar vm-block",children:[e("div",{className:"vm-filters-bar-title",children:e("h2",{className:"vm-title",children:"Global filters:"})}),t.map((s,r)=>e(Mo,{filter:s,onRemove:()=>o(r)},`${s.field}_${s.value}_${r}`)),!!t.length&&e("div",{className:"vm-filters-bar__actions",children:e(R,{variant:"text",color:"error",size:"small",onClick:i,startIcon:e(St,{}),children:"Clear global filters"})})]}):null};var yr=(t=>(t.Field="field",t.FieldValue="field_value",t.StreamField="stream_field",t.StreamFieldValue="stream_field_value",t))(yr||{});const br=t=>{const[o,i]=te(),s=o.get(t)||"",r=M(a=>{i(c=>{const l=new URLSearchParams(c),n=c.get(t);return a&&a!==n?l.set(t,a):l.delete(t),l})},[i,t]);return{value:s,setValue:r}},wr=t=>{const[o,i]=te(),s=o.getAll(t),r=M(c=>{i(l=>{const n=new URLSearchParams(l),m=new Set(l.getAll(t));m.has(c)?m.delete(c):c&&m.add(c),n.delete(t);for(const d of m)n.append(t,d);return n})},[i,t]),a=M(()=>{i(c=>{const l=new URLSearchParams(c);return l.delete(t),l})},[i,t]);return{value:s,toggleValue:r,clear:a}},Mt=()=>{const{value:t,setValue:o}=br("field"),{value:i,toggleValue:s,clear:r}=wr("field_value"),a=D(!0);return A(()=>{if(a.current){a.current=!1;return}r()},[t]),{fieldFilter:t,setFieldFilter:o,fieldValueFilters:i,toggleFieldValueFilter:s}},Pt=()=>{const{value:t,setValue:o}=br("stream_field"),{value:i,toggleValue:s,clear:r}=wr("stream_field_value"),a=D(!0);return A(()=>{if(a.current){a.current=!1;return}r()},[t]),{streamFieldFilter:t,setStreamFieldFilter:o,streamFieldValueFilters:i,toggleStreamFieldValueFilter:s}},zd=()=>{const[,t]=te(),{extraFilters:o,upsertFilters:i}=Oe(),{fieldFilter:s,fieldValueFilters:r,setFieldFilter:a,toggleFieldValueFilter:c}=Mt(),{streamFieldFilter:l,streamFieldValueFilters:n,setStreamFieldFilter:m,toggleStreamFieldValueFilter:d}=Pt(),u=r.length?r:["*"],p=n.length?n:["*"],[h,g]=S(!1),f=v=>()=>{v==="*"?a():c(v)},_=v=>()=>{v==="*"?m():d(v)},y=()=>{t(v=>{const k=new URLSearchParams(v);return Object.values(yr).forEach(w=>k.delete(w)),k})},b=v=>()=>{const k=v?Z.Equals:Z.NotEquals,w=s?u.map(N=>({field:s,value:N,operator:k})):[],x=l?p.map(N=>({field:l,value:N,operator:k})):[],q=w.concat(x);i(q),g(!0)};return A(()=>{h&&(y(),g(!1))},[o]),!s&&!l?null:e("div",{className:"vm-filters-bar vm-filters-bar_preview",children:[e("div",{className:"vm-filters-bar-title",children:e("h2",{className:"vm-title",children:"Preview filters:"})}),s&&u.map(v=>e(Q,{title:"Focus: preview logs only. Doesnt change Global filters.",children:e(Mo,{isFocusable:!0,filter:{field:s,value:v,operator:Z.Equals},onRemove:f(v)},v)},v)),l&&p.map(v=>e(Q,{title:"Stream focus: preview logs only. Doesnt change Global filters.",children:e(Mo,{isFocusable:!0,filter:{field:l,value:v,operator:Z.Equals},onRemove:_(v)},v)},v)),e("div",{className:"vm-filters-bar__actions",children:[e(R,{variant:"outlined",color:"primary",onClick:b(!0),startIcon:e(We,{}),children:"Include all"}),e(R,{variant:"outlined",color:"primary",onClick:b(!1),startIcon:e(Ze,{}),children:"Exclude all"}),e(R,{variant:"outlined",color:"error",onClick:y,startIcon:e(St,{}),children:"Clear filters"})]}),e("div",{className:"vm-filters-bar__info",children:["These filters affect preview logs only. To apply them to Totals, Hits, and Fields/Streams, use ",e("b",{children:"Include All"})," or ",e("b",{children:"Exclude All"}),"."]})]})},bo=t=>t.toLocaleString("en-US"),kr=[{title:"Total logs",description:"Total number of selected logs on the selected time range",alias:"totalLogs",stats:"count()",formatter:bo},{title:"Logs/sec (avg)",description:"Average logs per second on the selected time range",alias:"logsPerSec",stats:"rate()",formatter:bo},{title:"Unique log streams",description:"The number of log streams on the selected time range",alias:"uniqueStreams",stats:"count_uniq(_stream_id)",formatter:t=>`${bo(t)}`}].map(t=>({...t,statsExpr:`${t.stats} as ${t.alias}`,description:t.description+`
\`* | ${t.stats}\``})),Hd=kr.map(t=>t.statsExpr),Vd=`* | ${Hd.join(", ")}`,Bd=()=>{const{period:t}=ce(),{extraParams:o}=Oe(),[i,s]=S(),[r,a]=S(),[c,l]=S(),{isLoading:n,error:m,fetchLogs:d,abortController:u}=Xe(Vd,1);return A(()=>{u.abort(),s(void 0),a(void 0);async function p(){try{const h=ba(t),[g,f]=await Promise.all([d({period:t,extraParams:o}),d({period:h,extraParams:o})]),[_]=g||[],[y]=f||[];s(_),a(y),l({curr:t,prev:h})}catch(h){console.error(h)}}return p(),()=>u.abort()},[t,o.toString()]),{totals:i,totalsPrev:r,periods:c,isLoading:n,error:m}},$d=({title:t,value:o,valuePrev:i,description:s,formatter:r,isLoading:a,periods:c})=>{const{curr:l,delta:n,deltaPct:m}=F(()=>{const u=Number(o??0),p=i===void 0?NaN:Number(i),h=!Number.isNaN(p),g=h?u-p:NaN,f=h&&p!==0?g/p:NaN;return{curr:u,deltaPct:Math.abs(f),delta:g}},[o,i]),d=F(()=>{if(!c?.prev)return"";const{start:u,end:p}=c.prev,h=O(u*1e3).tz().format(Ae),g=O(p*1e3).tz().format(Ae);return`${h}  ${g}`},[c]);return e("div",{className:"vm-total-card vm-block",children:[a&&e(dt,{}),e("div",{className:"vm-total-card-header",children:[e("h3",{className:"vm-total-card__title vm-title",children:t}),e(Q,{title:e("div",{className:"vm-total-card-info__text",children:s}),placement:"bottom-right",children:e("div",{className:"vm-total-card-info__icon",children:e(Kt,{})})})]}),e("div",{className:"vm-total-card-body",children:[e("div",{className:"vm-total-card__value",children:r?r(l):l}),!isNaN(m)&&!!m&&e(Q,{title:e("div",{children:[e("p",{children:"Change compared to the previous time range:"}),!!d&&e("p",{children:d})]}),children:e("div",{className:I({"vm-dynamic-number vm-total-card__delta":!0,"vm-dynamic-number_positive vm-dynamic-number_down":n<0,"vm-dynamic-number_negative vm-dynamic-number_up":n>0}),children:[(m*100).toFixed(2),"%"]})})]})]})},Ud=()=>{const{totals:t,totalsPrev:o,isLoading:i,error:s,periods:r}=Bd(),a=Jo();return A(()=>{a({type:"SET_TOTAL_LOGS",payload:Number(t?.totalLogs||0)})},[t]),e("div",{className:"vm-total-section",children:[kr.map(c=>Or($d,{...c,key:c.title,periods:r,isLoading:i,value:t?.[c.alias],valuePrev:o?.[c.alias]})),s&&e(fe,{variant:"error",children:s})]})},jd=()=>{const[t]=te(),{period:o}=ce(),i="*",{topHits:{value:s},groupFieldHits:{value:r},barsCount:{value:a}}=Et(),{extraParams:c,addNewFilter:l}=Oe(),{fetchLogHits:n,...m}=gr(),d=F(()=>!!t.get("hide_chart"),[t]);return A(()=>{d||n({period:o,extraParams:c,query:i,barsCount:a,field:r,fieldsLimit:s})},[d,o,c.toString(),s,r]),e("div",{children:e(hr,{isOverview:!0,...m,query:i,period:o,onApplyFilter:l})})},Yd=({title:t,rowsPerPage:o,enableSearch:i,onToggleShowSearch:s,onChangeRowsPerPage:r,headerControls:a})=>e("div",{className:"vm-top-fields-header",children:[e("h2",{className:"vm-title vm-top-fields-header__title",children:t}),e("div",{className:"vm-top-fields-header__configs",children:[i&&e(R,{startIcon:e(ri,{}),variant:"text",size:"small",onClick:s,children:"Search"}),a,e(ye,{limit:o,onChange:r})]})]}),Qd=({rows:t,columns:o,isLoading:i,error:s,rowsPerPage:r,isEmptyList:a,emptyListText:c,onClickRow:l,detectActiveRow:n,actionsRender:m})=>{const d=D(null),[u,p]=S(1),h=F(()=>{const f=(u-1)*r,_=f+r;return{startIndex:f,endIndex:_}},[u,r]),g=f=>{if(p(f),d.current){const _=d.current.getBoundingClientRect().top+window.scrollY-50;_<window.scrollY&&window.scrollTo({top:_})}};return A(()=>{p(1)},[t,r]),e("div",{className:"vm-top-fields-body",children:[i&&e(dt,{}),s&&e(fe,{variant:"error",children:s}),a&&e("div",{className:"vm-empty vm-top-fields-body__empty",children:c||"The list is empty."}),!a&&!i&&e(V,{children:[e("div",{className:"vm-top-fields-body__table",ref:d,children:e(Xs,{rows:t,columns:o,defaultOrderBy:"hits",defaultOrderDir:"desc",isActiveRow:n,onClickRow:l,paginationOffset:h,actionsRender:m})}),e(li,{currentPage:u,totalItems:t.length,itemsPerPage:r,onPageChange:g})]})]})},mi=({title:t,rows:o,enableSearch:i,headerControls:s,...r})=>{const[a,c]=S(10),{value:l,toggle:n}=ee(),[m,d]=S(""),u=F(()=>m?o.filter(({value:p})=>p.includes(m)):o,[m,o]);return e("div",{className:"vm-top-fields",children:[e(Yd,{title:t,rowsPerPage:a,onChangeRowsPerPage:c,enableSearch:i,headerControls:s,onToggleShowSearch:n}),l&&e("div",{className:"vm-top-fields__search",children:e(Te,{autofocus:!0,label:"Search",value:m,onChange:d,endIcon:e(Q,{title:"Filters rows in the current table only. Does not send queries to the server.",children:e(Jt,{})})})}),e(Qd,{...r,rows:u,rowsPerPage:a})]})},to=t=>({title:t,className:"vm-top-fields__cell-name",key:"value"}),oo=()=>({title:"Hits",isNum:!0,className:"vm-top-fields__cell-value",key:"hits",render:t=>Number(t.hits).toLocaleString("en-US")}),io=t=>({title:t,isNum:!0,className:"vm-top-fields__cell-percent",key:"percent",render:o=>`${(o.percent??0).toFixed(2)}%`}),Gd=[to("Field name"),oo(),io("Coverage %")],Kd=[to("Field value"),oo(),io("% of logs")],Wd=[to("Stream field name"),oo(),io("Coverage %")],Zd=[to("Stream field value"),oo(),io("% of logs")],pi=({sections:t})=>{const{value:o,toggle:i,setFalse:s}=ee(),r=D(null);return e(V,{children:[e("div",{className:"vm-top-row-menu-button",ref:r,children:e(R,{size:"small",color:"gray",variant:"text",startIcon:e(Xt,{}),onClick:c=>{c.stopPropagation(),i()}})}),e(Fe,{open:o,placement:"bottom-right",onClose:s,buttonRef:r,children:e("div",{className:"vm-top-row-menu",children:t.map((c,l)=>e("div",{className:"vm-top-row-menu-section",children:c.map(({icon:n,label:m,shortcut:d,onClick:u})=>e("div",{className:"vm-top-row-menu-item",onClick:p=>{s(),u(p)},children:[e("div",{className:"vm-top-row-menu-item__icon",children:n}),e("div",{className:"vm-top-row-menu-item__label",children:m}),d&&e("div",{className:"vm-top-row-menu-item__shortcut",children:d})]},m))},l))})})]})},Jd=()=>{const{period:{start:t,end:o}}=ce(),{fetchFieldNames:i,fieldNames:s,loading:r,error:a}=pr(),{extraParams:c,addNewFilter:l}=Oe(),{fieldFilter:n,setFieldFilter:m}=Mt(),{totalLogs:d}=lt(),u=ve(),p=F(()=>s.map(w=>{const x=d>0?w.hits/d*100:0;return{...w,percent:x}}),[s,d]),h=!r&&!a&&s.length===0,g=w=>{l({field:w.value,value:"*",operator:Z.NotEquals})},f=w=>{l({field:w.value,value:"*",operator:Z.Equals})},_=w=>{m(w.value)},y=async w=>{const x=w.value;await u(x,`\`${x}\` has been copied`)},b=(w,x)=>{const{ctrlKey:q,metaKey:N,altKey:T}=x;q||N?g(w):T?f(w):_(w)},v=w=>w.value===n;return A(()=>{i({start:t,end:o,extraParams:c})},[t,o,c.toString(),i]),e(mi,{enableSearch:!0,title:"Field names",rows:p,columns:Gd,isLoading:r,error:a,isEmptyList:h,emptyListText:"No field names found",onClickRow:b,detectActiveRow:v,actionsRender:w=>{const x=[[{label:n===w.value?"Unfocus":"Focus",icon:n===w.value?e(Tt,{}):e(At,{}),shortcut:"Click",onClick:()=>_(w)}],[{label:"Include",icon:e(We,{}),shortcut:`${mt} + Click`,onClick:()=>f(w)},{label:"Exclude",icon:e(Ze,{}),shortcut:`${He} + Click`,onClick:()=>g(w)}],[{label:"Copy",icon:e(we,{}),onClick:()=>y(w)}]];return e(pi,{sections:x})}})},Xd=(t,o,i)=>{const s=`${t}:*`;return o==="top"?`${s} | top ${i} by (${t})`:[s,`| stats by (${t}) count() as hits`,`| sort by (hits asc, ${t})`,`| limit ${i}`].filter(Boolean).join(" ")},Po={top:{title:"Top N",description:"Most common values (highest hit counts)"},bottom:{title:"Bottom N",description:"Least common values (fewest hit counts)"}},Wi=Object.keys(Po),Zi=({scope:t})=>{const{period:o}=ce(),{logs:i,isLoading:s,error:r,fetchLogs:a,abortController:c}=Xe(),{extraParams:l,addNewFilter:n}=Oe(),{fieldFilter:m,fieldValueFilters:d,toggleFieldValueFilter:u}=Mt(),{streamFieldFilter:p,streamFieldValueFilters:h,toggleStreamFieldValueFilter:g}=Pt(),{totalLogs:f}=lt(),_=ve(),y=t==="field"?m:p,b=t==="field"?d:h,v=t==="field"?u:g,[k,w]=S(Wi[0]),[x,q]=S(10),N=F(()=>i.map(H=>{const P=Number(H.hits)||0;return{hits:P,value:H[y],percent:f>0?P/f*100:0}}),[y,i,f]),T=!s&&!r&&N.length===0||!y,C=y?"No values found":`Select ${t==="field"?"field":"stream field"} name to see values`,L=(H,P)=>{n({field:y,value:H.value,operator:P})},E=H=>{v(H.value)},z=async H=>{const P=`${y}:${H.value}`;await _(P,`\`${P}\` has been copied`)},U=(H,P)=>{const{ctrlKey:B,metaKey:$,altKey:j}=P;B||$?L(H,Z.NotEquals):j?L(H,Z.Equals):E(H)},Y=H=>b.includes(H.value);A(()=>{if(!y)return;const H=Xd(y,k,x);return a({period:o,extraParams:l,limit:x,query:H}),()=>c.abort()},[o,l.toString(),y,x,k]);const W=H=>{const P=[[{label:b.includes(H.value)?"Unfocus":"Focus",icon:b.includes(H.value)?e(Tt,{}):e(At,{}),shortcut:"Click",onClick:()=>E(H)}],[{label:"Include",icon:e(We,{}),shortcut:`${mt} + Click`,onClick:()=>L(H,Z.Equals)},{label:"Exclude",icon:e(Ze,{}),shortcut:`${He} + Click`,onClick:()=>L(H,Z.NotEquals)}],[{label:"Copy",icon:e(we,{}),onClick:()=>z(H)}]];return e(pi,{sections:P})},K=e(V,{children:[e(ye,{label:"Mode",limit:k,options:Wi,onChange:H=>w(H),renderOptionLabel:(H,P)=>P?e("span",{className:"vm-top-fields-option__label",children:H}):e("div",{className:"vm-top-fields-option",children:[e("span",{className:"vm-top-fields-option__label",children:H}),e("span",{className:"vm-top-fields-option__info",children:Po[H].description})]})}),e(ye,{label:Po[k].title,limit:x,onChange:q})]});return e(mi,{enableSearch:!0,title:e(V,{children:["Field values: ",e("b",{children:["`",y,"`"]})]}),rows:N,columns:t==="field"?Kd:Zd,isLoading:s,error:r,isEmptyList:T,emptyListText:C,onClickRow:U,headerControls:K,actionsRender:W,detectActiveRow:Y})},em=()=>{const{serverUrl:t}=se(),{streamsFieldNames:o,streamsFieldNamesParamsKey:i}=lt(),s=Jo(),r=Je(),[a,c]=S([]),[l,n]=S(!1),[m,d]=S(""),u=M(async p=>{n(!0),d("");try{const h=new URLSearchParams({start:p.start.toString(),end:p.end.toString(),query:p.query||"*"}),g=new URLSearchParams([...h,...p.extraParams??[]]),f={...r},y=g.toString()+JSON.stringify(r);if(i===y){c(o),n(!1);return}const b=`${t}/select/logsql/stream_field_names`,v=await fetch(b,{method:"POST",headers:f,body:g});if(!v.ok){const w=await v.text(),x=`${v.status} ${v.statusText}: ${w}`;console.error(x),d(x);return}const k=await v.json();c(k.values),s({type:"SET_STREAM_FIELD_NAMES",payload:{rows:k.values,key:y}})}catch(h){console.error(h),d(h)}finally{n(!1)}},[t,r,i,o]);return{streamFieldNames:a,loading:l,error:m,fetchStreamFieldNames:u}},tm=()=>{const{period:{start:t,end:o}}=ce(),{fetchStreamFieldNames:i,streamFieldNames:s,loading:r,error:a}=em(),{extraParams:c,addNewFilter:l}=Oe(),{streamFieldFilter:n,setStreamFieldFilter:m}=Pt(),{totalLogs:d}=lt(),u=ve(),p=F(()=>s.map(w=>{const x=d>0?w.hits/d*100:0;return{...w,percent:x}}),[s,d]),h=!r&&!a&&s.length===0,g=w=>{l({field:w.value,value:"*",operator:Z.NotEquals})},f=w=>{l({field:w.value,value:"*",operator:Z.Equals})},_=w=>{m(w.value)},y=async w=>{const x=w.value;await u(x,`\`${x}\` has been copied`)},b=(w,x)=>{const{ctrlKey:q,metaKey:N,altKey:T}=x;q||N?g(w):T?f(w):_(w)},v=w=>w.value===n;return A(()=>{i({start:t,end:o,extraParams:c})},[t,o,c.toString(),i]),e(mi,{enableSearch:!0,title:"Stream field names",rows:p,columns:Wd,isLoading:r,error:a,isEmptyList:h,emptyListText:"No field names found",onClickRow:b,detectActiveRow:v,actionsRender:w=>{const x=[[{label:n===w.value?"Unfocus":"Focus",icon:n===w.value?e(Tt,{}):e(At,{}),shortcut:"Click",onClick:()=>_(w)}],[{label:"Include",icon:e(We,{}),shortcut:`${mt} + Click`,onClick:()=>f(w)},{label:"Exclude",icon:e(Ze,{}),shortcut:`${He} + Click`,onClick:()=>g(w)}],[{label:"Copy",icon:e(we,{}),onClick:()=>y(w)}]];return e(pi,{sections:x})}})},Ji=t=>t.toLocaleString("en-US"),Xi=t=>t==null?"-":t>=1?t.toFixed(1)+"%":t>=.01?t.toFixed(2)+"%":"<0.01%",om=[{key:"distinct",title:"Distinct",description:({field:t})=>`Number of unique values of \`${t}\`.
Shows value variety (cardinality).
\`${t}:* | stats count_uniq(${t})\`.`,format:t=>Ji(t||0)},{key:"ratio",title:"Distinct ratio",description:({field:t})=>`Share of unique values of \`${t}\`.
Helps spot high-cardinality fields.
\`distinct / coverage  100\``,format:t=>Xi(t)},{key:"coverage",title:"Coverage",description:({field:t})=>`Total logs containing \`${t}\`.
Shows how often the field appears.
\`${t}:* | stats count()\`.`,format:t=>Ji(t||0)},{key:"coverageOfTotal",title:"Coverage %",description:({field:t})=>`Percent of all logs with \`${t}\`.
Useful to compare across datasets.
\`coverage / total  100\``,format:t=>Xi(t)}],es=({scope:t})=>{const{totalLogs:o,fieldNames:i,streamsFieldNames:s}=lt(),{fieldFilter:r}=Mt(),{streamFieldFilter:a}=Pt(),c=t==="field"?r:a,l=t==="field"?i:s,{period:n}=ce(),{logs:m,isLoading:d,error:u,fetchLogs:p,abortController:h}=Xe(),{extraParams:g}=Oe(),_=l.find(b=>b.value===c)?.hits||0,y=F(()=>{const b=m?.[0],v=Number(b?.distinct??0),k=_>0?v/_*100:null,w=o>0?_/o*100:null;return{distinct:v,coverage:_,ratio:k,coverageOfTotal:w}},[m,o,c,_]);return A(()=>{if(!c)return;const b=`${c}:* | stats count_uniq(${c}) as distinct`;return p({period:n,extraParams:g,query:b}),()=>h.abort()},[n,g.toString(),c,t]),c?e("div",{className:"vm-cardinality-card",children:[d&&e(dt,{}),u&&e(fe,{variant:"error",children:u}),e("div",{className:"vm-top-fields-header",children:[e("h2",{className:"vm-title vm-top-fields-header__title",children:[t==="stream"?"Stream field":"Field"," cardinality: ",e("b",{children:["`",c,"`"]})]}),e("div",{className:"vm-top-fields-header__configs"})]}),e("div",{className:"vm-cardinality-card-body",children:om.map(b=>e(Q,{title:e("div",{className:"vm-cardinality-card-body-item__description",children:b.description({field:c})}),placement:"bottom-right",children:e("div",{className:"vm-cardinality-card-body-item",children:[e("span",{className:"vm-cardinality-card-body-item__title",children:b.title}),e("span",{className:"vm-cardinality-card-body-item__value",children:b.format(y[b.key])})]})},b.key))})]}):null},im=()=>e("a",{href:"https://docs.victoriametrics.com/victorialogs/querying/#querying-field-names",target:"_blank",rel:"noopener noreferrer",children:"Querying field names"}),sm=()=>e("a",{href:"https://docs.victoriametrics.com/victorialogs/querying/#querying-stream-field-names",target:"_blank",rel:"noopener noreferrer",children:"Querying stream field names"}),rm=()=>e("div",{className:"vm-overview-fields-tour-content vm-markdown",children:[e("p",{children:["This view helps you spot ",e("strong",{children:"noisy"})," and ",e("strong",{children:"rare"})," fields/streams and their",e("strong",{children:" values"}),", and quickly filter the rest."]}),e("hr",{}),e("h2",{children:"Names table"}),e("p",{children:["Shows field or stream ",e("strong",{children:"names"})," and the number of logs per name.",e("br",{}),"Docs: ",e(im,{})," and ",e(sm,{})]}),e("h3",{children:"Columns"}),e("ul",{children:[e("li",{children:[e("strong",{children:"Hits"}),"  number of logs that contain this name (API result)."]}),e("li",{children:[e("strong",{children:"Coverage %"}),"  percentage of all logs: ",e("code",{children:"hits / total  100"}),"."]})]}),e("h3",{children:"Click behavior"}),e("ul",{children:[e("li",{children:"Click a row  selects the name and focuses it (adds a blue filter badge)."}),e("li",{children:[e("strong",{children:[He," + Click"]}),"  applies ",e("strong",{children:"Exclude"})," immediately."]}),e("li",{children:["See ",e("strong",{children:"Row actions"})," for more options."]})]}),e("hr",{}),e("h2",{children:"Values table"}),e("p",{children:["Shows ",e("strong",{children:"Top/Bottom N"})," ",e("strong",{children:"values"})," for the selected name and the number of logs per value."]}),e("h3",{children:"Selectors"}),e("ul",{children:[e("li",{children:[e("strong",{children:"Mode"}),"  ",e("code",{children:"Top"})," or ",e("code",{children:"Bottom"}),"."]}),e("li",{children:[e("strong",{children:"Top N"}),"  how many values to fetch. These controls directly change the query and results."]})]}),e("h3",{children:"Columns"}),e("ul",{children:[e("li",{children:[e("strong",{children:"Hits"}),"  count for the specific value."]}),e("li",{children:[e("strong",{children:"% of logs"}),"  percentage of all logs: ",e("code",{children:"hits / total  100"}),"."]})]}),e("h3",{children:"Click behavior"}),e("ul",{children:[e("li",{children:"Click a row  focuses the value (adds a blue filter badge)."}),e("li",{children:[e("strong",{children:[He," + Click"]}),"  applies ",e("strong",{children:"Exclude"})," immediately."]}),e("li",{children:["See ",e("strong",{children:"Row actions"}),"."]})]}),e("hr",{}),e("h2",{id:"row-actions",children:"Row actions"}),e("ul",{children:[e("li",{children:[e("strong",{children:"Focus"}),"  adds a ",e("strong",{children:"blue filter badge"})," and updates ",e("strong",{children:"Preview logs"}),". Does ",e("strong",{children:"not"})," change global filters."]}),e("li",{children:[e("strong",{children:"Include"}),"  adds a ",e("strong",{children:"global include filter"})," (gray badge) for the selected item."]}),e("li",{children:[e("strong",{children:"Exclude"}),"  adds a ",e("strong",{children:"global exclude filter"})," (gray badge) for the selected item."]}),e("li",{children:[e("strong",{children:"Copy"}),"  copies the selected ",e("strong",{children:"name"})," (from ",e("em",{children:"Names"}),") or the",e("strong",{children:" namevalue"})," pair (from ",e("em",{children:"Values"}),")."]})]}),e("p",{children:[e("strong",{children:"Note:"})," ",e("strong",{children:"Include/Exclude"})," appear as ",e("strong",{children:"gray badges"})," in",e("strong",{children:" Global filters"})," and affect ",e("strong",{children:"all queries on this page"})," until removed."]}),e("hr",{}),e("p",{children:e("em",{children:["* Search and sorting are local (client-side) in both ",e("strong",{children:"Names"})," and ",e("strong",{children:"Values"})," tables."]})})]}),am=()=>{const{value:t,setTrue:o,setFalse:i}=ee();return e(V,{children:[e(R,{startIcon:e(Jt,{}),variant:"text",onClick:o,children:"How it works"}),t&&e(ke,{title:"Fields & Streams Overview",onClose:i,children:e("div",{className:"vm-overview-fields-tour",children:e(rm,{})})})]})},wo=[{label:"Fields",value:"fields",component:e("div",{className:"vm-top-fields-row",children:[e(Jd,{}),e("div",{children:[e(es,{scope:"field"}),e(Zi,{scope:"field"})]})]})},{label:"Streams",value:"streams",component:e("div",{className:"vm-top-fields-row",children:[e(tm,{}),e("div",{children:[e(es,{scope:"stream"}),e(Zi,{scope:"stream"})]})]})}],cm=()=>{const[t,o]=S(wo[0].value);return e("div",{className:"vm-explorer-page-panel vm-block",children:[e("div",{className:"vm-section-header vm-explorer-page-panel-header",children:[e("div",{className:"vm-section-header__tabs",children:e(ni,{activeItem:t,items:wo,onChange:o})}),e("div",{children:e(am,{})})]}),wo.map(i=>e("div",{className:I({"vm-explorer-page-panel-content":!0,"vm-explorer-page-panel-content_active":i.value===t}),children:i.component},i.value))]})},ts=Z.Equals,os=(t,o)=>{const i=o.map(s=>`"${mr(s)}"`);return`${t}:in(
${i.join(`,
`)}
)`},nm=()=>{const[t]=te(),{period:o,relativeTime:i,duration:s}=ce(),{logs:r,isLoading:a,error:c,fetchLogs:l,abortController:n}=Xe(),{extraParams:m}=Oe(),{fieldFilter:d,fieldValueFilters:u}=Mt(),{streamFieldFilter:p,streamFieldValueFilters:h}=Pt(),g=ve(),[f,_]=S(!1),[y,b]=S(10),v=F(()=>!!t.get("hide_logs"),[t]),k=F(()=>{const q=[];if(p&&h.length){const L=os(p,h);q.push(L)}else if(p){const L=jt({field:p,value:"*",operator:ts});q.push(L)}if(d&&u.length){const L=os(d,u);q.push(L)}else if(d){const L=jt({field:d,value:"*",operator:ts});q.push(L)}const N=m.getAll("extra_filters"),T=m.getAll("extra_stream_filters"),C=N.concat(T);return C.length&&q.push(...C),q.length?q.join(`
`):"*"},[o,d,u,p,h,m]),w=F(()=>{const q=new URLSearchParams({query:k,"g0.range_input":s,"g0.end_input":o.date,"g0.relative_time":i||"none"});return`${pe.home}?${q.toString()}`},[k,s,i]),x=async()=>{await g(k,"Query has been copied"),_(!0)};return A(()=>{n.abort(),!v&&l({query:k,period:o,limit:y})},[k,y,v]),A(()=>{if(f===null)return;const q=setTimeout(()=>_(!1),2e3);return()=>clearTimeout(q)},[f]),e("div",{className:"vm-overview-logs vm-block",children:[e("div",{className:"vm-overview-logs-header",children:[e("span",{className:"vm-title",children:"Query:"}),e("div",{className:"vm-overview-logs-query",children:e("p",{className:"vm-overview-logs-query__expr",children:k})}),e("div",{className:"vm-overview-logs-header__actions",children:[e(ye,{label:"Limit",limit:y,onChange:b}),e(R,{size:"small",variant:"text",startIcon:f?e(Ct,{}):e(we,{}),onClick:x,children:f?"Copied":"Copy query"}),e(rs,{to:w,target:"_blank",rel:"noreferrer",children:e(R,{size:"small",variant:"text",startIcon:e(ai,{}),children:"Open query"})})]})]}),e("div",{children:[c&&e(fe,{variant:"error",children:c}),!c&&e(or,{isPreview:!0,data:r,isLoading:a})]})]})},lm=()=>{const{duration:t,relativeTime:o,period:i}=ce(),{setSearchParamsFromKeys:s}=Lt();return A(()=>{s({"g0.range_input":t,"g0.end_input":i.date,"g0.relative_time":o||"none"})},[t,i.date,o]),e("div",{className:"vm-explorer-page",children:[e(Dd,{}),e(Ud,{}),e(jd,{}),e(cm,{}),e(zd,{}),e(nm,{})]})},dm=()=>{const{_stream_id:t,_time:o}=Rr(),[i]=te(),s=i.get(oe.DISPLAY_FIELDS)||it,r=F(()=>s.split(","),[s]);return!t||!o?e("div",{children:"Error: Missing stream ID or time."}):e("div",{className:"vm-stream-context-page",children:e(Zs,{log:{_stream_id:t,_time:o,_msg:"",_stream:""},displayFields:r})})};function mm(t){const{emojis:o}=t;if(!o)throw new Error("Must provide emojis to markedEmoji");const i=Object.keys(o).map(a=>a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|");if(i.length===0)throw new Error("Emoji list is empty; provide at least one emoji.");const s=new RegExp(`:(${i}):`),r=new RegExp(`^${s.source}`);return{extensions:[{name:"emoji",level:"inline",start(a){return a.match(s)?.index},tokenizer(a){const c=r.exec(a);if(!c)return;const l=c[1],n=o[l];if(n)return{type:"emoji",raw:c[0],name:l,emoji:n}},renderer(a){return t.renderer(a)}}]}}const pm={100:"",1234:"",grinning:"",smiley:"",smile:"",grin:"",laughing:"",satisfied:"",sweat_smile:"",rofl:"",joy:"",slightly_smiling_face:"",upside_down_face:"",melting_face:"",wink:"",blush:"",innocent:"",smiling_face_with_three_hearts:"",heart_eyes:"",star_struck:"",kissing_heart:"",kissing:"",relaxed:"",kissing_closed_eyes:"",kissing_smiling_eyes:"",smiling_face_with_tear:"",yum:"",stuck_out_tongue:"",stuck_out_tongue_winking_eye:"",zany_face:"",stuck_out_tongue_closed_eyes:"",money_mouth_face:"",hugs:"",hand_over_mouth:"",face_with_open_eyes_and_hand_over_mouth:"",face_with_peeking_eye:"",shushing_face:"",thinking:"",saluting_face:"",zipper_mouth_face:"",raised_eyebrow:"",neutral_face:"",expressionless:"",no_mouth:"",dotted_line_face:"",face_in_clouds:"",smirk:"",unamused:"",roll_eyes:"",grimacing:"",face_exhaling:"",lying_face:"",shaking_face:"",relieved:"",pensive:"",sleepy:"",drooling_face:"",sleeping:"",mask:"",face_with_thermometer:"",face_with_head_bandage:"",nauseated_face:"",vomiting_face:"",sneezing_face:"",hot_face:"",cold_face:"",woozy_face:"",dizzy_face:"",face_with_spiral_eyes:"",exploding_head:"",cowboy_hat_face:"",partying_face:"",disguised_face:"",sunglasses:"",nerd_face:"",monocle_face:"",confused:"",face_with_diagonal_mouth:"",worried:"",slightly_frowning_face:"",frowning_face:"",open_mouth:"",hushed:"",astonished:"",flushed:"",pleading_face:"",face_holding_back_tears:"",frowning:"",anguished:"",fearful:"",cold_sweat:"",disappointed_relieved:"",cry:"",sob:"",scream:"",confounded:"",persevere:"",disappointed:"",sweat:"",weary:"",tired_face:"",yawning_face:"",triumph:"",rage:"",pout:"",angry:"",cursing_face:"",smiling_imp:"",imp:"",skull:"",skull_and_crossbones:"",hankey:"",poop:"",shit:"",clown_face:"",japanese_ogre:"",japanese_goblin:"",ghost:"",alien:"",space_invader:"",robot:"",smiley_cat:"",smile_cat:"",joy_cat:"",heart_eyes_cat:"",smirk_cat:"",kissing_cat:"",scream_cat:"",crying_cat_face:"",pouting_cat:"",see_no_evil:"",hear_no_evil:"",speak_no_evil:"",love_letter:"",cupid:"",gift_heart:"",sparkling_heart:"",heartpulse:"",heartbeat:"",revolving_hearts:"",two_hearts:"",heart_decoration:"",heavy_heart_exclamation:"",broken_heart:"",heart_on_fire:"",mending_heart:"",heart:"",pink_heart:"",orange_heart:"",yellow_heart:"",green_heart:"",blue_heart:"",light_blue_heart:"",purple_heart:"",brown_heart:"",black_heart:"",grey_heart:"",white_heart:"",kiss:"",anger:"",boom:"",collision:"",dizzy:"",sweat_drops:"",dash:"",hole:"",speech_balloon:"",eye_speech_bubble:"",left_speech_bubble:"",right_anger_bubble:"",thought_balloon:"",zzz:"",wave:"",raised_back_of_hand:"",raised_hand_with_fingers_splayed:"",hand:"",raised_hand:"",vulcan_salute:"",rightwards_hand:"",leftwards_hand:"",palm_down_hand:"",palm_up_hand:"",leftwards_pushing_hand:"",rightwards_pushing_hand:"",ok_hand:"",pinched_fingers:"",pinching_hand:"",v:"",crossed_fingers:"",hand_with_index_finger_and_thumb_crossed:"",love_you_gesture:"",metal:"",call_me_hand:"",point_left:"",point_right:"",point_up_2:"",middle_finger:"",fu:"",point_down:"",point_up:"",index_pointing_at_the_viewer:"","+1":"",thumbsup:"","-1":"",thumbsdown:"",fist_raised:"",fist:"",fist_oncoming:"",facepunch:"",punch:"",fist_left:"",fist_right:"",clap:"",raised_hands:"",heart_hands:"",open_hands:"",palms_up_together:"",handshake:"",pray:"",writing_hand:"",nail_care:"",selfie:"",muscle:"",mechanical_arm:"",mechanical_leg:"",leg:"",foot:"",ear:"",ear_with_hearing_aid:"",nose:"",brain:"",anatomical_heart:"",lungs:"",tooth:"",bone:"",eyes:"",eye:"",tongue:"",lips:"",biting_lip:"",baby:"",child:"",boy:"",girl:"",adult:"",blond_haired_person:"",man:"",bearded_person:"",man_beard:"",woman_beard:"",red_haired_man:"",curly_haired_man:"",white_haired_man:"",bald_man:"",woman:"",red_haired_woman:"",person_red_hair:"",curly_haired_woman:"",person_curly_hair:"",white_haired_woman:"",person_white_hair:"",bald_woman:"",person_bald:"",blond_haired_woman:"",blonde_woman:"",blond_haired_man:"",older_adult:"",older_man:"",older_woman:"",frowning_person:"",frowning_man:"",frowning_woman:"",pouting_face:"",pouting_man:"",pouting_woman:"",no_good:"",no_good_man:"",ng_man:"",no_good_woman:"",ng_woman:"",ok_person:"",ok_man:"",ok_woman:"",tipping_hand_person:"",information_desk_person:"",tipping_hand_man:"",sassy_man:"",tipping_hand_woman:"",sassy_woman:"",raising_hand:"",raising_hand_man:"",raising_hand_woman:"",deaf_person:"",deaf_man:"",deaf_woman:"",bow:"",bowing_man:"",bowing_woman:"",facepalm:"",man_facepalming:"",woman_facepalming:"",shrug:"",man_shrugging:"",woman_shrugging:"",health_worker:"",man_health_worker:"",woman_health_worker:"",student:"",man_student:"",woman_student:"",teacher:"",man_teacher:"",woman_teacher:"",judge:"",man_judge:"",woman_judge:"",farmer:"",man_farmer:"",woman_farmer:"",cook:"",man_cook:"",woman_cook:"",mechanic:"",man_mechanic:"",woman_mechanic:"",factory_worker:"",man_factory_worker:"",woman_factory_worker:"",office_worker:"",man_office_worker:"",woman_office_worker:"",scientist:"",man_scientist:"",woman_scientist:"",technologist:"",man_technologist:"",woman_technologist:"",singer:"",man_singer:"",woman_singer:"",artist:"",man_artist:"",woman_artist:"",pilot:"",man_pilot:"",woman_pilot:"",astronaut:"",man_astronaut:"",woman_astronaut:"",firefighter:"",man_firefighter:"",woman_firefighter:"",police_officer:"",cop:"",policeman:"",policewoman:"",detective:"",male_detective:"",female_detective:"",guard:"",guardsman:"",guardswoman:"",ninja:"",construction_worker:"",construction_worker_man:"",construction_worker_woman:"",person_with_crown:"",prince:"",princess:"",person_with_turban:"",man_with_turban:"",woman_with_turban:"",man_with_gua_pi_mao:"",woman_with_headscarf:"",person_in_tuxedo:"",man_in_tuxedo:"",woman_in_tuxedo:"",person_with_veil:"",man_with_veil:"",woman_with_veil:"",bride_with_veil:"",pregnant_woman:"",pregnant_man:"",pregnant_person:"",breast_feeding:"",woman_feeding_baby:"",man_feeding_baby:"",person_feeding_baby:"",angel:"",santa:"",mrs_claus:"",mx_claus:"",superhero:"",superhero_man:"",superhero_woman:"",supervillain:"",supervillain_man:"",supervillain_woman:"",mage:"",mage_man:"",mage_woman:"",fairy:"",fairy_man:"",fairy_woman:"",vampire:"",vampire_man:"",vampire_woman:"",merperson:"",merman:"",mermaid:"",elf:"",elf_man:"",elf_woman:"",genie:"",genie_man:"",genie_woman:"",zombie:"",zombie_man:"",zombie_woman:"",troll:"",massage:"",massage_man:"",massage_woman:"",haircut:"",haircut_man:"",haircut_woman:"",walking:"",walking_man:"",walking_woman:"",standing_person:"",standing_man:"",standing_woman:"",kneeling_person:"",kneeling_man:"",kneeling_woman:"",person_with_probing_cane:"",man_with_probing_cane:"",woman_with_probing_cane:"",person_in_motorized_wheelchair:"",man_in_motorized_wheelchair:"",woman_in_motorized_wheelchair:"",person_in_manual_wheelchair:"",man_in_manual_wheelchair:"",woman_in_manual_wheelchair:"",runner:"",running:"",running_man:"",running_woman:"",woman_dancing:"",dancer:"",man_dancing:"",business_suit_levitating:"",dancers:"",dancing_men:"",dancing_women:"",sauna_person:"",sauna_man:"",sauna_woman:"",climbing:"",climbing_man:"",climbing_woman:"",person_fencing:"",horse_racing:"",skier:"",snowboarder:"",golfing:"",golfing_man:"",golfing_woman:"",surfer:"",surfing_man:"",surfing_woman:"",rowboat:"",rowing_man:"",rowing_woman:"",swimmer:"",swimming_man:"",swimming_woman:"",bouncing_ball_person:"",bouncing_ball_man:"",basketball_man:"",bouncing_ball_woman:"",basketball_woman:"",weight_lifting:"",weight_lifting_man:"",weight_lifting_woman:"",bicyclist:"",biking_man:"",biking_woman:"",mountain_bicyclist:"",mountain_biking_man:"",mountain_biking_woman:"",cartwheeling:"",man_cartwheeling:"",woman_cartwheeling:"",wrestling:"",men_wrestling:"",women_wrestling:"",water_polo:"",man_playing_water_polo:"",woman_playing_water_polo:"",handball_person:"",man_playing_handball:"",woman_playing_handball:"",juggling_person:"",man_juggling:"",woman_juggling:"",lotus_position:"",lotus_position_man:"",lotus_position_woman:"",bath:"",sleeping_bed:"",people_holding_hands:"",two_women_holding_hands:"",couple:"",two_men_holding_hands:"",couplekiss:"",couplekiss_man_woman:"",couplekiss_man_man:"",couplekiss_woman_woman:"",couple_with_heart:"",couple_with_heart_woman_man:"",couple_with_heart_man_man:"",couple_with_heart_woman_woman:"",family:"",family_man_woman_boy:"",family_man_woman_girl:"",family_man_woman_girl_boy:"",family_man_woman_boy_boy:"",family_man_woman_girl_girl:"",family_man_man_boy:"",family_man_man_girl:"",family_man_man_girl_boy:"",family_man_man_boy_boy:"",family_man_man_girl_girl:"",family_woman_woman_boy:"",family_woman_woman_girl:"",family_woman_woman_girl_boy:"",family_woman_woman_boy_boy:"",family_woman_woman_girl_girl:"",family_man_boy:"",family_man_boy_boy:"",family_man_girl:"",family_man_girl_boy:"",family_man_girl_girl:"",family_woman_boy:"",family_woman_boy_boy:"",family_woman_girl:"",family_woman_girl_boy:"",family_woman_girl_girl:"",speaking_head:"",bust_in_silhouette:"",busts_in_silhouette:"",people_hugging:"",footprints:"",monkey_face:"",monkey:"",gorilla:"",orangutan:"",dog:"",dog2:"",guide_dog:"",service_dog:"",poodle:"",wolf:"",fox_face:"",raccoon:"",cat:"",cat2:"",black_cat:"",lion:"",tiger:"",tiger2:"",leopard:"",horse:"",moose:"",donkey:"",racehorse:"",unicorn:"",zebra:"",deer:"",bison:"",cow:"",ox:"",water_buffalo:"",cow2:"",pig:"",pig2:"",boar:"",pig_nose:"",ram:"",sheep:"",goat:"",dromedary_camel:"",camel:"",llama:"",giraffe:"",elephant:"",mammoth:"",rhinoceros:"",hippopotamus:"",mouse:"",mouse2:"",rat:"",hamster:"",rabbit:"",rabbit2:"",chipmunk:"",beaver:"",hedgehog:"",bat:"",bear:"",polar_bear:"",koala:"",panda_face:"",sloth:"",otter:"",skunk:"",kangaroo:"",badger:"",feet:"",paw_prints:"",turkey:"",chicken:"",rooster:"",hatching_chick:"",baby_chick:"",hatched_chick:"",bird:"",penguin:"",dove:"",eagle:"",duck:"",swan:"",owl:"",dodo:"",feather:"",flamingo:"",peacock:"",parrot:"",wing:"",black_bird:"",goose:"",frog:"",crocodile:"",turtle:"",lizard:"",snake:"",dragon_face:"",dragon:"",sauropod:"","t-rex":"",whale:"",whale2:"",dolphin:"",flipper:"",seal:"",fish:"",tropical_fish:"",blowfish:"",shark:"",octopus:"",shell:"",coral:"",jellyfish:"",snail:"",butterfly:"",bug:"",ant:"",bee:"",honeybee:"",beetle:"",lady_beetle:"",cricket:"",cockroach:"",spider:"",spider_web:"",scorpion:"",mosquito:"",fly:"",worm:"",microbe:"",bouquet:"",cherry_blossom:"",white_flower:"",lotus:"",rosette:"",rose:"",wilted_flower:"",hibiscus:"",sunflower:"",blossom:"",tulip:"",hyacinth:"",seedling:"",potted_plant:"",evergreen_tree:"",deciduous_tree:"",palm_tree:"",cactus:"",ear_of_rice:"",herb:"",shamrock:"",four_leaf_clover:"",maple_leaf:"",fallen_leaf:"",leaves:"",empty_nest:"",nest_with_eggs:"",mushroom:"",grapes:"",melon:"",watermelon:"",tangerine:"",orange:"",mandarin:"",lemon:"",banana:"",pineapple:"",mango:"",apple:"",green_apple:"",pear:"",peach:"",cherries:"",strawberry:"",blueberries:"",kiwi_fruit:"",tomato:"",olive:"",coconut:"",avocado:"",eggplant:"",potato:"",carrot:"",corn:"",hot_pepper:"",bell_pepper:"",cucumber:"",leafy_green:"",broccoli:"",garlic:"",onion:"",peanuts:"",beans:"",chestnut:"",ginger_root:"",pea_pod:"",bread:"",croissant:"",baguette_bread:"",flatbread:"",pretzel:"",bagel:"",pancakes:"",waffle:"",cheese:"",meat_on_bone:"",poultry_leg:"",cut_of_meat:"",bacon:"",hamburger:"",fries:"",pizza:"",hotdog:"",sandwich:"",taco:"",burrito:"",tamale:"",stuffed_flatbread:"",falafel:"",egg:"",fried_egg:"",shallow_pan_of_food:"",stew:"",fondue:"",bowl_with_spoon:"",green_salad:"",popcorn:"",butter:"",salt:"",canned_food:"",bento:"",rice_cracker:"",rice_ball:"",rice:"",curry:"",ramen:"",spaghetti:"",sweet_potato:"",oden:"",sushi:"",fried_shrimp:"",fish_cake:"",moon_cake:"",dango:"",dumpling:"",fortune_cookie:"",takeout_box:"",crab:"",lobster:"",shrimp:"",squid:"",oyster:"",icecream:"",shaved_ice:"",ice_cream:"",doughnut:"",cookie:"",birthday:"",cake:"",cupcake:"",pie:"",chocolate_bar:"",candy:"",lollipop:"",custard:"",honey_pot:"",baby_bottle:"",milk_glass:"",coffee:"",teapot:"",tea:"",sake:"",champagne:"",wine_glass:"",cocktail:"",tropical_drink:"",beer:"",beers:"",clinking_glasses:"",tumbler_glass:"",pouring_liquid:"",cup_with_straw:"",bubble_tea:"",beverage_box:"",mate:"",ice_cube:"",chopsticks:"",plate_with_cutlery:"",fork_and_knife:"",spoon:"",hocho:"",knife:"",jar:"",amphora:"",earth_africa:"",earth_americas:"",earth_asia:"",globe_with_meridians:"",world_map:"",japan:"",compass:"",mountain_snow:"",mountain:"",volcano:"",mount_fuji:"",camping:"",beach_umbrella:"",desert:"",desert_island:"",national_park:"",stadium:"",classical_building:"",building_construction:"",bricks:"",rock:"",wood:"",hut:"",houses:"",derelict_house:"",house:"",house_with_garden:"",office:"",post_office:"",european_post_office:"",hospital:"",bank:"",hotel:"",love_hotel:"",convenience_store:"",school:"",department_store:"",factory:"",japanese_castle:"",european_castle:"",wedding:"",tokyo_tower:"",statue_of_liberty:"",church:"",mosque:"",hindu_temple:"",synagogue:"",shinto_shrine:"",kaaba:"",fountain:"",tent:"",foggy:"",night_with_stars:"",cityscape:"",sunrise_over_mountains:"",sunrise:"",city_sunset:"",city_sunrise:"",bridge_at_night:"",hotsprings:"",carousel_horse:"",playground_slide:"",ferris_wheel:"",roller_coaster:"",barber:"",circus_tent:"",steam_locomotive:"",railway_car:"",bullettrain_side:"",bullettrain_front:"",train2:"",metro:"",light_rail:"",station:"",tram:"",monorail:"",mountain_railway:"",train:"",bus:"",oncoming_bus:"",trolleybus:"",minibus:"",ambulance:"",fire_engine:"",police_car:"",oncoming_police_car:"",taxi:"",oncoming_taxi:"",car:"",red_car:"",oncoming_automobile:"",blue_car:"",pickup_truck:"",truck:"",articulated_lorry:"",tractor:"",racing_car:"",motorcycle:"",motor_scooter:"",manual_wheelchair:"",motorized_wheelchair:"",auto_rickshaw:"",bike:"",kick_scooter:"",skateboard:"",roller_skate:"",busstop:"",motorway:"",railway_track:"",oil_drum:"",fuelpump:"",wheel:"",rotating_light:"",traffic_light:"",vertical_traffic_light:"",stop_sign:"",construction:"",anchor:"",ring_buoy:"",boat:"",sailboat:"",canoe:"",speedboat:"",passenger_ship:"",ferry:"",motor_boat:"",ship:"",airplane:"",small_airplane:"",flight_departure:"",flight_arrival:"",parachute:"",seat:"",helicopter:"",suspension_railway:"",mountain_cableway:"",aerial_tramway:"",artificial_satellite:"",rocket:"",flying_saucer:"",bellhop_bell:"",luggage:"",hourglass:"",hourglass_flowing_sand:"",watch:"",alarm_clock:"",stopwatch:"",timer_clock:"",mantelpiece_clock:"",clock12:"",clock1230:"",clock1:"",clock130:"",clock2:"",clock230:"",clock3:"",clock330:"",clock4:"",clock430:"",clock5:"",clock530:"",clock6:"",clock630:"",clock7:"",clock730:"",clock8:"",clock830:"",clock9:"",clock930:"",clock10:"",clock1030:"",clock11:"",clock1130:"",new_moon:"",waxing_crescent_moon:"",first_quarter_moon:"",moon:"",waxing_gibbous_moon:"",full_moon:"",waning_gibbous_moon:"",last_quarter_moon:"",waning_crescent_moon:"",crescent_moon:"",new_moon_with_face:"",first_quarter_moon_with_face:"",last_quarter_moon_with_face:"",thermometer:"",sunny:"",full_moon_with_face:"",sun_with_face:"",ringed_planet:"",star:"",star2:"",stars:"",milky_way:"",cloud:"",partly_sunny:"",cloud_with_lightning_and_rain:"",sun_behind_small_cloud:"",sun_behind_large_cloud:"",sun_behind_rain_cloud:"",cloud_with_rain:"",cloud_with_snow:"",cloud_with_lightning:"",tornado:"",fog:"",wind_face:"",cyclone:"",rainbow:"",closed_umbrella:"",open_umbrella:"",umbrella:"",parasol_on_ground:"",zap:"",snowflake:"",snowman_with_snow:"",snowman:"",comet:"",fire:"",droplet:"",ocean:"",jack_o_lantern:"",christmas_tree:"",fireworks:"",sparkler:"",firecracker:"",sparkles:"",balloon:"",tada:"",confetti_ball:"",tanabata_tree:"",bamboo:"",dolls:"",flags:"",wind_chime:"",rice_scene:"",red_envelope:"",ribbon:"",gift:"",reminder_ribbon:"",tickets:"",ticket:"",medal_military:"",trophy:"",medal_sports:"","1st_place_medal":"","2nd_place_medal":"","3rd_place_medal":"",soccer:"",baseball:"",softball:"",basketball:"",volleyball:"",football:"",rugby_football:"",tennis:"",flying_disc:"",bowling:"",cricket_game:"",field_hockey:"",ice_hockey:"",lacrosse:"",ping_pong:"",badminton:"",boxing_glove:"",martial_arts_uniform:"",goal_net:"",golf:"",ice_skate:"",fishing_pole_and_fish:"",diving_mask:"",running_shirt_with_sash:"",ski:"",sled:"",curling_stone:"",dart:"",yo_yo:"",kite:"",gun:"","8ball":"",crystal_ball:"",magic_wand:"",video_game:"",joystick:"",slot_machine:"",game_die:"",jigsaw:"",teddy_bear:"",pinata:"",mirror_ball:"",nesting_dolls:"",spades:"",hearts:"",diamonds:"",clubs:"",chess_pawn:"",black_joker:"",mahjong:"",flower_playing_cards:"",performing_arts:"",framed_picture:"",art:"",thread:"",sewing_needle:"",yarn:"",knot:"",eyeglasses:"",dark_sunglasses:"",goggles:"",lab_coat:"",safety_vest:"",necktie:"",shirt:"",tshirt:"",jeans:"",scarf:"",gloves:"",coat:"",socks:"",dress:"",kimono:"",sari:"",one_piece_swimsuit:"",swim_brief:"",shorts:"",bikini:"",womans_clothes:"",folding_hand_fan:"",purse:"",handbag:"",pouch:"",shopping:"",school_satchel:"",thong_sandal:"",mans_shoe:"",shoe:"",athletic_shoe:"",hiking_boot:"",flat_shoe:"",high_heel:"",sandal:"",ballet_shoes:"",boot:"",hair_pick:"",crown:"",womans_hat:"",tophat:"",mortar_board:"",billed_cap:"",military_helmet:"",rescue_worker_helmet:"",prayer_beads:"",lipstick:"",ring:"",gem:"",mute:"",speaker:"",sound:"",loud_sound:"",loudspeaker:"",mega:"",postal_horn:"",bell:"",no_bell:"",musical_score:"",musical_note:"",notes:"",studio_microphone:"",level_slider:"",control_knobs:"",microphone:"",headphones:"",radio:"",saxophone:"",accordion:"",guitar:"",musical_keyboard:"",trumpet:"",violin:"",banjo:"",drum:"",long_drum:"",maracas:"",flute:"",iphone:"",calling:"",phone:"",telephone:"",telephone_receiver:"",pager:"",fax:"",battery:"",low_battery:"",electric_plug:"",computer:"",desktop_computer:"",printer:"",keyboard:"",computer_mouse:"",trackball:"",minidisc:"",floppy_disk:"",cd:"",dvd:"",abacus:"",movie_camera:"",film_strip:"",film_projector:"",clapper:"",tv:"",camera:"",camera_flash:"",video_camera:"",vhs:"",mag:"",mag_right:"",candle:"",bulb:"",flashlight:"",izakaya_lantern:"",lantern:"",diya_lamp:"",notebook_with_decorative_cover:"",closed_book:"",book:"",open_book:"",green_book:"",blue_book:"",orange_book:"",books:"",notebook:"",ledger:"",page_with_curl:"",scroll:"",page_facing_up:"",newspaper:"",newspaper_roll:"",bookmark_tabs:"",bookmark:"",label:"",moneybag:"",coin:"",yen:"",dollar:"",euro:"",pound:"",money_with_wings:"",credit_card:"",receipt:"",chart:"",envelope:"",email:"","e-mail":"",incoming_envelope:"",envelope_with_arrow:"",outbox_tray:"",inbox_tray:"",package:"",mailbox:"",mailbox_closed:"",mailbox_with_mail:"",mailbox_with_no_mail:"",postbox:"",ballot_box:"",pencil2:"",black_nib:"",fountain_pen:"",pen:"",paintbrush:"",crayon:"",memo:"",pencil:"",briefcase:"",file_folder:"",open_file_folder:"",card_index_dividers:"",date:"",calendar:"",spiral_notepad:"",spiral_calendar:"",card_index:"",chart_with_upwards_trend:"",chart_with_downwards_trend:"",bar_chart:"",clipboard:"",pushpin:"",round_pushpin:"",paperclip:"",paperclips:"",straight_ruler:"",triangular_ruler:"",scissors:"",card_file_box:"",file_cabinet:"",wastebasket:"",lock:"",unlock:"",lock_with_ink_pen:"",closed_lock_with_key:"",key:"",old_key:"",hammer:"",axe:"",pick:"",hammer_and_pick:"",hammer_and_wrench:"",dagger:"",crossed_swords:"",bomb:"",boomerang:"",bow_and_arrow:"",shield:"",carpentry_saw:"",wrench:"",screwdriver:"",nut_and_bolt:"",gear:"",clamp:"",balance_scale:"",probing_cane:"",link:"",chains:"",hook:"",toolbox:"",magnet:"",ladder:"",alembic:"",test_tube:"",petri_dish:"",dna:"",microscope:"",telescope:"",satellite:"",syringe:"",drop_of_blood:"",pill:"",adhesive_bandage:"",crutch:"",stethoscope:"",x_ray:"",door:"",elevator:"",mirror:"",window:"",bed:"",couch_and_lamp:"",chair:"",toilet:"",plunger:"",shower:"",bathtub:"",mouse_trap:"",razor:"",lotion_bottle:"",safety_pin:"",broom:"",basket:"",roll_of_paper:"",bucket:"",soap:"",bubbles:"",toothbrush:"",sponge:"",fire_extinguisher:"",shopping_cart:"",smoking:"",coffin:"",headstone:"",funeral_urn:"",nazar_amulet:"",hamsa:"",moyai:"",placard:"",identification_card:"",atm:"",put_litter_in_its_place:"",potable_water:"",wheelchair:"",men:"",women:"",restroom:"",baby_symbol:"",wc:"",passport_control:"",customs:"",baggage_claim:"",left_luggage:"",warning:"",children_crossing:"",no_entry:"",no_entry_sign:"",no_bicycles:"",no_smoking:"",do_not_litter:"","non-potable_water":"",no_pedestrians:"",no_mobile_phones:"",underage:"",radioactive:"",biohazard:"",arrow_up:"",arrow_upper_right:"",arrow_right:"",arrow_lower_right:"",arrow_down:"",arrow_lower_left:"",arrow_left:"",arrow_upper_left:"",arrow_up_down:"",left_right_arrow:"",leftwards_arrow_with_hook:"",arrow_right_hook:"",arrow_heading_up:"",arrow_heading_down:"",arrows_clockwise:"",arrows_counterclockwise:"",back:"",end:"",on:"",soon:"",top:"",place_of_worship:"",atom_symbol:"",om:"",star_of_david:"",wheel_of_dharma:"",yin_yang:"",latin_cross:"",orthodox_cross:"",star_and_crescent:"",peace_symbol:"",menorah:"",six_pointed_star:"",khanda:"",aries:"",taurus:"",gemini:"",cancer:"",leo:"",virgo:"",libra:"",scorpius:"",sagittarius:"",capricorn:"",aquarius:"",pisces:"",ophiuchus:"",twisted_rightwards_arrows:"",repeat:"",repeat_one:"",arrow_forward:"",fast_forward:"",next_track_button:"",play_or_pause_button:"",arrow_backward:"",rewind:"",previous_track_button:"",arrow_up_small:"",arrow_double_up:"",arrow_down_small:"",arrow_double_down:"",pause_button:"",stop_button:"",record_button:"",eject_button:"",cinema:"",low_brightness:"",high_brightness:"",signal_strength:"",wireless:"",vibration_mode:"",mobile_phone_off:"",female_sign:"",male_sign:"",transgender_symbol:"",heavy_multiplication_x:"",heavy_plus_sign:"",heavy_minus_sign:"",heavy_division_sign:"",heavy_equals_sign:"",infinity:"",bangbang:"",interrobang:"",question:"",grey_question:"",grey_exclamation:"",exclamation:"",heavy_exclamation_mark:"",wavy_dash:"",currency_exchange:"",heavy_dollar_sign:"",medical_symbol:"",recycle:"",fleur_de_lis:"",trident:"",name_badge:"",beginner:"",o:"",white_check_mark:"",ballot_box_with_check:"",heavy_check_mark:"",x:"",negative_squared_cross_mark:"",curly_loop:"",loop:"",part_alternation_mark:"",eight_spoked_asterisk:"",eight_pointed_black_star:"",sparkle:"",copyright:"",registered:"",tm:"",hash:"#",asterisk:"*",zero:"0",one:"1",two:"2",three:"3",four:"4",five:"5",six:"6",seven:"7",eight:"8",nine:"9",keycap_ten:"",capital_abcd:"",abcd:"",symbols:"",abc:"",a:"",ab:"",b:"",cl:"",cool:"",free:"",information_source:"",id:"",m:"",new:"",ng:"",o2:"",ok:"",parking:"",sos:"",up:"",vs:"",koko:"",sa:"",u6708:"",u6709:"",u6307:"",ideograph_advantage:"",u5272:"",u7121:"",u7981:"",accept:"",u7533:"",u5408:"",u7a7a:"",congratulations:"",secret:"",u55b6:"",u6e80:"",red_circle:"",orange_circle:"",yellow_circle:"",green_circle:"",large_blue_circle:"",purple_circle:"",brown_circle:"",black_circle:"",white_circle:"",red_square:"",orange_square:"",yellow_square:"",green_square:"",blue_square:"",purple_square:"",brown_square:"",black_large_square:"",white_large_square:"",black_medium_square:"",white_medium_square:"",black_medium_small_square:"",white_medium_small_square:"",black_small_square:"",white_small_square:"",large_orange_diamond:"",large_blue_diamond:"",small_orange_diamond:"",small_blue_diamond:"",small_red_triangle:"",small_red_triangle_down:"",diamond_shape_with_a_dot_inside:"",radio_button:"",white_square_button:"",black_square_button:"",checkered_flag:"",triangular_flag_on_post:"",crossed_flags:"",black_flag:"",white_flag:"",rainbow_flag:"",transgender_flag:"",pirate_flag:"",ascension_island:"",andorra:"",united_arab_emirates:"",afghanistan:"",antigua_barbuda:"",anguilla:"",albania:"",armenia:"",angola:"",antarctica:"",argentina:"",american_samoa:"",austria:"",australia:"",aruba:"",aland_islands:"",azerbaijan:"",bosnia_herzegovina:"",barbados:"",bangladesh:"",belgium:"",burkina_faso:"",bulgaria:"",bahrain:"",burundi:"",benin:"",st_barthelemy:"",bermuda:"",brunei:"",bolivia:"",caribbean_netherlands:"",brazil:"",bahamas:"",bhutan:"",bouvet_island:"",botswana:"",belarus:"",belize:"",canada:"",cocos_islands:"",congo_kinshasa:"",central_african_republic:"",congo_brazzaville:"",switzerland:"",cote_divoire:"",cook_islands:"",chile:"",cameroon:"",cn:"",colombia:"",clipperton_island:"",costa_rica:"",cuba:"",cape_verde:"",curacao:"",christmas_island:"",cyprus:"",czech_republic:"",de:"",diego_garcia:"",djibouti:"",denmark:"",dominica:"",dominican_republic:"",algeria:"",ceuta_melilla:"",ecuador:"",estonia:"",egypt:"",western_sahara:"",eritrea:"",es:"",ethiopia:"",eu:"",european_union:"",finland:"",fiji:"",falkland_islands:"",micronesia:"",faroe_islands:"",fr:"",gabon:"",gb:"",uk:"",grenada:"",georgia:"",french_guiana:"",guernsey:"",ghana:"",gibraltar:"",greenland:"",gambia:"",guinea:"",guadeloupe:"",equatorial_guinea:"",greece:"",south_georgia_south_sandwich_islands:"",guatemala:"",guam:"",guinea_bissau:"",guyana:"",hong_kong:"",heard_mcdonald_islands:"",honduras:"",croatia:"",haiti:"",hungary:"",canary_islands:"",indonesia:"",ireland:"",israel:"",isle_of_man:"",india:"",british_indian_ocean_territory:"",iraq:"",iran:"",iceland:"",it:"",jersey:"",jamaica:"",jordan:"",jp:"",kenya:"",kyrgyzstan:"",cambodia:"",kiribati:"",comoros:"",st_kitts_nevis:"",north_korea:"",kr:"",kuwait:"",cayman_islands:"",kazakhstan:"",laos:"",lebanon:"",st_lucia:"",liechtenstein:"",sri_lanka:"",liberia:"",lesotho:"",lithuania:"",luxembourg:"",latvia:"",libya:"",morocco:"",monaco:"",moldova:"",montenegro:"",st_martin:"",madagascar:"",marshall_islands:"",macedonia:"",mali:"",myanmar:"",mongolia:"",macau:"",northern_mariana_islands:"",martinique:"",mauritania:"",montserrat:"",malta:"",mauritius:"",maldives:"",malawi:"",mexico:"",malaysia:"",mozambique:"",namibia:"",new_caledonia:"",niger:"",norfolk_island:"",nigeria:"",nicaragua:"",netherlands:"",norway:"",nepal:"",nauru:"",niue:"",new_zealand:"",oman:"",panama:"",peru:"",french_polynesia:"",papua_new_guinea:"",philippines:"",pakistan:"",poland:"",st_pierre_miquelon:"",pitcairn_islands:"",puerto_rico:"",palestinian_territories:"",portugal:"",palau:"",paraguay:"",qatar:"",reunion:"",romania:"",serbia:"",ru:"",rwanda:"",saudi_arabia:"",solomon_islands:"",seychelles:"",sudan:"",sweden:"",singapore:"",st_helena:"",slovenia:"",svalbard_jan_mayen:"",slovakia:"",sierra_leone:"",san_marino:"",senegal:"",somalia:"",suriname:"",south_sudan:"",sao_tome_principe:"",el_salvador:"",sint_maarten:"",syria:"",swaziland:"",tristan_da_cunha:"",turks_caicos_islands:"",chad:"",french_southern_territories:"",togo:"",thailand:"",tajikistan:"",tokelau:"",timor_leste:"",turkmenistan:"",tunisia:"",tonga:"",tr:"",trinidad_tobago:"",tuvalu:"",taiwan:"",tanzania:"",ukraine:"",uganda:"",us_outlying_islands:"",united_nations:"",us:"",uruguay:"",uzbekistan:"",vatican_city:"",st_vincent_grenadines:"",venezuela:"",british_virgin_islands:"",us_virgin_islands:"",vietnam:"",vanuatu:"",wallis_futuna:"",samoa:"",kosovo:"",yemen:"",mayotte:"",south_africa:"",zambia:"",zimbabwe:"",england:"",scotland:"",wales:"",large_purple_circle:""};Ro.use(mm({emojis:pm,renderer:t=>t.emoji}));Ro.use({walkTokens(t){t.type==="html"&&(t.type="text",t.text=t.raw??t.text??"")}});const um=()=>{const t=ve(),o=i=>async()=>{await t(`<${i}/>`,`<${i}/> has been copied`)};return e("div",{className:"vm-preview-icons",children:Object.entries(Za).map(([i,s])=>e("div",{className:"vm-preview-icons-item",onClick:o(i),children:[e("div",{className:"vm-preview-icons-item__svg",children:s()}),e("div",{className:"vm-preview-icons-item__name",children:`<${i}/>`})]},i))})},hm=()=>{const[t,o]=S(!1);return e(V,{children:e(Dr,{children:e(oc,{children:e(V,{children:[e(cc,{onLoaded:o}),t&&e(zr,{children:e(pt,{path:"/",element:e(Rd,{}),children:[e(pt,{path:"/",element:e(Wl,{})}),e(pt,{path:pe.overview,element:e(lm,{})}),e(pt,{path:pe.streamContext,element:e(dm,{})}),e(pt,{path:"/icons",element:e(um,{})})]})})]})})})})},is=document.getElementById("root");is&&Hr(e(hm,{}),is);
